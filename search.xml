<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>源生Ajax</title>
      <link href="/2023/02/01/yuan-sheng-ajax/"/>
      <url>/2023/02/01/yuan-sheng-ajax/</url>
      
        <content type="html"><![CDATA[<h3 id="一、Ajax"><a href="#一、Ajax" class="headerlink" title="一、Ajax"></a>一、Ajax</h3><h4 id="1-1-简介"><a href="#1-1-简介" class="headerlink" title="1.1 简介"></a>1.1 简介</h4><blockquote><p>Ajax：（Asynchronous JavaScript And XML）指异步 JavaScript 及 XML</p><p>他不是一种新的编程语言，而是一种用于创建更好更快以及交互性更强的 Web 应用程序的技术，是基于JavaScript、XML、HTML、CSS新用法</p><p>Ajax指的是刷新局部页面的技术</p></blockquote><h4 id="1-2-应用场景"><a href="#1-2-应用场景" class="headerlink" title="1.2 应用场景"></a>1.2 应用场景</h4><blockquote><ul><li>搜索</li><li>地图</li><li>校验</li><li>获取数据</li></ul></blockquote><h4 id="1-3-交互模型"><a href="#1-3-交互模型" class="headerlink" title="1.3 交互模型"></a>1.3 交互模型</h4><p>![avatar][img1]</p><blockquote><p>传统的Web交互方式</p></blockquote><p>![avatar][img2]</p><blockquote><p>Ajax的交互方式</p></blockquote><p>![avatar][img3]</p><h3 id="二、-Aajx使用详解"><a href="#二、-Aajx使用详解" class="headerlink" title="二、 Aajx使用详解"></a>二、 Aajx使用详解</h3><h4 id="2-1-XMLHttpRequest对象"><a href="#2-1-XMLHttpRequest对象" class="headerlink" title="2.1 XMLHttpRequest对象"></a>2.1 XMLHttpRequest对象</h4><blockquote><p>该对象用于在前台与服务器交换数据。意味着可以在不重新加载整个网页的情况下，对网页的进行局部更新</p><p>所有现代浏览器均支持 XMLHttpRequest 对象（IE5 和 IE6 使用 ActiveXObject）</p></blockquote><pre class=" language-javascript"><code class="language-javascript"><span class="token comment" spellcheck="true">//获取XMLHttpRequest对象</span><span class="token keyword">function</span> <span class="token function">getXMLHttpRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">var</span> xmlHttp<span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>window<span class="token punctuation">.</span>XMLHttpRequest<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token comment" spellcheck="true">// 新浏览器</span>        xmlHttp <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">XMLHttpRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>window<span class="token punctuation">.</span> ActiveXObject<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token comment" spellcheck="true">// IE6及以下浏览器</span>        xmlHttp <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ActiveXObject</span><span class="token punctuation">(</span> <span class="token string">"Microsoft.XMLHTTP"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">return</span> xmlHttp<span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><h4 id="2-2-与服务器交换数据-open-x2F-send"><a href="#2-2-与服务器交换数据-open-x2F-send" class="headerlink" title="2.2  与服务器交换数据 open/send"></a>2.2  与服务器交换数据 open/send</h4><blockquote><p>如需将请求发送到服务器，我们使用 XMLHttpRequest 对象的 open() 和 send()</p></blockquote><table><thead><tr><th>函数</th><th>描述</th><th>示例</th></tr></thead><tbody><tr><td>open(method,url,async);</td><td>初始化请求参数(请求方式,请求地址,是否异步)</td><td>xmlhttp.open(“GET”,”url”,true);</td></tr><tr><td>send();</td><td>发送请求</td><td>xmlhttp.send();</td></tr></tbody></table><pre class=" language-javascript"><code class="language-javascript"></code></pre><h4 id="2-3-onreadystatechange事件"><a href="#2-3-onreadystatechange事件" class="headerlink" title="2.3 onreadystatechange事件"></a>2.3 onreadystatechange事件</h4><blockquote><p>请求被发送到服务器时，我们需要执行一些基于响应的任务</p></blockquote><table><thead><tr><th>函数</th><th>描述</th></tr></thead><tbody><tr><td>onreadystatechange</td><td>每当 readyState 属性改变时，就会调用该函数。</td></tr></tbody></table><table><thead><tr><th>属性</th><th>描述</th></tr></thead><tbody><tr><td>readyState</td><td>存有 XMLHttpRequest 的状态。<br>从 0 到 4 发生变化:<br>          0 - 请求未初始化服务器 <br>          1 - 连接已建立<br>          2 - 请求已接收<br>          3 - 请求处理中<br>          4 - 请求已完成，且响应已就绪</td></tr><tr><td>status</td><td>存有响应的状态。<br>          200 - OK<br>          404 - 未找到页面</td></tr></tbody></table><h3 id="三、实战案例"><a href="#三、实战案例" class="headerlink" title="三、实战案例"></a>三、实战案例</h3><h4 id="3-1-验证用户名"><a href="#3-1-验证用户名" class="headerlink" title="3.1  验证用户名"></a>3.1  验证用户名</h4><blockquote><p>验证用户名的是否可以注册</p><pre class=" language-java"><code class="language-java"><span class="token keyword">import</span> lombok<span class="token punctuation">.</span>AllArgsConstructor<span class="token punctuation">;</span><span class="token keyword">import</span> lombok<span class="token punctuation">.</span>Data<span class="token punctuation">;</span><span class="token keyword">import</span> lombok<span class="token punctuation">.</span>NoArgsConstructor<span class="token punctuation">;</span><span class="token annotation punctuation">@Data</span><span class="token annotation punctuation">@AllArgsConstructor</span><span class="token annotation punctuation">@NoArgsConstructor</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">User</span> <span class="token punctuation">{</span> <span class="token keyword">private</span> <span class="token keyword">int</span> id<span class="token punctuation">;</span> <span class="token keyword">private</span> String username<span class="token punctuation">;</span> <span class="token keyword">private</span> String password<span class="token punctuation">;</span> <span class="token keyword">private</span> String name<span class="token punctuation">;</span> <span class="token keyword">private</span> <span class="token keyword">int</span> age<span class="token punctuation">;</span> <span class="token keyword">private</span> String province<span class="token punctuation">;</span> <span class="token keyword">private</span> String city<span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre></blockquote><pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">></span></span>注册页面<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">action</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>user?action<span class="token punctuation">=</span>doRegister<span class="token punctuation">"</span></span> <span class="token attr-name">method</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>post<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    账号：<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>username<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>username<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">/></span></span>    密码：<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>password<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>password<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">/></span></span>    姓名：<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>name<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">/></span></span>    年龄：<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>age<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">/></span></span>    地址：    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>select</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>province<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>province<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>option</span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>--请选择--<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>option</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>select</span><span class="token punctuation">></span></span>省    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>select</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>city<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>city<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>option</span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>--请选择--<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>option</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>select</span><span class="token punctuation">></span></span>市    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">/></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>submit<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>注册<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>text/javascript<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script language-javascript">    <span class="token comment" spellcheck="true">//获取XMLHttpRequest对象</span>    <span class="token keyword">function</span> <span class="token function">getXMLHttpRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">var</span> xmlHttpRequest<span class="token operator">=</span><span class="token keyword">null</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>window<span class="token punctuation">.</span>XMLHttpRequest<span class="token punctuation">)</span><span class="token punctuation">{</span>            xmlHttpRequest <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">XMLHttpRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>window<span class="token punctuation">.</span>ActiveXObject<span class="token punctuation">)</span><span class="token punctuation">{</span>            xmlHttpRequest <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ActiveXObject</span><span class="token punctuation">(</span><span class="token string">"Microsoft.XMLHTTP"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token keyword">return</span> xmlHttpRequest<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">var</span> span <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementsByTagName</span><span class="token punctuation">(</span><span class="token string">"span"</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">// 输入登陆框失去焦点后发送异步请求</span>    document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">"username"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>onblur <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">var</span> data <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>value<span class="token punctuation">;</span>        <span class="token keyword">var</span> xmlHttpRequest <span class="token operator">=</span> <span class="token function">getXMLHttpRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">//onreadystatechange事件</span>        xmlHttpRequest<span class="token punctuation">.</span>onreadystatechange <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>            <span class="token comment" spellcheck="true">//xmlHttpRequest的状态</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>xmlHttpRequest<span class="token punctuation">.</span>readyState <span class="token operator">==</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token comment" spellcheck="true">//响应已经就绪</span>                <span class="token comment" spellcheck="true">//响应状态码</span>                <span class="token keyword">if</span> <span class="token punctuation">(</span>xmlHttpRequest<span class="token punctuation">.</span>status <span class="token operator">==</span> <span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">{</span>                    <span class="token comment" spellcheck="true">//获取响应数据</span>                    <span class="token keyword">var</span> data <span class="token operator">=</span>xmlHttpRequest<span class="token punctuation">.</span>responseText<span class="token punctuation">;</span>                    <span class="token keyword">if</span> <span class="token punctuation">(</span>data <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">{</span>                        span<span class="token punctuation">.</span>style<span class="token punctuation">.</span>color <span class="token operator">=</span> <span class="token string">"red"</span><span class="token punctuation">;</span>                        span<span class="token punctuation">.</span>innerText <span class="token operator">=</span> <span class="token string">"抱歉，账号已存在"</span><span class="token punctuation">;</span>                    <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>                        span<span class="token punctuation">.</span>style<span class="token punctuation">.</span>color <span class="token operator">=</span> <span class="token string">"green"</span><span class="token punctuation">;</span>                        span<span class="token punctuation">.</span>innerText <span class="token operator">=</span> <span class="token string">"账号可用"</span><span class="token punctuation">;</span>                    <span class="token punctuation">}</span>                <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>xmlHttpRequest<span class="token punctuation">.</span>status <span class="token operator">==</span> <span class="token number">404</span><span class="token punctuation">)</span><span class="token punctuation">{</span>                    <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">"抱歉，页面已丢失~~~"</span><span class="token punctuation">)</span>                <span class="token punctuation">}</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span>        <span class="token comment" spellcheck="true">//初始化请求参数，请求类型，是否开启异步</span>        xmlHttpRequest<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token string">"POST"</span><span class="token punctuation">,</span><span class="token string">"user?action=doIsRegister"</span><span class="token punctuation">,</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">//post需要设置请求头</span>        xmlHttpRequest<span class="token punctuation">.</span><span class="token function">setRequestHeader</span><span class="token punctuation">(</span><span class="token string">"Content-Type"</span><span class="token punctuation">,</span><span class="token string">"application/x-www-form-urlencoded;charset-UTF-8"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">//发送请求，携带数据</span>        xmlHttpRequest<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">"username="</span> <span class="token operator">+</span> data<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span></code></pre><pre class=" language-java"><code class="language-java"><span class="token annotation punctuation">@WebServlet</span><span class="token punctuation">(</span><span class="token string">"/user"</span><span class="token punctuation">)</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">UserController</span> <span class="token keyword">extends</span> <span class="token class-name">BaseServlet</span> <span class="token punctuation">{</span>    <span class="token keyword">public</span> String <span class="token function">doIsRegister</span><span class="token punctuation">(</span>HttpServletRequest request<span class="token punctuation">,</span> HttpServletResponse response<span class="token punctuation">)</span> <span class="token keyword">throws</span> IOException <span class="token punctuation">{</span>        String username <span class="token operator">=</span> request<span class="token punctuation">.</span><span class="token function">getParameter</span><span class="token punctuation">(</span><span class="token string">"username"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        String sql <span class="token operator">=</span> <span class="token string">"select * from user where username = ?"</span><span class="token punctuation">;</span>        List<span class="token operator">&lt;</span>User<span class="token operator">></span> users <span class="token operator">=</span> DBUtil<span class="token punctuation">.</span><span class="token function">commonQuery</span><span class="token punctuation">(</span>User<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> sql<span class="token punctuation">,</span> username<span class="token punctuation">)</span><span class="token punctuation">;</span>        PrintWriter pw <span class="token operator">=</span> response<span class="token punctuation">.</span><span class="token function">getWriter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span>User user <span class="token operator">:</span> users<span class="token punctuation">)</span> <span class="token punctuation">{</span>            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>users<span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            pw<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"0"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">return</span> <span class="token string">"success"</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token keyword">else</span> <span class="token punctuation">{</span>            pw<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"-1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">return</span> <span class="token string">"failed"</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">doRegister</span><span class="token punctuation">(</span>HttpServletRequest request<span class="token punctuation">,</span>HttpServletResponse response<span class="token punctuation">)</span> <span class="token keyword">throws</span> IOException<span class="token punctuation">,</span> ServletException <span class="token punctuation">{</span>        String username <span class="token operator">=</span> request<span class="token punctuation">.</span><span class="token function">getParameter</span><span class="token punctuation">(</span><span class="token string">"username"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        String password <span class="token operator">=</span> request<span class="token punctuation">.</span><span class="token function">getParameter</span><span class="token punctuation">(</span><span class="token string">"password"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        String name <span class="token operator">=</span> request<span class="token punctuation">.</span><span class="token function">getParameter</span><span class="token punctuation">(</span><span class="token string">"name"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        String age <span class="token operator">=</span> request<span class="token punctuation">.</span><span class="token function">getParameter</span><span class="token punctuation">(</span><span class="token string">"age"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        String province <span class="token operator">=</span> request<span class="token punctuation">.</span><span class="token function">getParameter</span><span class="token punctuation">(</span><span class="token string">"province"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        String city <span class="token operator">=</span> request<span class="token punctuation">.</span><span class="token function">getParameter</span><span class="token punctuation">(</span><span class="token string">"city"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">doIsRegister</span><span class="token punctuation">(</span>request<span class="token punctuation">,</span>response<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token string">"success"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>            String sql <span class="token operator">=</span> <span class="token string">"insert into User(username,password,name,age,province,city) values(?,?,?,?,?,?)"</span><span class="token punctuation">;</span>            DBUtil<span class="token punctuation">.</span><span class="token function">commonInsert</span><span class="token punctuation">(</span>sql<span class="token punctuation">,</span> username<span class="token punctuation">,</span> password<span class="token punctuation">,</span> name<span class="token punctuation">,</span> Integer<span class="token punctuation">.</span><span class="token function">parseInt</span><span class="token punctuation">(</span>age<span class="token punctuation">)</span><span class="token punctuation">,</span> province<span class="token punctuation">,</span> city<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token punctuation">{</span>            request<span class="token punctuation">.</span><span class="token function">getRequestDispatcher</span><span class="token punctuation">(</span><span class="token string">"register.html"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forward</span><span class="token punctuation">(</span>request<span class="token punctuation">,</span>response<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span>    </code></pre><p>账号存在：</p><p><img src="C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\image-20230201190939412.png" alt="image-20230201190939412"></p><p>账号不存在：</p><p><img src="C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\image-20230201190949930.png" alt="image-20230201190949930"></p><h4 id="3-2-级联效果"><a href="#3-2-级联效果" class="headerlink" title="3.2 级联效果"></a>3.2 级联效果</h4><blockquote><p>通过选择省从而关联出城市的数据</p><p>前端发送Ajax异步请求到服务器中获取对应的省市JSON数据，再在前端解析、适配到页面</p></blockquote><blockquote><ol><li>添加数据库</li><li>导入数据库驱动包、Druid连接池</li><li>添加省、市实体类</li></ol></blockquote><pre class=" language-java"><code class="language-java"><span class="token keyword">import</span> lombok<span class="token punctuation">.</span>Data<span class="token punctuation">;</span><span class="token annotation punctuation">@Data</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Province</span> <span class="token punctuation">{</span>    <span class="token keyword">private</span> String code<span class="token punctuation">;</span>    <span class="token keyword">private</span> String name<span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><pre class=" language-java"><code class="language-java"><span class="token keyword">import</span> lombok<span class="token punctuation">.</span>Data<span class="token punctuation">;</span><span class="token annotation punctuation">@Data</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">City</span> <span class="token punctuation">{</span>    <span class="token keyword">private</span> String code<span class="token punctuation">;</span>    <span class="token keyword">private</span> String name<span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><blockquote><ol start="4"><li>添加数据库工具类</li></ol></blockquote><pre class=" language-java"><code class="language-java"><span class="token keyword">import</span> com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>druid<span class="token punctuation">.</span>pool<span class="token punctuation">.</span>DruidDataSource<span class="token punctuation">;</span><span class="token keyword">import</span> java<span class="token punctuation">.</span>io<span class="token punctuation">.</span>IOException<span class="token punctuation">;</span><span class="token keyword">import</span> java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span>reflect<span class="token punctuation">.</span>Field<span class="token punctuation">;</span><span class="token keyword">import</span> java<span class="token punctuation">.</span>sql<span class="token punctuation">.</span>*<span class="token punctuation">;</span><span class="token keyword">import</span> java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>ArrayList<span class="token punctuation">;</span><span class="token keyword">import</span> java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>List<span class="token punctuation">;</span><span class="token keyword">import</span> java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>Properties<span class="token punctuation">;</span><span class="token comment" spellcheck="true">/** * 数据库的工具类 */</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DBUtil</span> <span class="token punctuation">{</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> DruidDataSource dataSource<span class="token punctuation">;</span>    <span class="token keyword">static</span> <span class="token punctuation">{</span>        <span class="token comment" spellcheck="true">//获取配置文件中的数据</span>        Properties properties <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Properties</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">try</span> <span class="token punctuation">{</span>            properties<span class="token punctuation">.</span><span class="token function">load</span><span class="token punctuation">(</span>DBUtil<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">.</span><span class="token function">getClassLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getResourceAsStream</span><span class="token punctuation">(</span><span class="token string">"DBConfig.properties"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        String driverName <span class="token operator">=</span> properties<span class="token punctuation">.</span><span class="token function">getProperty</span><span class="token punctuation">(</span><span class="token string">"driverName"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        String url <span class="token operator">=</span> properties<span class="token punctuation">.</span><span class="token function">getProperty</span><span class="token punctuation">(</span><span class="token string">"url"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        String username <span class="token operator">=</span> properties<span class="token punctuation">.</span><span class="token function">getProperty</span><span class="token punctuation">(</span><span class="token string">"username"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        String password <span class="token operator">=</span> properties<span class="token punctuation">.</span><span class="token function">getProperty</span><span class="token punctuation">(</span><span class="token string">"password"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">//初始化德鲁伊数据连接池</span>        dataSource <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DruidDataSource</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        dataSource<span class="token punctuation">.</span><span class="token function">setDriverClassName</span><span class="token punctuation">(</span>driverName<span class="token punctuation">)</span><span class="token punctuation">;</span>        dataSource<span class="token punctuation">.</span><span class="token function">setUrl</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">;</span>        dataSource<span class="token punctuation">.</span><span class="token function">setUsername</span><span class="token punctuation">(</span>username<span class="token punctuation">)</span><span class="token punctuation">;</span>        dataSource<span class="token punctuation">.</span><span class="token function">setPassword</span><span class="token punctuation">(</span>password<span class="token punctuation">)</span><span class="token punctuation">;</span>        dataSource<span class="token punctuation">.</span><span class="token function">setMaxActive</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> ThreadLocal<span class="token operator">&lt;</span>Connection<span class="token operator">></span> local <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ThreadLocal</span><span class="token operator">&lt;</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">/**     * 开启事务     */</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">startTransaction</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> SQLException <span class="token punctuation">{</span>        Connection connection <span class="token operator">=</span> <span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        connection<span class="token punctuation">.</span><span class="token function">setAutoCommit</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true">/**     * 提交事务     */</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">commit</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> SQLException <span class="token punctuation">{</span>        Connection connection <span class="token operator">=</span> local<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>connection <span class="token operator">!=</span> null<span class="token punctuation">)</span><span class="token punctuation">{</span>            connection<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            connection<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            local<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>null<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true">/**     * 回滚事务     */</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">rollback</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> SQLException <span class="token punctuation">{</span>        Connection connection <span class="token operator">=</span> local<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>connection <span class="token operator">!=</span> null<span class="token punctuation">)</span><span class="token punctuation">{</span>            connection<span class="token punctuation">.</span><span class="token function">rollback</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            connection<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            local<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>null<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true">/**     * 获取连接对象     * @return 连接对象     */</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> Connection <span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> SQLException <span class="token punctuation">{</span>        Connection connection <span class="token operator">=</span> local<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>connection <span class="token operator">==</span> null<span class="token punctuation">)</span><span class="token punctuation">{</span>            connection <span class="token operator">=</span> dataSource<span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment" spellcheck="true">//设置事务的隔离界别</span>            connection<span class="token punctuation">.</span><span class="token function">setTransactionIsolation</span><span class="token punctuation">(</span>Connection<span class="token punctuation">.</span>TRANSACTION_REPEATABLE_READ<span class="token punctuation">)</span><span class="token punctuation">;</span>            local<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>connection<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token keyword">return</span> connection<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true">/**     * 关闭资源     * @param connection 要关闭的链接对象     * @param statement 要关闭的发送SQL指令对象     * @param resultSet 要关闭的结果集对象     */</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">close</span><span class="token punctuation">(</span>Connection connection<span class="token punctuation">,</span> Statement statement<span class="token punctuation">,</span> ResultSet resultSet<span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>resultSet <span class="token operator">!=</span> null<span class="token punctuation">)</span><span class="token punctuation">{</span>            <span class="token keyword">try</span> <span class="token punctuation">{</span>                resultSet<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">SQLException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>                e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>statement <span class="token operator">!=</span> null<span class="token punctuation">)</span><span class="token punctuation">{</span>            <span class="token keyword">try</span> <span class="token punctuation">{</span>                statement<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">SQLException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>                e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>connection <span class="token operator">!=</span> null<span class="token punctuation">)</span><span class="token punctuation">{</span>            <span class="token keyword">try</span> <span class="token punctuation">{</span>                <span class="token comment" spellcheck="true">//判断连接对象是否自动提交</span>                <span class="token keyword">if</span><span class="token punctuation">(</span>connection<span class="token punctuation">.</span><span class="token function">getAutoCommit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                    connection<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                    local<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>null<span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token punctuation">}</span>            <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">SQLException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>                e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true">/**     * 更新数据的方法     * @param sql SQL指令     * @param params 参数的可变参数     * @return 影响的行数     */</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">int</span>  <span class="token function">commonUpdate</span><span class="token punctuation">(</span>String sql<span class="token punctuation">,</span>Object<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> params<span class="token punctuation">)</span><span class="token punctuation">{</span>        Connection connection <span class="token operator">=</span> null<span class="token punctuation">;</span>        PreparedStatement statement <span class="token operator">=</span> null<span class="token punctuation">;</span>        <span class="token keyword">try</span> <span class="token punctuation">{</span>            connection <span class="token operator">=</span> <span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            statement <span class="token operator">=</span> connection<span class="token punctuation">.</span><span class="token function">prepareStatement</span><span class="token punctuation">(</span>sql<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token function">setParams</span><span class="token punctuation">(</span>statement<span class="token punctuation">,</span>params<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">int</span> num <span class="token operator">=</span> statement<span class="token punctuation">.</span><span class="token function">executeUpdate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">return</span> num<span class="token punctuation">;</span>        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">SQLException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{</span>            <span class="token function">close</span><span class="token punctuation">(</span>connection<span class="token punctuation">,</span>statement<span class="token punctuation">,</span>null<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token keyword">return</span>  <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true">/**     * 添加数据(主键回填)     * @param params 参数的可变参数     * @return 返回主键     */</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">int</span> <span class="token function">commonInsert</span><span class="token punctuation">(</span>String sql<span class="token punctuation">,</span>Object<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> params<span class="token punctuation">)</span><span class="token punctuation">{</span>        Connection connection <span class="token operator">=</span> null<span class="token punctuation">;</span>        PreparedStatement statement <span class="token operator">=</span> null<span class="token punctuation">;</span>        ResultSet resultSet <span class="token operator">=</span> null<span class="token punctuation">;</span>        <span class="token keyword">try</span> <span class="token punctuation">{</span>            connection <span class="token operator">=</span> <span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            statement <span class="token operator">=</span> connection<span class="token punctuation">.</span><span class="token function">prepareStatement</span><span class="token punctuation">(</span>sql<span class="token punctuation">,</span>PreparedStatement<span class="token punctuation">.</span>RETURN_GENERATED_KEYS<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token function">setParams</span><span class="token punctuation">(</span>statement<span class="token punctuation">,</span>params<span class="token punctuation">)</span><span class="token punctuation">;</span>            statement<span class="token punctuation">.</span><span class="token function">executeUpdate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment" spellcheck="true">//获取主键</span>            resultSet <span class="token operator">=</span> statement<span class="token punctuation">.</span><span class="token function">getGeneratedKeys</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>resultSet<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>                <span class="token keyword">int</span> primaryKey <span class="token operator">=</span> resultSet<span class="token punctuation">.</span><span class="token function">getInt</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">return</span>  primaryKey<span class="token punctuation">;</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">SQLException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{</span>            <span class="token function">close</span><span class="token punctuation">(</span>connection<span class="token punctuation">,</span>statement<span class="token punctuation">,</span>null<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token keyword">return</span>  <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token operator">&lt;</span>T<span class="token operator">></span> List<span class="token operator">&lt;</span>T<span class="token operator">></span> <span class="token function">commonQuery</span><span class="token punctuation">(</span>Class<span class="token operator">&lt;</span>T<span class="token operator">></span> clazz<span class="token punctuation">,</span>String sql<span class="token punctuation">,</span>Object<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> params<span class="token punctuation">)</span><span class="token punctuation">{</span>        Connection connection <span class="token operator">=</span> null<span class="token punctuation">;</span>        PreparedStatement statement <span class="token operator">=</span> null<span class="token punctuation">;</span>        ResultSet resultSet <span class="token operator">=</span> null<span class="token punctuation">;</span>        <span class="token keyword">try</span> <span class="token punctuation">{</span>            connection <span class="token operator">=</span> <span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            statement <span class="token operator">=</span> connection<span class="token punctuation">.</span><span class="token function">prepareStatement</span><span class="token punctuation">(</span>sql<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token function">setParams</span><span class="token punctuation">(</span>statement<span class="token punctuation">,</span>params<span class="token punctuation">)</span><span class="token punctuation">;</span>            resultSet <span class="token operator">=</span> statement<span class="token punctuation">.</span><span class="token function">executeQuery</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment" spellcheck="true">//获取表信息对象</span>            ResultSetMetaData metaData <span class="token operator">=</span> resultSet<span class="token punctuation">.</span><span class="token function">getMetaData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment" spellcheck="true">//获取字段长度</span>            <span class="token keyword">int</span> count <span class="token operator">=</span> metaData<span class="token punctuation">.</span><span class="token function">getColumnCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment" spellcheck="true">//对象容器</span>            List<span class="token operator">&lt;</span>T<span class="token operator">></span> list <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token operator">&lt;</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">while</span><span class="token punctuation">(</span>resultSet<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>                <span class="token keyword">try</span> <span class="token punctuation">{</span>                    <span class="token comment" spellcheck="true">//创建实体类对象</span>                    T t <span class="token operator">=</span> clazz<span class="token punctuation">.</span><span class="token function">newInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> count <span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                        <span class="token comment" spellcheck="true">//获取到字段名</span>                        String columnName <span class="token operator">=</span> metaData<span class="token punctuation">.</span><span class="token function">getColumnName</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>                        <span class="token comment" spellcheck="true">//获取到字段名对应的数据</span>                        Object value <span class="token operator">=</span> resultSet<span class="token punctuation">.</span><span class="token function">getObject</span><span class="token punctuation">(</span>columnName<span class="token punctuation">)</span><span class="token punctuation">;</span>                        <span class="token comment" spellcheck="true">//获取字段名对应的属性对象</span>                        Field field <span class="token operator">=</span> <span class="token function">getField</span><span class="token punctuation">(</span>clazz<span class="token punctuation">,</span> columnName<span class="token punctuation">)</span><span class="token punctuation">;</span>                        <span class="token keyword">if</span><span class="token punctuation">(</span>field <span class="token operator">!=</span> null<span class="token punctuation">)</span><span class="token punctuation">{</span>                            field<span class="token punctuation">.</span><span class="token function">setAccessible</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                            field<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>t<span class="token punctuation">,</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>                        <span class="token punctuation">}</span>                    <span class="token punctuation">}</span>                    list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>t<span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InstantiationException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>                    e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IllegalAccessException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>                    e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token punctuation">}</span>            <span class="token punctuation">}</span>            <span class="token keyword">return</span> list<span class="token punctuation">;</span>        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">SQLException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token keyword">return</span> null<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> Field <span class="token function">getField</span><span class="token punctuation">(</span>Class<span class="token operator">&lt;</span><span class="token operator">?</span><span class="token operator">></span> clazz<span class="token punctuation">,</span> String name<span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">for</span><span class="token punctuation">(</span>Class<span class="token operator">&lt;</span><span class="token operator">?</span><span class="token operator">></span> c <span class="token operator">=</span> clazz<span class="token punctuation">;</span>c<span class="token operator">!=</span>null<span class="token punctuation">;</span>c<span class="token operator">=</span>c<span class="token punctuation">.</span><span class="token function">getSuperclass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>            Field<span class="token punctuation">[</span><span class="token punctuation">]</span> fields <span class="token operator">=</span> c<span class="token punctuation">.</span><span class="token function">getDeclaredFields</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">for</span> <span class="token punctuation">(</span>Field field <span class="token operator">:</span> fields<span class="token punctuation">)</span> <span class="token punctuation">{</span>                <span class="token keyword">if</span><span class="token punctuation">(</span>field<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>                    <span class="token keyword">return</span> field<span class="token punctuation">;</span>                <span class="token punctuation">}</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span>        <span class="token keyword">return</span> null<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">setParams</span><span class="token punctuation">(</span>PreparedStatement statement<span class="token punctuation">,</span>Object<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> params<span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> params<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">try</span> <span class="token punctuation">{</span>                statement<span class="token punctuation">.</span><span class="token function">setObject</span><span class="token punctuation">(</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span>params<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">SQLException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>                e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span></code></pre><blockquote></blockquote><blockquote><ol start="6"><li>编写Servlet</li></ol></blockquote><pre class=" language-java"><code class="language-java"><span class="token annotation punctuation">@WebServlet</span><span class="token punctuation">(</span><span class="token string">"/location"</span><span class="token punctuation">)</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">LocationController</span> <span class="token keyword">extends</span> <span class="token class-name">BaseServlet</span> <span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">getProvince</span><span class="token punctuation">(</span>HttpServletRequest request<span class="token punctuation">,</span> HttpServletResponse response<span class="token punctuation">)</span> <span class="token keyword">throws</span> IOException <span class="token punctuation">{</span>        String sql <span class="token operator">=</span> <span class="token string">"select * from provinces where type = ?"</span><span class="token punctuation">;</span>        List<span class="token operator">&lt;</span>Province<span class="token operator">></span> provinces <span class="token operator">=</span> DBUtil<span class="token punctuation">.</span><span class="token function">commonQuery</span><span class="token punctuation">(</span>Province<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> sql<span class="token punctuation">,</span> <span class="token string">"province"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        String jsonString <span class="token operator">=</span> JSON<span class="token punctuation">.</span><span class="token function">toJSONString</span><span class="token punctuation">(</span>provinces<span class="token punctuation">)</span><span class="token punctuation">;</span>        response<span class="token punctuation">.</span><span class="token function">getWriter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span>jsonString<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">getCity</span><span class="token punctuation">(</span>HttpServletRequest request<span class="token punctuation">,</span> HttpServletResponse response<span class="token punctuation">)</span> <span class="token keyword">throws</span> IOException <span class="token punctuation">{</span>        String code <span class="token operator">=</span> request<span class="token punctuation">.</span><span class="token function">getParameter</span><span class="token punctuation">(</span><span class="token string">"code"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        String sql <span class="token operator">=</span> <span class="token string">"select * from provinces where parent_code = ?"</span><span class="token punctuation">;</span>        List<span class="token operator">&lt;</span>City<span class="token operator">></span> cities <span class="token operator">=</span> DBUtil<span class="token punctuation">.</span><span class="token function">commonQuery</span><span class="token punctuation">(</span>City<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> sql<span class="token punctuation">,</span> code<span class="token punctuation">)</span><span class="token punctuation">;</span>        String jsonString <span class="token operator">=</span> JSON<span class="token punctuation">.</span><span class="token function">toJSONString</span><span class="token punctuation">(</span>cities<span class="token punctuation">)</span><span class="token punctuation">;</span>        response<span class="token punctuation">.</span><span class="token function">getWriter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span>jsonString<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span></code></pre><blockquote><ol start="7"><li>编写前端JS</li></ol></blockquote><pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>text/javascript<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script language-javascript"><span class="token comment" spellcheck="true">//异步查询数据库省份信息</span>        <span class="token keyword">var</span> province <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">"province"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">function</span> <span class="token function">getProvince</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">var</span> xmlHttpRequest <span class="token operator">=</span> <span class="token function">getXMLHttpRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            xmlHttpRequest<span class="token punctuation">.</span>onreadystatechange <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                <span class="token keyword">if</span> <span class="token punctuation">(</span>xmlHttpRequest<span class="token punctuation">.</span>readyState<span class="token operator">==</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">{</span>                    <span class="token keyword">if</span> <span class="token punctuation">(</span>xmlHttpRequest<span class="token punctuation">.</span>status <span class="token operator">==</span> <span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">{</span>                        <span class="token keyword">var</span> data <span class="token operator">=</span> xmlHttpRequest<span class="token punctuation">.</span>responseText<span class="token punctuation">;</span>                        <span class="token keyword">var</span> provinces <span class="token operator">=</span> <span class="token function">eval</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>                        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> provinces<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                            <span class="token keyword">var</span> option <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">"option"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                            option<span class="token punctuation">.</span>value <span class="token operator">=</span> provinces<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>code<span class="token punctuation">;</span>                            option<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> provinces<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>name<span class="token punctuation">;</span>                            province<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>option<span class="token punctuation">)</span><span class="token punctuation">;</span>                        <span class="token punctuation">}</span>                    <span class="token punctuation">}</span>                <span class="token punctuation">}</span>            <span class="token punctuation">}</span>            xmlHttpRequest<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token string">"GET"</span><span class="token punctuation">,</span><span class="token string">"location?action=getProvince"</span><span class="token punctuation">,</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment" spellcheck="true">//发送请求</span>            xmlHttpRequest<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token function">getProvince</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">//异步查询数据库城市信息</span>        <span class="token keyword">var</span> city <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">"city"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        province<span class="token punctuation">.</span>onchange <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token comment" spellcheck="true">//每次调用就清空一下</span>            city<span class="token punctuation">.</span>length <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>            <span class="token comment" spellcheck="true">//获取省份的code</span>            <span class="token keyword">var</span> code <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>value<span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>code <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{</span>                city<span class="token punctuation">.</span>innerText <span class="token operator">=</span> <span class="token string">"&lt;option value='0'>--请选择--&lt;/option>>"</span>            <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>                <span class="token keyword">var</span> xmlHttpRequest <span class="token operator">=</span> <span class="token function">getXMLHttpRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                xmlHttpRequest<span class="token punctuation">.</span>onreadystatechange <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                    <span class="token keyword">if</span> <span class="token punctuation">(</span>xmlHttpRequest<span class="token punctuation">.</span>readyState <span class="token operator">==</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">{</span>                        <span class="token keyword">if</span> <span class="token punctuation">(</span>xmlHttpRequest<span class="token punctuation">.</span>status <span class="token operator">==</span> <span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">{</span>                            <span class="token keyword">var</span> data <span class="token operator">=</span> xmlHttpRequest<span class="token punctuation">.</span>responseText<span class="token punctuation">;</span>                            <span class="token keyword">var</span> cities <span class="token operator">=</span> <span class="token function">eval</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>                            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> cities<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                                <span class="token keyword">var</span> option <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">"option"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                                option<span class="token punctuation">.</span>value <span class="token operator">=</span> cities<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>code<span class="token punctuation">;</span>                                option<span class="token punctuation">.</span>innerText <span class="token operator">=</span> cities<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>name<span class="token punctuation">;</span>                                city<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>option<span class="token punctuation">)</span><span class="token punctuation">;</span>                            <span class="token punctuation">}</span>                        <span class="token punctuation">}</span>                    <span class="token punctuation">}</span>                <span class="token punctuation">}</span>            <span class="token punctuation">}</span>            xmlHttpRequest<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token string">"GET"</span><span class="token punctuation">,</span><span class="token string">"location?action=getCity&amp;code="</span><span class="token operator">+</span>code<span class="token punctuation">,</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            xmlHttpRequest<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span></code></pre><p><img src="C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\image-20230201191836443.png" alt="image-20230201191836443"></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>JSON</title>
      <link href="/2023/02/01/json/"/>
      <url>/2023/02/01/json/</url>
      
        <content type="html"><![CDATA[<h3 id="一、JSON"><a href="#一、JSON" class="headerlink" title="一、JSON"></a>一、JSON</h3><h4 id="1-1-简介"><a href="#1-1-简介" class="headerlink" title="1.1 简介"></a>1.1 简介</h4><blockquote><p>JSON：JavaScript Object Notation是一种表示对象的方式</p><p>基于JavaScript语言的轻量级的数据交换格式;（即:用来传输数据的一种格式）</p><p>现在传输数据的方式更多是采用json的格式，渐渐代替了XML</p><p>json优点：相同数据json描述更加简洁</p><p>json作用：作为前后端传输数据的交互格式</p><p>xml优点：可读性高</p></blockquote><h4 id="1-2-JSON的数据表示"><a href="#1-2-JSON的数据表示" class="headerlink" title="1.2 JSON的数据表示"></a>1.2 JSON的数据表示</h4><blockquote><p>JSON采用名值对的方式来表示一个对象的信息</p><table><thead><tr><th>符号</th><th>描述</th><th>示例</th></tr></thead><tbody><tr><td>{}</td><td>表示对象</td><td>{name : ‘书名1’ , price:100}</td></tr><tr><td>[{},{},{}]</td><td>表示对象数组</td><td>[ {name : ‘书名1’ , price:100} , {name : ‘书名2’ , price:200} ]</td></tr></tbody></table><p>注意：</p><ol><li><p>JSON的本质就是一串字符串，只不过元素（数据）会使用特定的符号标注</p></li><li><p>键和值之间用 : 隔开</p></li><li><p>键值对之间用 , 隔开</p></li><li><p>支持无限层嵌套 </p><p>ps：{name : ‘Java从入门到精通’ , price:100 , author:{name:’吴彦祖’ , info:’从事java20年’}}</p></li><li><p>‘’ 或 “” 都可以表示字符串</p></li></ol></blockquote><h3 id="二、序列化和反序列化"><a href="#二、序列化和反序列化" class="headerlink" title="二、序列化和反序列化"></a>二、序列化和反序列化</h3><blockquote><p>序列化：指的是将Java对象转换为JSON字符串的过程，即 Java对象 → JSON字符串</p><p>反序列化：指的是将JSON字符串转换为Java对象的过程，即 JSON字符串 → Java对象</p></blockquote><h3 id="三、浏览器中处理JSON"><a href="#三、浏览器中处理JSON" class="headerlink" title="三、浏览器中处理JSON"></a>三、浏览器中处理JSON</h3><h4 id="3-1-JSON字符串-→-对象"><a href="#3-1-JSON字符串-→-对象" class="headerlink" title="3.1 JSON字符串 → 对象"></a>3.1 JSON字符串 → 对象</h4><blockquote><p>使用parse函数解析JSON格式字符串</p><p>parse函数注意事项（坑）：</p><pre><code> 1. 字符串的数据格式：所有属性必须用双引号引住，因为使用JSON.parse需严格遵守JSON规范。 2. 单引号与双引号 ：使用单引号嵌套双引号的方式  ' {"name" : "水浒传" , "price":"100"} '</code></pre><p>总结： </p><p>使用JSON.parse()来解析JSON字符串，需要注意的是被转化的字符串里面的属性要使用引号，并且总体是单引号套双引号的方式，太麻烦了。 如果使用eval()  就可以忽略上述两点需要注意的地方 </p></blockquote><pre class=" language-javascript"><code class="language-javascript"><span class="token operator">&lt;</span>script type<span class="token operator">=</span><span class="token string">"text/javascript"</span><span class="token operator">></span>    <span class="token comment" spellcheck="true">//JSON字符串</span>    <span class="token keyword">var</span> jsonStr <span class="token operator">=</span> <span class="token string">'{"name" : "水浒传" , "price":"100"}'</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">//JSON对象</span>    <span class="token keyword">var</span> jsonObj <span class="token operator">=</span> JSON<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>jsonStr<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//解析JSON字符串</span>    <span class="token comment" spellcheck="true">//获取数据</span>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>jsonObj<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>jsonObj<span class="token punctuation">.</span>price<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">></span></code></pre><blockquote><p>使用eval函数解析JSON格式字符串 </p><p>eval(str)：将函数的参数作为JavaScript代码去执行</p><p>eval函数注意事项（坑）：</p><p>​使用()包裹JSON字符串</p><p>​“({name:’Java从入门到精通’,price:100 , author:{name:’吴彦祖’ , info:’从事java20年’}})”</p><p>原因：</p><p>​eval本身的问题。 由于json是以”{}”的方式来开始以及结束的。在JavaScript中，它会被当成一个语句块来处理，所以必须强制性的将它转换成一种表达式。加上圆括号的目的是迫使eval函数在处理JavaScript代码的时候强制将括号内的表达式转化为对象，而不是作为代码来执行。</p></blockquote><pre class=" language-javascript"><code class="language-javascript"><span class="token operator">&lt;</span>script type<span class="token operator">=</span><span class="token string">"text/javascript"</span><span class="token operator">></span>    <span class="token comment" spellcheck="true">//JSON字符串</span>    <span class="token keyword">var</span> jsonStr <span class="token operator">=</span>         <span class="token string">"({name:'水浒传',price:100,author:{name:'施耐庵' , info:'四大名著'}})"</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">//解析成JSON对象</span>    <span class="token keyword">var</span> jsonObj <span class="token operator">=</span> <span class="token function">eval</span><span class="token punctuation">(</span>jsonStr<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">//获取数据</span>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>jsonObj<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>jsonObj<span class="token punctuation">.</span>price<span class="token punctuation">)</span><span class="token punctuation">;</span>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>jsonObj<span class="token punctuation">.</span>author<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>jsonObj<span class="token punctuation">.</span>author<span class="token punctuation">.</span>info<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">></span></code></pre><pre class=" language-javascript"><code class="language-javascript"><span class="token operator">&lt;</span>script type<span class="token operator">=</span><span class="token string">"text/javascript"</span><span class="token operator">></span>    <span class="token comment" spellcheck="true">//JSON字符串</span>    <span class="token keyword">var</span> jsonStr1 <span class="token operator">=</span>     <span class="token string">"([{name:'水浒传',price:100,author:{name:'施耐庵' , info:'四大名著'}},{name:'三国演义',price:30,author:{name:'罗贯中' , info:'四大名著'}}])"</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">//解析成JSON对象数组</span>    <span class="token keyword">var</span> jsonObj <span class="token operator">=</span> <span class="token function">eval</span><span class="token punctuation">(</span>jsonStr1<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">//遍历获取数据</span>    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>jsonObj<span class="token punctuation">.</span>length<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>jsonObj<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>jsonObj<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>price<span class="token punctuation">)</span><span class="token punctuation">;</span>        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>jsonObj<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>author<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>jsonObj<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>author<span class="token punctuation">.</span>info<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">></span></code></pre><h4 id="3-2-对象-→-JSON字符串"><a href="#3-2-对象-→-JSON字符串" class="headerlink" title="3.2 对象 → JSON字符串"></a>3.2 对象 → JSON字符串</h4><pre class=" language-java"><code class="language-java"><span class="token operator">&lt;</span>script type<span class="token operator">=</span><span class="token string">"text/javascript"</span><span class="token operator">></span>    <span class="token comment" spellcheck="true">//对象</span>    var book <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Object</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    book<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">"三国演义"</span><span class="token punctuation">;</span>    book<span class="token punctuation">.</span>price <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">//将对象转换为JSON字符串</span>    var jsonStr <span class="token operator">=</span> JSON<span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>book<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">//打印数据</span>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>jsonStr<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">></span></code></pre><h3 id="四、Java中处理JSON"><a href="#四、Java中处理JSON" class="headerlink" title="四、Java中处理JSON"></a>四、Java中处理JSON</h3><blockquote><p>如果使用逻辑或Java原生解析类去解析JSON是非常麻烦的</p><p>项目中大多数会使用FastJSON和Jackson来操作JSON</p></blockquote><h3 id="五、FastJSON"><a href="#五、FastJSON" class="headerlink" title="五、FastJSON"></a>五、FastJSON</h3><h4 id="5-1-简介"><a href="#5-1-简介" class="headerlink" title="5.1 简介"></a>5.1 简介</h4><blockquote><p>FastJson：阿里的开源框架，被不少企业使用,是一个极其优秀的Json框架，使用此框架必须在项目中导入框架包（fastjson-1.1.33.jar）</p><p>FastJson对于json格式字符串的解析主要用到了下面三个类：</p><ol><li>JSON：FastJSON的解析器，用于JSON格式字符串与JSON对象及javaBean之间的转换</li><li>JSONObject：FastJSON提供的json对象</li><li>JSONArray：FastJSON提供json数组对象</li></ol></blockquote><h4 id="5-2-特点"><a href="#5-2-特点" class="headerlink" title="5.2 特点"></a>5.2 特点</h4><blockquote><ol><li>FastJson速度快,无论序列化和反序列化,都是当之无愧的fast</li><li>功能强大(支持普通JDK类包括任意Java Bean Class、Collection、Map、Date或enum)</li><li>零依赖(没有依赖其它任何类库)</li></ol></blockquote><h4 id="5-3-对象-→-JSON字符串"><a href="#5-3-对象-→-JSON字符串" class="headerlink" title="5.3 对象 → JSON字符串"></a>5.3 对象 → JSON字符串</h4><pre class=" language-java"><code class="language-java"><span class="token comment" spellcheck="true">//将Java对象转换为JSON格式的字符串</span><span class="token annotation punctuation">@Test</span><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test01</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    Book book <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Book</span><span class="token punctuation">(</span><span class="token string">"三国演义"</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Author</span><span class="token punctuation">(</span><span class="token string">"罗贯中"</span><span class="token punctuation">,</span><span class="token string">"四大名著"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    String jsonStr <span class="token operator">=</span> JSON<span class="token punctuation">.</span><span class="token function">toJSONString</span><span class="token punctuation">(</span>book<span class="token punctuation">)</span><span class="token punctuation">;</span>    System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>jsonStr<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span> <span class="token comment" spellcheck="true">//对象->json字符串（加过滤器）</span>    <span class="token annotation punctuation">@Test</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test02</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        Book book <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Book</span><span class="token punctuation">(</span><span class="token string">"三国演义"</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Author</span><span class="token punctuation">(</span><span class="token string">"罗贯中"</span><span class="token punctuation">,</span><span class="token string">"四大名著"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        PropertyFilter propertyFilter <span class="token operator">=</span> <span class="token punctuation">(</span>o<span class="token punctuation">,</span> s<span class="token punctuation">,</span> o1<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token punctuation">{</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>s<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token string">"price"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token comment" spellcheck="true">//忽略大小写</span>                <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>o<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> Author<span class="token punctuation">.</span><span class="token keyword">class</span> <span class="token operator">&amp;&amp;</span> s<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token string">"name"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>                <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>            <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span><span class="token punctuation">;</span>        String jsonStr <span class="token operator">=</span> JSON<span class="token punctuation">.</span><span class="token function">toJSONString</span><span class="token punctuation">(</span>book<span class="token punctuation">,</span>propertyFilter<span class="token punctuation">)</span><span class="token punctuation">;</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>jsonStr<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token comment" spellcheck="true">//书本类</span><span class="token keyword">import</span> lombok<span class="token punctuation">.</span>AllArgsConstructor<span class="token punctuation">;</span><span class="token keyword">import</span> lombok<span class="token punctuation">.</span>Data<span class="token punctuation">;</span><span class="token keyword">import</span> lombok<span class="token punctuation">.</span>NoArgsConstructor<span class="token punctuation">;</span><span class="token annotation punctuation">@Data</span><span class="token annotation punctuation">@AllArgsConstructor</span><span class="token annotation punctuation">@NoArgsConstructor</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Book</span> <span class="token punctuation">{</span>    <span class="token keyword">private</span> String name<span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token keyword">double</span> price<span class="token punctuation">;</span>    <span class="token keyword">private</span> Author author<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token comment" spellcheck="true">//作者类</span><span class="token annotation punctuation">@Data</span><span class="token annotation punctuation">@NoArgsConstructor</span><span class="token annotation punctuation">@AllArgsConstructor</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Author</span> <span class="token punctuation">{</span>    <span class="token keyword">private</span> String name<span class="token punctuation">;</span>    <span class="token keyword">private</span> String info<span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><h4 id="5-4-JSON字符串-→-对象"><a href="#5-4-JSON字符串-→-对象" class="headerlink" title="5.4 JSON字符串 → 对象"></a>5.4 JSON字符串 → 对象</h4><pre class=" language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Test03</span> <span class="token punctuation">{</span>    <span class="token annotation punctuation">@Test</span>    <span class="token comment" spellcheck="true">//Json字符串转java对象</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test01</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token comment" spellcheck="true">//{"author":{"info":"四大名著","name":"罗贯中"},"name":"三国演义","price":100}</span>        String jsonStr <span class="token operator">=</span> <span class="token string">"{\"author\":{\"info\":\"四大名著\",\"name\":\"罗贯中\"},\"name\":\"三国演义\",\"price\":100}\n"</span><span class="token punctuation">;</span>        Book book <span class="token operator">=</span> JSON<span class="token punctuation">.</span><span class="token function">parseObject</span><span class="token punctuation">(</span>jsonStr<span class="token punctuation">,</span> Book<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>book<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span></code></pre><h4 id="5-5-数组或集合-→-JSON字符串"><a href="#5-5-数组或集合-→-JSON字符串" class="headerlink" title="5.5 数组或集合 → JSON字符串"></a>5.5 数组或集合 → JSON字符串</h4><pre class=" language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Test02</span> <span class="token punctuation">{</span>    Book book1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Book</span><span class="token punctuation">(</span><span class="token string">"水浒传"</span><span class="token punctuation">,</span> <span class="token number">60</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Author</span><span class="token punctuation">(</span><span class="token string">"施耐庵"</span><span class="token punctuation">,</span> <span class="token string">"四大名著"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    Book book2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Book</span><span class="token punctuation">(</span><span class="token string">"三国演义"</span><span class="token punctuation">,</span> <span class="token number">70</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Author</span><span class="token punctuation">(</span><span class="token string">"罗贯中"</span><span class="token punctuation">,</span> <span class="token string">"四大名著"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    Book book3 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Book</span><span class="token punctuation">(</span><span class="token string">"红楼梦"</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Author</span><span class="token punctuation">(</span><span class="token string">"曹雪芹"</span><span class="token punctuation">,</span> <span class="token string">"四大名著"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    Book book4 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Book</span><span class="token punctuation">(</span><span class="token string">"西游记"</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Author</span><span class="token punctuation">(</span><span class="token string">"吴承恩"</span><span class="token punctuation">,</span> <span class="token string">"四大名著"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token annotation punctuation">@Test</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test01</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        Book<span class="token punctuation">[</span><span class="token punctuation">]</span> books <span class="token operator">=</span> <span class="token punctuation">{</span>book1<span class="token punctuation">,</span>book2<span class="token punctuation">,</span>book3<span class="token punctuation">,</span>book4<span class="token punctuation">}</span><span class="token punctuation">;</span>        String jsonStr <span class="token operator">=</span> JSON<span class="token punctuation">.</span><span class="token function">toJSONString</span><span class="token punctuation">(</span>books<span class="token punctuation">)</span><span class="token punctuation">;</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>jsonStr<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token annotation punctuation">@Test</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test02</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        ArrayList<span class="token operator">&lt;</span>Book<span class="token operator">></span> list <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token operator">&lt;</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        Collections<span class="token punctuation">.</span><span class="token function">addAll</span><span class="token punctuation">(</span>list<span class="token punctuation">,</span>book1<span class="token punctuation">,</span>book2<span class="token punctuation">,</span>book3<span class="token punctuation">,</span>book4<span class="token punctuation">)</span><span class="token punctuation">;</span>        String jsonStr <span class="token operator">=</span> JSON<span class="token punctuation">.</span><span class="token function">toJSONString</span><span class="token punctuation">(</span>list<span class="token punctuation">)</span><span class="token punctuation">;</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>jsonStr<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token annotation punctuation">@Test</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test03</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        HashMap<span class="token operator">&lt;</span>String<span class="token punctuation">,</span> Book<span class="token operator">></span> hashMap <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token operator">&lt;</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        hashMap<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"001"</span><span class="token punctuation">,</span>book1<span class="token punctuation">)</span><span class="token punctuation">;</span>        hashMap<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"002"</span><span class="token punctuation">,</span>book2<span class="token punctuation">)</span><span class="token punctuation">;</span>        hashMap<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"003"</span><span class="token punctuation">,</span>book3<span class="token punctuation">)</span><span class="token punctuation">;</span>        hashMap<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"004"</span><span class="token punctuation">,</span>book4<span class="token punctuation">)</span><span class="token punctuation">;</span>        String jsonStr <span class="token operator">=</span> JSON<span class="token punctuation">.</span><span class="token function">toJSONString</span><span class="token punctuation">(</span>hashMap<span class="token punctuation">)</span><span class="token punctuation">;</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>jsonStr<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span></code></pre><h4 id="5-6-JSON字符串-→-数组或集合"><a href="#5-6-JSON字符串-→-数组或集合" class="headerlink" title="5.6 JSON字符串 → 数组或集合"></a>5.6 JSON字符串 → 数组或集合</h4><pre class=" language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Test04</span> <span class="token punctuation">{</span>    <span class="token comment" spellcheck="true">/**     *  [{"author":{"info":"四大名著","name":"施耐庵"},"name":"水浒传","price":60}     *          ,{"author":{"info":"四大名著","name":"罗贯中"},"name":"三国演义","price":70}     *          ,{"author":{"info":"四大名著","name":"曹雪芹"},"name":"红楼梦","price":80}     *          ,{"author":{"info":"四大名著","name":"吴承恩"},"name":"西游记","price":50}]     */</span>    String jsonStr <span class="token operator">=</span> <span class="token string">"[{\"author\":{\"info\":\"四大名著\",\"name\":\"施耐庵\"},\"name\":\"水浒传\",\"price\":60},"</span> <span class="token operator">+</span>            <span class="token string">"{\"author\":{\"info\":\"四大名著\",\"name\":\"罗贯中\"},\"name\":\"三国演义\",\"price\":70},"</span> <span class="token operator">+</span>            <span class="token string">"{\"author\":{\"info\":\"四大名著\",\"name\":\"曹雪芹\"},\"name\":\"红楼梦\",\"price\":80},"</span> <span class="token operator">+</span>            <span class="token string">"{\"author\":{\"info\":\"四大名著\",\"name\":\"吴承恩\"},\"name\":\"西游记\",\"price\":50}]\n"</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">//将JSON格式的字符串转换为Java数组</span>    <span class="token annotation punctuation">@Test</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test01</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token comment" spellcheck="true">//将JSON格式的字符串解析成JSONArray对象</span>        JSONArray jsonArray <span class="token operator">=</span> JSON<span class="token punctuation">.</span><span class="token function">parseArray</span><span class="token punctuation">(</span>jsonStr<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">//将JSONArray对象转换为Java数组</span>        Book<span class="token punctuation">[</span><span class="token punctuation">]</span> books <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Book</span><span class="token punctuation">[</span>jsonArray<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> jsonArray<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token comment" spellcheck="true">//取出JSONArray 中的JSONObject对象再转换</span>            Book book <span class="token operator">=</span> jsonArray<span class="token punctuation">.</span><span class="token function">getObject</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> Book<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            books<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> book<span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span>Book book <span class="token operator">:</span> books<span class="token punctuation">)</span> <span class="token punctuation">{</span>            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>book<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token comment" spellcheck="true">/**         *         Book(name=水浒传, price=60.0, author=Author(name=施耐庵, info=四大名著))         Book(name=三国演义, price=70.0, author=Author(name=罗贯中, info=四大名著))         Book(name=红楼梦, price=80.0, author=Author(name=曹雪芹, info=四大名著))         Book(name=西游记, price=50.0, author=Author(name=吴承恩, info=四大名著))         */</span>    <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true">//将JSON格式的字符串转换为JavaList集合</span>    <span class="token annotation punctuation">@Test</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test02</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        List<span class="token operator">&lt;</span>Book<span class="token operator">></span> books <span class="token operator">=</span> JSON<span class="token punctuation">.</span><span class="token function">parseArray</span><span class="token punctuation">(</span>jsonStr<span class="token punctuation">,</span> Book<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        books<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>System<span class="token punctuation">.</span>out<span class="token operator">:</span><span class="token operator">:</span>println<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">/**         *         Book(name=水浒传, price=60.0, author=Author(name=施耐庵, info=四大名著))         Book(name=三国演义, price=70.0, author=Author(name=罗贯中, info=四大名著))         Book(name=红楼梦, price=80.0, author=Author(name=曹雪芹, info=四大名著))         Book(name=西游记, price=50.0, author=Author(name=吴承恩, info=四大名著))         */</span>    <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true">//将JSON格式的字符串转换为JavaMap集合</span>    <span class="token annotation punctuation">@Test</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test03</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token comment" spellcheck="true">/**         * {"001":{"author":{"info":"四大名著","name":"施耐庵"},"name":"水浒传","price":60},"002":{"author":{"info":"四大名著","name":"罗贯中"},"name":"三国演义","price":70},"003":{"author":{"info":"四大名著","name":"曹雪芹"},"name":"红楼梦","price":80},"004":{"author":{"info":"四大名著","name":"吴承恩"},"name":"西游记","price":50}}         */</span>        String jsonStr2 <span class="token operator">=</span> <span class="token string">"{\"001\":{\"author\":{\"info\":\"四大名著\",\"name\":\"施耐庵\"},\"name\":\"水浒传\",\"price\":60},"</span> <span class="token operator">+</span>                <span class="token string">"\"002\":{\"author\":{\"info\":\"四大名著\",\"name\":\"罗贯中\"},\"name\":\"三国演义\",\"price\":70},"</span> <span class="token operator">+</span>                <span class="token string">"\"003\":{\"author\":{\"info\":\"四大名著\",\"name\":\"曹雪芹\"},\"name\":\"红楼梦\",\"price\":80},"</span> <span class="token operator">+</span>                <span class="token string">"\"004\":{\"author\":{\"info\":\"四大名著\",\"name\":\"吴承恩\"},\"name\":\"西游记\",\"price\":50}}"</span><span class="token punctuation">;</span>        Map<span class="token operator">&lt;</span>String<span class="token punctuation">,</span> JSONObject<span class="token operator">></span> map <span class="token operator">=</span> <span class="token punctuation">(</span>Map<span class="token operator">&lt;</span>String<span class="token punctuation">,</span> JSONObject<span class="token operator">></span><span class="token punctuation">)</span> JSON<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>jsonStr2<span class="token punctuation">)</span><span class="token punctuation">;</span>        Set<span class="token operator">&lt;</span>Map<span class="token punctuation">.</span>Entry<span class="token operator">&lt;</span>String<span class="token punctuation">,</span> JSONObject<span class="token operator">>></span> entries <span class="token operator">=</span> map<span class="token punctuation">.</span><span class="token function">entrySet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span>Map<span class="token punctuation">.</span>Entry<span class="token operator">&lt;</span>String<span class="token punctuation">,</span> JSONObject<span class="token operator">></span> entry <span class="token operator">:</span> entries<span class="token punctuation">)</span> <span class="token punctuation">{</span>            String key <span class="token operator">=</span> entry<span class="token punctuation">.</span><span class="token function">getKey</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            JSONObject jsonObjectValue <span class="token operator">=</span> entry<span class="token punctuation">.</span><span class="token function">getValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment" spellcheck="true">//将JSONObject对象转换为Java对象</span>            Book book <span class="token operator">=</span> JSON<span class="token punctuation">.</span><span class="token function">toJavaObject</span><span class="token punctuation">(</span>jsonObjectValue<span class="token punctuation">,</span> Book<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>key <span class="token operator">+</span> <span class="token string">"---"</span> <span class="token operator">+</span> book<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token comment" spellcheck="true">/**         *         001---Book(name=水浒传, price=60.0, author=Author(name=施耐庵, info=四大名著))         002---Book(name=三国演义, price=70.0, author=Author(name=罗贯中, info=四大名著))         003---Book(name=红楼梦, price=80.0, author=Author(name=曹雪芹, info=四大名著))         004---Book(name=西游记, price=50.0, author=Author(name=吴承恩, info=四大名著))         */</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span></code></pre><h3 id="六、Jackson"><a href="#六、Jackson" class="headerlink" title="六、Jackson"></a>六、Jackson</h3><h4 id="6-1-简介"><a href="#6-1-简介" class="headerlink" title="6.1 简介"></a>6.1 简介</h4><blockquote><p>Jackson框架是基于Java平台的一套数据处理工具 </p><p>解析JSON，依赖jackon的三个核心类库：<br>    jackson-core-2.9.8.jar</p><p>​jackson-annotations-2.9.8.jar</p><p>​jackson-databind-2.9.8.jar</p></blockquote><h4 id="6-2-特点"><a href="#6-2-特点" class="headerlink" title="6.2 特点"></a>6.2 特点</h4><blockquote><p>使用注解，让JSON解析更加灵活</p></blockquote><h4 id="6-3-对象、集合-→-JSON字符串"><a href="#6-3-对象、集合-→-JSON字符串" class="headerlink" title="6.3 对象、集合 → JSON字符串"></a>6.3 对象、集合 → JSON字符串</h4><pre class=" language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Test01</span> <span class="token punctuation">{</span>    <span class="token annotation punctuation">@Test</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test01</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> JsonProcessingException<span class="token punctuation">{</span>        <span class="token comment" spellcheck="true">//将对象转换为JSON字符串</span>        Book book <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Book</span><span class="token punctuation">(</span><span class="token string">"Java从入门到精通"</span><span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">,</span><span class="token keyword">new</span> <span class="token class-name">Author</span><span class="token punctuation">(</span><span class="token string">"吴彦祖"</span><span class="token punctuation">,</span><span class="token string">"从事java20年"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token comment" spellcheck="true">//使用ObjectMapper来转化对象为JSON字符串</span>        ObjectMapper mapper <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ObjectMapper</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">// 配置mapper忽略空属性</span>        mapper<span class="token punctuation">.</span><span class="token function">setSerializationInclusion</span><span class="token punctuation">(</span>Include<span class="token punctuation">.</span>NON_EMPTY<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">//将对象转换为JSON字符串</span>        String jsonStr <span class="token operator">=</span> mapper<span class="token punctuation">.</span><span class="token function">writeValueAsString</span><span class="token punctuation">(</span>book<span class="token punctuation">)</span><span class="token punctuation">;</span>                System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>jsonStr<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>        <span class="token annotation punctuation">@Test</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test02</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> JsonProcessingException<span class="token punctuation">{</span>        <span class="token comment" spellcheck="true">//将集合转换为JSON字符串</span>        Book book1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Book</span><span class="token punctuation">(</span><span class="token string">"水浒传"</span><span class="token punctuation">,</span> <span class="token number">60</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Author</span><span class="token punctuation">(</span><span class="token string">"施耐庵"</span><span class="token punctuation">,</span> <span class="token string">"四大名著"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        Book book2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Book</span><span class="token punctuation">(</span><span class="token string">"三国演义"</span><span class="token punctuation">,</span> <span class="token number">70</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Author</span><span class="token punctuation">(</span><span class="token string">"罗贯中"</span><span class="token punctuation">,</span> <span class="token string">"四大名著"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        List<span class="token operator">&lt;</span>Book<span class="token operator">></span> list <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token operator">&lt;</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>book1<span class="token punctuation">)</span><span class="token punctuation">;</span>        list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>book2<span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token comment" spellcheck="true">//使用ObjectMapper来转化对象为JSON字符串</span>        ObjectMapper mapper <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ObjectMapper</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">// 配置mapper忽略空属性</span>        mapper<span class="token punctuation">.</span><span class="token function">setSerializationInclusion</span><span class="token punctuation">(</span>Include<span class="token punctuation">.</span>NON_EMPTY<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">//将对象转换为JSON字符串</span>        String jsonStr <span class="token operator">=</span> mapper<span class="token punctuation">.</span><span class="token function">writeValueAsString</span><span class="token punctuation">(</span>list<span class="token punctuation">)</span><span class="token punctuation">;</span>                System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>jsonStr<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span></code></pre><h4 id="6-4-JSON字符串-→-对象、集合"><a href="#6-4-JSON字符串-→-对象、集合" class="headerlink" title="6.4 JSON字符串 → 对象、集合"></a>6.4 JSON字符串 → 对象、集合</h4><pre class=" language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Test02</span> <span class="token punctuation">{</span>    <span class="token annotation punctuation">@Test</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test01</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> IOException<span class="token punctuation">{</span>        <span class="token comment" spellcheck="true">//json字符串对象->对象</span>         String jsonStr <span class="token operator">=</span> <span class="token string">"[{\"author\":{\"info\":\"四大名著\",\"name\":\"施耐庵\"},\"name\":\"水浒传\",\"price\":60},"</span> <span class="token operator">+</span>            <span class="token string">"{\"author\":{\"info\":\"四大名著\",\"name\":\"罗贯中\"},\"name\":\"三国演义\",\"price\":70}]"</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">//ObjectMapper类用序列化与反序列化映射器</span>        ObjectMapper mapper <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ObjectMapper</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">//当反序列化JSON时，未知属性会引起的反序列化被打断，这里我们禁用未知属性打断反序列化功能，</span>        <span class="token comment" spellcheck="true">//例如：JSON字符串里有10个属性，而我们的bean中只定义了2个属性，其它8个属性将被忽略</span>        mapper<span class="token punctuation">.</span><span class="token function">disable</span><span class="token punctuation">(</span>DeserializationFeature<span class="token punctuation">.</span>FAIL_ON_UNKNOWN_PROPERTIES<span class="token punctuation">)</span><span class="token punctuation">;</span>        Book book <span class="token operator">=</span> mapper<span class="token punctuation">.</span><span class="token function">readValue</span><span class="token punctuation">(</span>jsonStr<span class="token punctuation">,</span> Book<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>book<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token annotation punctuation">@Test</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test02</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> IOException<span class="token punctuation">{</span>        <span class="token comment" spellcheck="true">//json字符串->数组</span>        String jsonStr <span class="token operator">=</span> <span class="token string">"[{\"author\":{\"info\":\"四大名著\",\"name\":\"施耐庵\"},\"name\":\"水浒传\",\"price\":60},"</span> <span class="token operator">+</span>            <span class="token string">"{\"author\":{\"info\":\"四大名著\",\"name\":\"罗贯中\"},\"name\":\"三国演义\",\"price\":70}]"</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">//ObjectMapper类用序列化与反序列化映射器</span>        ObjectMapper mapper <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ObjectMapper</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">//当反序列化JSON时，未知属性会引起的反序列化被打断，这里我们禁用未知属性打断反序列化功能，</span>        <span class="token comment" spellcheck="true">//例如：JSON字符串里有10个属性，而我们的bean中只定义了2个属性，其它8个属性将被忽略</span>        mapper<span class="token punctuation">.</span><span class="token function">disable</span><span class="token punctuation">(</span>DeserializationFeature<span class="token punctuation">.</span>FAIL_ON_UNKNOWN_PROPERTIES<span class="token punctuation">)</span><span class="token punctuation">;</span>        List<span class="token operator">&lt;</span>Book<span class="token operator">></span> list <span class="token operator">=</span> mapper<span class="token punctuation">.</span><span class="token function">readValue</span><span class="token punctuation">(</span>jsonStr<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">TypeReference</span><span class="token operator">&lt;</span>List<span class="token operator">&lt;</span>Book<span class="token operator">>></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span>Book book <span class="token operator">:</span> list<span class="token punctuation">)</span> <span class="token punctuation">{</span>            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>book<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span></code></pre><h4 id="6-5-Jackson注解"><a href="#6-5-Jackson注解" class="headerlink" title="6.5  Jackson注解"></a>6.5  Jackson注解</h4><pre class=" language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Test01</span> <span class="token punctuation">{</span>    <span class="token annotation punctuation">@Test</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test01</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> JsonProcessingException<span class="token punctuation">{</span>        <span class="token comment" spellcheck="true">//将对象转换为JSON字符串</span>                Book book <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Book</span><span class="token punctuation">(</span><span class="token string">"三国演义"</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Author</span><span class="token punctuation">(</span><span class="token string">"罗贯中"</span><span class="token punctuation">,</span><span class="token string">"四大名著"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>                <span class="token comment" spellcheck="true">//ObjectMapper类用序列化与反序列化映射器</span>        ObjectMapper mapper <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ObjectMapper</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">// 配置mapper忽略空属性</span>        mapper<span class="token punctuation">.</span><span class="token function">setSerializationInclusion</span><span class="token punctuation">(</span>Include<span class="token punctuation">.</span>NON_EMPTY<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">//将对象转换为JSON字符串</span>        String jsonStr <span class="token operator">=</span> mapper<span class="token punctuation">.</span><span class="token function">writeValueAsString</span><span class="token punctuation">(</span>book<span class="token punctuation">)</span><span class="token punctuation">;</span>                System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>jsonStr<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>        <span class="token annotation punctuation">@Test</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test02</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> IOException<span class="token punctuation">{</span>        <span class="token comment" spellcheck="true">//json字符串对象->对象</span>        String jsonStr <span class="token operator">=</span> <span class="token string">"{\"author\":{\"info\":\"四大名著\",\"name\":\"罗贯中\"},\"name\":\"三国演义\",\"price\":100}\n"</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">//ObjectMapper类用序列化与反序列化映射器</span>        ObjectMapper mapper <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ObjectMapper</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">//当反序列化JSON时，未知属性会引起的反序列化被打断，这里我们禁用未知属性打断反序列化功能，</span>        <span class="token comment" spellcheck="true">//例如：JSON字符串里有10个属性，而我们的bean中只定义了2个属性，其它8个属性将被忽略</span>        mapper<span class="token punctuation">.</span><span class="token function">disable</span><span class="token punctuation">(</span>DeserializationFeature<span class="token punctuation">.</span>FAIL_ON_UNKNOWN_PROPERTIES<span class="token punctuation">)</span><span class="token punctuation">;</span>        Book book <span class="token operator">=</span> mapper<span class="token punctuation">.</span><span class="token function">readValue</span><span class="token punctuation">(</span>jsonStr<span class="token punctuation">,</span> Book<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>book<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">import</span> com<span class="token punctuation">.</span>fasterxml<span class="token punctuation">.</span>jackson<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span>JsonCreator<span class="token punctuation">;</span><span class="token keyword">import</span> com<span class="token punctuation">.</span>fasterxml<span class="token punctuation">.</span>jackson<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span>JsonIgnore<span class="token punctuation">;</span><span class="token keyword">import</span> com<span class="token punctuation">.</span>fasterxml<span class="token punctuation">.</span>jackson<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span>JsonProperty<span class="token punctuation">;</span><span class="token annotation punctuation">@Data</span><span class="token annotation punctuation">@AllArgsConstructor</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Book</span> <span class="token punctuation">{</span>        <span class="token annotation punctuation">@JsonProperty</span><span class="token punctuation">(</span><span class="token string">"bookName"</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">//java属性name序列化到JSON字段的名称为bookName</span>    <span class="token keyword">private</span> String name<span class="token punctuation">;</span>        <span class="token annotation punctuation">@JsonIgnore</span><span class="token comment" spellcheck="true">//在序列化与反序列化时，忽略price属性</span>    <span class="token keyword">private</span> <span class="token keyword">double</span> price<span class="token punctuation">;</span>    <span class="token keyword">private</span> Author author<span class="token punctuation">;</span>        <span class="token annotation punctuation">@JsonCreator</span><span class="token comment" spellcheck="true">//指定JSON反序列化创建Book对象时调用此构造函数</span>    <span class="token keyword">public</span> <span class="token function">Book</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span></code></pre><h3 id="七、总结"><a href="#七、总结" class="headerlink" title="七、总结"></a>七、总结</h3><blockquote><ol><li>JSON 格式：<ul><li>{} - 对象</li><li>[{},{},{}] - 数组</li></ul></li><li>JSON可以支持无限层嵌套</li><li>序列化和反序列化<ul><li>序列化：指的是将对象转换为JSON字符串的过程，即 对象 → JSON字符串</li><li>反序列化：指的是将JSON字符串转换为对象的过程，即 JSON字符串 → 对象</li></ul></li><li>浏览器中处理JSON<ul><li>parse()：使用单引号嵌套双引号的方式 </li><li>eval()：使用()包裹JSON字符串</li></ul></li><li>Java中处理JSON：使用FastJSON和Jackson框架</li></ol></blockquote><h3 id=""><a href="#" class="headerlink" title=""></a></h3>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>get和post的区别</title>
      <link href="/2023/01/31/get-he-post-de-qu-bie/"/>
      <url>/2023/01/31/get-he-post-de-qu-bie/</url>
      
        <content type="html"><![CDATA[<h1 id="GET-和-POST的区别？"><a href="#GET-和-POST的区别？" class="headerlink" title="GET 和 POST的区别？"></a>GET 和 POST的区别？</h1><p>​</p><h3 id="1-链接地址的区别"><a href="#1-链接地址的区别" class="headerlink" title="1.链接地址的区别"></a>1.链接地址的区别</h3><p>​GET：服务器地址?key=value&amp;key=value&amp;…<br>​POST：服务器地址 + 请求的数据包</p><h3 id="2-传输长度的区别"><a href="#2-传输长度的区别" class="headerlink" title="2.传输长度的区别"></a>2.传输长度的区别</h3><p>​GET：不同的浏览器有不同长度的区别<br>​POST：默认2M，可以在Tomcat\conf\server.xml中配置maxPostSize=”0” -&gt;接触输出限制</p><h3 id="3-传输类型的区别"><a href="#3-传输类型的区别" class="headerlink" title="3.传输类型的区别"></a>3.传输类型的区别</h3><p>​GET：只能传出文本数据<br>​POST：既能传出文本数据也可以传输二进制数据（文件上传）</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>Listener监听器</title>
      <link href="/2023/01/30/listener-jian-ting-qi/"/>
      <url>/2023/01/30/listener-jian-ting-qi/</url>
      
        <content type="html"><![CDATA[<h1 id="监听器"><a href="#监听器" class="headerlink" title="监听器"></a>监听器</h1><h3 id="概念"><a href="#概念" class="headerlink" title="概念"></a>概念</h3><blockquote><p>监听器用于监听web应用中某些对象信息的创建、销毁、增加，修改，删除等动作的</p><p>发生，然后作出相应的响应处理。当范围对象的状态发生变化的时候，服务器自动调用</p><p>监听器对象中的方法。</p><p>常用于统计在线人数和在线用户，系统加载时进行信息初始化，统计网站的访问量等。</p></blockquote><h3 id="创建步骤"><a href="#创建步骤" class="headerlink" title="创建步骤"></a>创建步骤</h3><blockquote><ol><li>创建类</li><li>实现指定的监听器接口中的方法</li><li>在web.xml文件中配置监听/在类上标注@WebListener 注解</li></ol></blockquote><h3 id="第一类：域对象监听器"><a href="#第一类：域对象监听器" class="headerlink" title="第一类：域对象监听器"></a>第一类：域对象监听器</h3><blockquote><p>监听域对象 创建与销毁的监听器</p></blockquote><table><thead><tr><th>监听器接口</th><th>描述</th></tr></thead><tbody><tr><td>ServletContextListener</td><td>监听Servlet上下文对象的创建、销毁</td></tr><tr><td>HttpSessionListener</td><td>监听会话对象的创建、销毁</td></tr><tr><td>ServletRequestListener</td><td>监听请求对象的创建、销毁</td></tr></tbody></table><blockquote><p>Servlet上下文对象 创建和销毁的监听器</p></blockquote><pre class=" language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ApplicationListener</span> <span class="token keyword">implements</span> <span class="token class-name">ServletContextListener</span> <span class="token punctuation">{</span>    <span class="token comment" spellcheck="true">//Servlet上下文对象创建的时候被调用</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">contextInitialized</span><span class="token punctuation">(</span>ServletContextEvent contextEvent<span class="token punctuation">)</span> <span class="token punctuation">{</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Servlet上下文对象被创建啦..."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token comment" spellcheck="true">//项目一旦启动，此处代码运行！</span>        Timer timer<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Timer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">//5秒钟之后开始执行，以后每间隔2秒发送一封邮件！</span>        timer<span class="token punctuation">.</span><span class="token function">schedule</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">TimerTask</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token annotation punctuation">@Override</span>            <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                <span class="token comment" spellcheck="true">//System.out.println("发邮件...."+new Date());</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">5000</span><span class="token punctuation">,</span> <span class="token number">2000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true">//Servlet上下文对象销毁的时候被调用</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">contextDestroyed</span><span class="token punctuation">(</span>ServletContextEvent contextEvent<span class="token punctuation">)</span> <span class="token punctuation">{</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Servlet上下文对象被销毁啦..."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">//服务器在停止的时候，要执行某些动作，那么就可以把代码写在这个位置！！！</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span></code></pre><pre class=" language-xml"><code class="language-xml"><span class="token comment" spellcheck="true">&lt;!-- web.xml中配置 --></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>listener</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>listener-class</span><span class="token punctuation">></span></span>com.dream.listener.ApplicationListener<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>listener-class</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>listener</span><span class="token punctuation">></span></span></code></pre><blockquote><p>会话对象 创建和销毁的监听器</p></blockquote><pre class=" language-java"><code class="language-java"><span class="token annotation punctuation">@WebListener</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SessionListener</span> <span class="token keyword">implements</span> <span class="token class-name">HttpSessionListener</span><span class="token punctuation">{</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">sessionCreated</span><span class="token punctuation">(</span>HttpSessionEvent event<span class="token punctuation">)</span> <span class="token punctuation">{</span>        HttpSession session <span class="token operator">=</span> event<span class="token punctuation">.</span><span class="token function">getSession</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"session对象创建啦...."</span><span class="token operator">+</span>session<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">sessionDestroyed</span><span class="token punctuation">(</span>HttpSessionEvent event<span class="token punctuation">)</span> <span class="token punctuation">{</span>        HttpSession session <span class="token operator">=</span> event<span class="token punctuation">.</span><span class="token function">getSession</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"session对象销毁啦...."</span><span class="token operator">+</span>session<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span></code></pre><blockquote><p>请求对象的创建和销毁的监听器</p></blockquote><pre class=" language-java"><code class="language-java"><span class="token annotation punctuation">@WebListener</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">RequestListener</span> <span class="token keyword">implements</span> <span class="token class-name">ServletRequestListener</span><span class="token punctuation">{</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">requestInitialized</span><span class="token punctuation">(</span>ServletRequestEvent event<span class="token punctuation">)</span> <span class="token punctuation">{</span>        ServletRequest request <span class="token operator">=</span> event<span class="token punctuation">.</span><span class="token function">getServletRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Request对象的创建...."</span><span class="token operator">+</span>request<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">requestDestroyed</span><span class="token punctuation">(</span>ServletRequestEvent event<span class="token punctuation">)</span> <span class="token punctuation">{</span>        ServletRequest request <span class="token operator">=</span> event<span class="token punctuation">.</span><span class="token function">getServletRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Request对象的销毁...."</span><span class="token operator">+</span>request<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span></code></pre><h3 id="案例：统计网站在线人数"><a href="#案例：统计网站在线人数" class="headerlink" title="案例：统计网站在线人数"></a>案例：统计网站在线人数</h3><pre class=" language-java"><code class="language-java"><span class="token annotation punctuation">@WebListener</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ApplicationListener</span> <span class="token keyword">implements</span> <span class="token class-name">ServletContextListener</span><span class="token punctuation">{</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">contextInitialized</span><span class="token punctuation">(</span>ServletContextEvent event<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token comment" spellcheck="true">//项目启动,向application对象中存一个变量，初始值0</span>        ServletContext application <span class="token operator">=</span> event<span class="token punctuation">.</span><span class="token function">getServletContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          application<span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">"count"</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">contextDestroyed</span><span class="token punctuation">(</span>ServletContextEvent event<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token annotation punctuation">@WebListener</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SessionListener</span> <span class="token keyword">implements</span> <span class="token class-name">HttpSessionListener</span> <span class="token punctuation">{</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">sessionCreated</span><span class="token punctuation">(</span>HttpSessionEvent event<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token comment" spellcheck="true">// 有人访问了 count++</span>        HttpSession session <span class="token operator">=</span> event<span class="token punctuation">.</span><span class="token function">getSession</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        ServletContext application <span class="token operator">=</span> session<span class="token punctuation">.</span><span class="token function">getServletContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> count <span class="token operator">=</span><span class="token punctuation">(</span>Integer<span class="token punctuation">)</span> application<span class="token punctuation">.</span><span class="token function">getAttribute</span><span class="token punctuation">(</span><span class="token string">"count"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        count<span class="token operator">++</span><span class="token punctuation">;</span>        application<span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">"count"</span><span class="token punctuation">,</span> count<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">sessionDestroyed</span><span class="token punctuation">(</span>HttpSessionEvent event<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token comment" spellcheck="true">// 有人离开了 count--</span>        HttpSession session <span class="token operator">=</span> event<span class="token punctuation">.</span><span class="token function">getSession</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        ServletContext application <span class="token operator">=</span> session<span class="token punctuation">.</span><span class="token function">getServletContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                Integer count <span class="token operator">=</span><span class="token punctuation">(</span>Integer<span class="token punctuation">)</span> application<span class="token punctuation">.</span><span class="token function">getAttribute</span><span class="token punctuation">(</span><span class="token string">"count"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        count<span class="token operator">--</span><span class="token punctuation">;</span>        application<span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">"count"</span><span class="token punctuation">,</span> count<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span></code></pre><h3 id="第二类：属性监听器"><a href="#第二类：属性监听器" class="headerlink" title="第二类：属性监听器"></a>第二类：属性监听器</h3><blockquote><p>监听域对象属性变化的监听器</p></blockquote><table><thead><tr><th>监听器接口</th><th>描述</th></tr></thead><tbody><tr><td>ServletContextAttributeListener</td><td>监听Servlet上下文对象属性的创建、删除、替换</td></tr><tr><td>HttpSessionAttributeListener</td><td>监听会话对象属性的创建、删除、替换</td></tr><tr><td>ServletRequestAttributeListener</td><td>监听请求对象属性的创建、删除、替换</td></tr></tbody></table><blockquote><p>Servlet上下文对象属性变化的监听器</p></blockquote><pre class=" language-java"><code class="language-java"><span class="token annotation punctuation">@WebListener</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ApplicationAttributeListener</span> <span class="token keyword">implements</span> <span class="token class-name">ServletContextAttributeListener</span><span class="token punctuation">{</span>    <span class="token comment" spellcheck="true">//Servlet上下文对象新增值的时候被调用</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">attributeAdded</span><span class="token punctuation">(</span>ServletContextAttributeEvent event<span class="token punctuation">)</span> <span class="token punctuation">{</span>        String str <span class="token operator">=</span> <span class="token string">"Servlet上下文对象中添加了属性:"</span><span class="token operator">+</span>event<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span>            <span class="token operator">+</span><span class="token string">"，属性值是:"</span><span class="token operator">+</span>event<span class="token punctuation">.</span><span class="token function">getValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>     <span class="token comment" spellcheck="true">//Servlet上下文对象删除值的时候被调用</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">attributeRemoved</span><span class="token punctuation">(</span>ServletContextAttributeEvent event<span class="token punctuation">)</span> <span class="token punctuation">{</span>        String str <span class="token operator">=</span> <span class="token string">"Servlet上下文对象中删除了属性:"</span><span class="token operator">+</span>event<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span>            <span class="token operator">+</span><span class="token string">"，属性值是:"</span><span class="token operator">+</span>event<span class="token punctuation">.</span><span class="token function">getValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true">//Servlet上下文对象替换值的时候被调用</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">attributeReplaced</span><span class="token punctuation">(</span>ServletContextAttributeEvent event<span class="token punctuation">)</span> <span class="token punctuation">{</span>        String str <span class="token operator">=</span> <span class="token string">"Servlet上下文对象中替换了属性:"</span><span class="token operator">+</span>event<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span>            <span class="token operator">+</span><span class="token string">"，属性值是:"</span><span class="token operator">+</span>event<span class="token punctuation">.</span><span class="token function">getValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span></code></pre><h3 id="第三类：监听HttpSession中的对象（JavaBean）"><a href="#第三类：监听HttpSession中的对象（JavaBean）" class="headerlink" title="第三类：监听HttpSession中的对象（JavaBean）"></a>第三类：监听HttpSession中的对象（JavaBean）</h3><blockquote><p>前两类监听器是作用在 ServletContext HttpSession ServletRequest上</p><p>第三类监听器是作用在JavaBean上的。</p><p>注意：这类监听器不需要在web.xml中配置</p></blockquote><table><thead><tr><th>监听器接口</th><th>描述</th></tr></thead><tbody><tr><td>HttpSessionBindingListener</td><td>监听会话对象中JavaBean对象的绑定、删除</td></tr><tr><td>HttpSessionActivationListener</td><td>监听会话对象中JavaBean对象的钝化、活化</td></tr></tbody></table><blockquote><p>会话对象中JavaBean对象的绑定和删除的监听器</p><p>实现了HttpSessionBindingListener接口的JavaBean对象可以感知自己被绑定到Session中和 Session中删除的事件</p><ul><li><p>当对象被绑定到HttpSession对象中时，web服务器调用该对象的</p><p>void valueBound(HttpSessionBindingEvent event)方法</p></li><li><p>当对象从HttpSession对象中解除绑定时，web服务器调用该对象的</p><p>void valueUnbound(HttpSessionBindingEvent event)方法</p></li></ul></blockquote><pre class=" language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">User</span> <span class="token keyword">implements</span> <span class="token class-name">HttpSessionBindingListener</span> <span class="token punctuation">{</span>    <span class="token keyword">private</span> <span class="token keyword">int</span> id<span class="token punctuation">;</span>    <span class="token keyword">private</span> String name<span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token function">User</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token punctuation">}</span>    <span class="token keyword">public</span> <span class="token function">User</span><span class="token punctuation">(</span><span class="token keyword">int</span> id<span class="token punctuation">,</span> String name<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>id <span class="token operator">=</span> id<span class="token punctuation">;</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">return</span> id<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setId</span><span class="token punctuation">(</span><span class="token keyword">int</span> id<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>id <span class="token operator">=</span> id<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">public</span> String <span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">return</span> name<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setName</span><span class="token punctuation">(</span>String name<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">valueBound</span><span class="token punctuation">(</span>HttpSessionBindingEvent event<span class="token punctuation">)</span> <span class="token punctuation">{</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"对象绑定到了Session中"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">valueUnbound</span><span class="token punctuation">(</span>HttpSessionBindingEvent event<span class="token punctuation">)</span> <span class="token punctuation">{</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"对象从Session中移除"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span></code></pre><pre class=" language-html"><code class="language-html">&lt;%@ page import="com.dream.vo.User"%>&lt;%@ page language="java" pageEncoding="UTF-8"%><span class="token doctype">&lt;!DOCTYPE HTML></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>ServletContextAttributeListener监听器测试<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span>    &lt;%        User user = new User(1, "aaa");        session.setAttribute("user", user);        session.removeAttribute("user");    %><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span></code></pre><blockquote><p>会话对象中JavaBean对象的钝化和活化的监听器</p><p>实现了HttpSessionActivationListener接口的JavaBean对象可以感知自己被活化（反序列化)和钝化(序列化)的事件</p><p>钝化（序列化）：在内存中JavaBean对象通过Session存储硬盘的过程</p><p>活化（反序列化）：从硬盘中通过Session取出JavaBean对象到内存的过程</p><ul><li><p>javabean对象将要随Session对象被钝化(序列化)之前，web服务器调用该对象的</p><p>void sessionWillPassivate(HttpSessionEvent event) 方法</p><p>这样javabean对象就可以知道自己将要和Session对象一起被钝化到硬盘中</p></li><li><p>javabean对象将要随Session对象被活化(反序列化)之后，web服务器调用该对象的void sessionDidActive(HttpSessionEvent event)方法</p><p>这样javabean对象就可以知道自己将要和Session对象一起被活化回到内存中</p></li></ul><p>注意： 想要随着Session 被钝化、活化的对象它的类必须实现Serializable 接口，放在</p><p>Session中没有实现Serilizable接口的对象，在Session钝化时，不会被序列化到磁盘上。</p></blockquote><pre class=" language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">User</span> <span class="token keyword">implements</span> <span class="token class-name">Serializable</span><span class="token punctuation">,</span> HttpSessionActivationListener<span class="token punctuation">{</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">long</span> serialVersionUID <span class="token operator">=</span> <span class="token operator">-</span>1566395353697458460L<span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token keyword">int</span> id<span class="token punctuation">;</span>    <span class="token keyword">private</span> String name<span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token function">User</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token punctuation">}</span>    <span class="token keyword">public</span> <span class="token function">User</span><span class="token punctuation">(</span><span class="token keyword">int</span> id<span class="token punctuation">,</span> String name<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>id <span class="token operator">=</span> id<span class="token punctuation">;</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">return</span> id<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setId</span><span class="token punctuation">(</span><span class="token keyword">int</span> id<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>id <span class="token operator">=</span> id<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">public</span> String <span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">return</span> name<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setName</span><span class="token punctuation">(</span>String name<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true">//钝化</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">sessionWillPassivate</span><span class="token punctuation">(</span>HttpSessionEvent event<span class="token punctuation">)</span> <span class="token punctuation">{</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"对象被钝化......."</span> <span class="token operator">+</span> event<span class="token punctuation">.</span><span class="token function">getSource</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true">//活化</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">sessionDidActivate</span><span class="token punctuation">(</span>HttpSessionEvent event<span class="token punctuation">)</span> <span class="token punctuation">{</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"对象被活化......"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span></code></pre><blockquote><p>在WebContent\META-INF文件夹下创建一个context.xml文件</p></blockquote><pre class=" language-xml"><code class="language-xml"><span class="token prolog">&lt;?xml version="1.0" encoding="UTF-8"?></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Context</span><span class="token punctuation">></span></span>    <span class="token comment" spellcheck="true">&lt;!--         maxIdleSwap:"1": session如果1分钟没有使用就序列化        directory: 序列化后文件所保存的路径     --></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Manager</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>org.apache.catalina.session.PersistentManager<span class="token punctuation">"</span></span>        <span class="token attr-name">maxIdleSwap</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Store</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>org.apache.catalina.session.FileStore<span class="token punctuation">"</span></span>             <span class="token attr-name">directory</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>C:\\text<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Manager</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Context</span><span class="token punctuation">></span></span></code></pre><h3 id="面试题：Session-的钝化与活化"><a href="#面试题：Session-的钝化与活化" class="headerlink" title="面试题：Session 的钝化与活化"></a>面试题：Session 的钝化与活化</h3><blockquote><ul><li>钝化（序列化）：当服务器正常关闭时,还存活着的session(在设置时间内没有销毁) 会随着服务</li></ul><p>器的关闭被以文件(“SESSIONS.ser”)的形式存储在tomcat 的work 目录下,这个过程叫</p><p>做Session 的钝化。</p><ul><li>活化（返序列化）：当服务器再次正常开启时,服务器会找到之前的“SESSIONS.ser” 文件，从中恢</li></ul><p>复之前保存起来的Session 对象，这个过程叫做Session的活化。</p><ul><li>注意事项</li></ul><ol><li>想要随着Session 被钝化、活化的对象它的类必须实现Serializable 接口，还有的是只有在服务器正常关闭的条件下，还未超时的Session 才会被钝化成文件。当Session 超时、调用invalidate方法或者服务器在非正常情况下关闭时，Session 都不会被钝化，因此也就不存在活化。</li><li>在被钝化成“SESSIONS.ser” 文件时，不会因为超过Session 过期时间而消失，这个文件会一直存在，等到下一次服务器开启时消失。</li><li>当多个Session 被钝化时，这些被钝化的Session 都被保存在一个文件中，并不会为每个Session 都建立一个文件。</li></ol></blockquote>]]></content>
      
      
      <categories>
          
          <category> JavaWeb </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>Filter过滤器</title>
      <link href="/2023/01/30/filter-guo-lu-qi/"/>
      <url>/2023/01/30/filter-guo-lu-qi/</url>
      
        <content type="html"><![CDATA[<h1 id="Filter过滤器"><a href="#Filter过滤器" class="headerlink" title="Filter过滤器"></a>Filter过滤器</h1><h3 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h3><blockquote><p>Filter：过滤器，通过Filter可以拦截访问web资源的请求与响应操作。</p><p>Servlet API中提供了一个Filter接口，开发web应用时，如果编写的Java类实现了这个接口，则把这个java类称之为过滤器。他可以拦截Jsp、Servlet、 静态图片文件、静态 html文件等，从而实现一些特殊的功能。</p><p>例如：实现URL级别的权限访问控制、过滤敏感词汇、压缩响应信息等一些高级功能。</p></blockquote><h3 id="创建步骤"><a href="#创建步骤" class="headerlink" title="创建步骤"></a>创建步骤</h3><blockquote><ol><li>创建过滤器类并实现Filter接口</li><li>在web.xml文件中配置Filter</li></ol><p>javax.servlet.Filter接口中的方法介绍：</p><table><thead><tr><th>方法</th><th>描述</th></tr></thead><tbody><tr><td>init(FilterConfig fConfig)</td><td>初始化方法</td></tr><tr><td>doFilter(ServletRequest request, ServletResponse response, FilterChain chain)</td><td>过滤方法</td></tr><tr><td>destroy()</td><td>销毁方法</td></tr></tbody></table></blockquote><p>1.创建过滤器类并实现Filter接口</p><pre class=" language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Filter01</span> <span class="token keyword">implements</span> <span class="token class-name">Filter</span> <span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token function">Filter01</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token punctuation">}</span>        <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">init</span><span class="token punctuation">(</span>FilterConfig fConfig<span class="token punctuation">)</span> <span class="token keyword">throws</span> ServletException <span class="token punctuation">{</span>    <span class="token punctuation">}</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">doFilter</span><span class="token punctuation">(</span>ServletRequest request<span class="token punctuation">,</span> ServletResponse response<span class="token punctuation">,</span> FilterChain chain<span class="token punctuation">)</span> <span class="token keyword">throws</span> IOException<span class="token punctuation">,</span> ServletException <span class="token punctuation">{</span>        <span class="token comment" spellcheck="true">//chain过滤器链</span>        <span class="token comment" spellcheck="true">//注意：如果拦截后不调用doFilter()，请求将无法传到下一个过滤器或服务器里</span>        <span class="token comment" spellcheck="true">//chain.doFilter(request, response);//放行</span>    <span class="token punctuation">}</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">destroy</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span></code></pre><p>2.在web.xml配置文件中配置过滤器信息</p><pre class=" language-xml"><code class="language-xml">  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filter</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filter-name</span><span class="token punctuation">></span></span>Filter01<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filter-name</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filter-class</span><span class="token punctuation">></span></span>com.dream.filter.Filter01<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filter-class</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filter</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filter-mapping</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filter-name</span><span class="token punctuation">></span></span>Filter01<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filter-name</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>url-pattern</span><span class="token punctuation">></span></span>/*<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>url-pattern</span><span class="token punctuation">></span></span><span class="token comment" spellcheck="true">&lt;!-- 拦截所有请求 --></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filter-mapping</span><span class="token punctuation">></span></span></code></pre><h3 id="过滤器链"><a href="#过滤器链" class="headerlink" title="过滤器链"></a>过滤器链</h3><blockquote><p>客户端对服务器请求之后，服务器在调用Servlet之前，会执行一组过滤器（多个过滤器），那么这组过滤器就称为一条过滤器链。</p></blockquote><p> ![img][img1] </p><h3 id="生命周期-单个过滤器"><a href="#生命周期-单个过滤器" class="headerlink" title="生命周期 - 单个过滤器"></a>生命周期 - 单个过滤器</h3><blockquote><p>单个过滤器的生命周期：</p><pre><code>项目启动时创建Filter01对象，调用Filter01()、init()2. 因为此过滤器配置的是所有请求拦截，所以发送请求时，调用doFilter()3. 项目更新或销毁时，调用destroy()</code></pre></blockquote><p>1.创建过滤器类并实现Filter接口</p><pre class=" language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Filter01</span> <span class="token keyword">implements</span> <span class="token class-name">Filter</span> <span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token function">Filter01</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Filter01 - Filter01()"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">init</span><span class="token punctuation">(</span>FilterConfig fConfig<span class="token punctuation">)</span> <span class="token keyword">throws</span> ServletException <span class="token punctuation">{</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Filter01 - init()"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true">//doFilter(请求,响应,过滤器链)</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">doFilter</span><span class="token punctuation">(</span>ServletRequest request<span class="token punctuation">,</span> ServletResponse response<span class="token punctuation">,</span> FilterChain chain<span class="token punctuation">)</span> <span class="token keyword">throws</span> IOException<span class="token punctuation">,</span> ServletException <span class="token punctuation">{</span>                System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Filter01执行前"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        chain<span class="token punctuation">.</span><span class="token function">doFilter</span><span class="token punctuation">(</span>request<span class="token punctuation">,</span> response<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//放行</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Filter01执行后"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">destroy</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Filter01 - destroy()"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span></code></pre><p>2.在web.xml配置文件中配置过滤器信息</p><pre class=" language-xml"><code class="language-xml">  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filter</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filter-name</span><span class="token punctuation">></span></span>Filter01<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filter-name</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filter-class</span><span class="token punctuation">></span></span>com.dream.filter.Filter01<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filter-class</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filter</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filter-mapping</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filter-name</span><span class="token punctuation">></span></span>Filter01<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filter-name</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>url-pattern</span><span class="token punctuation">></span></span>/*<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>url-pattern</span><span class="token punctuation">></span></span><span class="token comment" spellcheck="true">&lt;!-- 拦截所有请求 --></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filter-mapping</span><span class="token punctuation">></span></span></code></pre><h3 id="生命周期-多个过滤器"><a href="#生命周期-多个过滤器" class="headerlink" title="生命周期 - 多个过滤器"></a>生命周期 - 多个过滤器</h3><blockquote><p>创建顺序：创建顺序无序</p><p>执行顺序：按照web.xml中配置的顺序执行</p></blockquote><p>1.创建过滤器类并实现Filter接口</p><pre class=" language-java"><code class="language-java"><span class="token comment" spellcheck="true">//----------- Filter01 -----------------------</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Filter01</span> <span class="token keyword">implements</span> <span class="token class-name">Filter</span> <span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token function">Filter01</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Filter01 - Filter01()"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">init</span><span class="token punctuation">(</span>FilterConfig fConfig<span class="token punctuation">)</span> <span class="token keyword">throws</span> ServletException <span class="token punctuation">{</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Filter01 - init()"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">doFilter</span><span class="token punctuation">(</span>ServletRequest request<span class="token punctuation">,</span> ServletResponse response<span class="token punctuation">,</span> FilterChain chain<span class="token punctuation">)</span> <span class="token keyword">throws</span> IOException<span class="token punctuation">,</span> ServletException <span class="token punctuation">{</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Filter01执行前"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        chain<span class="token punctuation">.</span><span class="token function">doFilter</span><span class="token punctuation">(</span>request<span class="token punctuation">,</span> response<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//放行</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Filter01执行后"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>        <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">destroy</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>         System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Filter01 - destroy()"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token comment" spellcheck="true">//----------- Filter02 -----------------------</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Filter02</span> <span class="token keyword">implements</span> <span class="token class-name">Filter</span> <span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token function">Filter02</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Filter02 - Filter02()"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">init</span><span class="token punctuation">(</span>FilterConfig fConfig<span class="token punctuation">)</span> <span class="token keyword">throws</span> ServletException <span class="token punctuation">{</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Filter02 - init()"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">doFilter</span><span class="token punctuation">(</span>ServletRequest request<span class="token punctuation">,</span> ServletResponse response<span class="token punctuation">,</span> FilterChain chain<span class="token punctuation">)</span> <span class="token keyword">throws</span> IOException<span class="token punctuation">,</span> ServletException <span class="token punctuation">{</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Filter02执行前"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        chain<span class="token punctuation">.</span><span class="token function">doFilter</span><span class="token punctuation">(</span>request<span class="token punctuation">,</span> response<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//放行</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Filter02执行后"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">destroy</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>         System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Filter02 - destroy()"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token comment" spellcheck="true">//----------- Filter03 -----------------------</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Filter03</span> <span class="token keyword">implements</span> <span class="token class-name">Filter</span> <span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token function">Filter03</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Filter03 - Filter03()"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">init</span><span class="token punctuation">(</span>FilterConfig fConfig<span class="token punctuation">)</span> <span class="token keyword">throws</span> ServletException <span class="token punctuation">{</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Filter03 - init()"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">doFilter</span><span class="token punctuation">(</span>ServletRequest request<span class="token punctuation">,</span> ServletResponse response<span class="token punctuation">,</span> FilterChain chain<span class="token punctuation">)</span> <span class="token keyword">throws</span> IOException<span class="token punctuation">,</span> ServletException <span class="token punctuation">{</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Filter03执行前"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        chain<span class="token punctuation">.</span><span class="token function">doFilter</span><span class="token punctuation">(</span>request<span class="token punctuation">,</span> response<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//放行</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Filter03执行后"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">destroy</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>         System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Filter03 - destroy()"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span></code></pre><p>2.在web.xml配置文件中配置过滤器信息</p><pre class=" language-xml"><code class="language-xml">  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filter</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filter-name</span><span class="token punctuation">></span></span>Filter01<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filter-name</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filter-class</span><span class="token punctuation">></span></span>com.dream.filter.Filter01<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filter-class</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filter</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filter-mapping</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filter-name</span><span class="token punctuation">></span></span>Filter01<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filter-name</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>url-pattern</span><span class="token punctuation">></span></span>/*<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>url-pattern</span><span class="token punctuation">></span></span><span class="token comment" spellcheck="true">&lt;!-- 拦截所有请求 --></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filter-mapping</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filter</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filter-name</span><span class="token punctuation">></span></span>Filter02<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filter-name</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filter-class</span><span class="token punctuation">></span></span>com.dream.filter.Filter02<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filter-class</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filter</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filter-mapping</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filter-name</span><span class="token punctuation">></span></span>Filter02<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filter-name</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>url-pattern</span><span class="token punctuation">></span></span>/*<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>url-pattern</span><span class="token punctuation">></span></span><span class="token comment" spellcheck="true">&lt;!-- 拦截所有请求 --></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filter-mapping</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filter</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filter-name</span><span class="token punctuation">></span></span>Filter03<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filter-name</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filter-class</span><span class="token punctuation">></span></span>com.dream.filter.Filter03<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filter-class</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filter</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filter-mapping</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filter-name</span><span class="token punctuation">></span></span>Filter03<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filter-name</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>url-pattern</span><span class="token punctuation">></span></span>/*<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>url-pattern</span><span class="token punctuation">></span></span><span class="token comment" spellcheck="true">&lt;!-- 拦截所有请求 --></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filter-mapping</span><span class="token punctuation">></span></span></code></pre><h3 id="案例一：编码过滤器"><a href="#案例一：编码过滤器" class="headerlink" title="案例一：编码过滤器"></a>案例一：编码过滤器</h3><blockquote><p>解决请求和响应乱码问题</p></blockquote><pre class=" language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">EncodeFilter</span> <span class="token keyword">implements</span> <span class="token class-name">Filter</span> <span class="token punctuation">{</span>    <span class="token keyword">private</span> String encode<span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">init</span><span class="token punctuation">(</span>FilterConfig fConfig<span class="token punctuation">)</span> <span class="token keyword">throws</span> ServletException <span class="token punctuation">{</span>        <span class="token comment" spellcheck="true">//获取web.xml中该过滤器的初始化属性</span>        encode <span class="token operator">=</span> fConfig<span class="token punctuation">.</span><span class="token function">getInitParameter</span><span class="token punctuation">(</span><span class="token string">"encode"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">doFilter</span><span class="token punctuation">(</span>ServletRequest request<span class="token punctuation">,</span> ServletResponse response<span class="token punctuation">,</span> FilterChain chain<span class="token punctuation">)</span> <span class="token keyword">throws</span> IOException<span class="token punctuation">,</span> ServletException <span class="token punctuation">{</span>        HttpServletRequest req <span class="token operator">=</span> <span class="token punctuation">(</span>HttpServletRequest<span class="token punctuation">)</span> request<span class="token punctuation">;</span>        HttpServletResponse resp <span class="token operator">=</span> <span class="token punctuation">(</span>HttpServletResponse<span class="token punctuation">)</span> response<span class="token punctuation">;</span>        resp<span class="token punctuation">.</span><span class="token function">setContentType</span><span class="token punctuation">(</span><span class="token string">"text/html;charset="</span><span class="token operator">+</span>encode<span class="token punctuation">)</span><span class="token punctuation">;</span>        req<span class="token punctuation">.</span><span class="token function">setCharacterEncoding</span><span class="token punctuation">(</span>encode<span class="token punctuation">)</span><span class="token punctuation">;</span>                chain<span class="token punctuation">.</span><span class="token function">doFilter</span><span class="token punctuation">(</span>req<span class="token punctuation">,</span> resp<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">destroy</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span></code></pre><pre class=" language-xml"><code class="language-xml">  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filter</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filter-name</span><span class="token punctuation">></span></span>EncodeFilter<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filter-name</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filter-class</span><span class="token punctuation">></span></span>com.dream.filter.EncodeFilter<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filter-class</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>init-param</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>param-name</span><span class="token punctuation">></span></span>encode<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>param-name</span><span class="token punctuation">></span></span><span class="token comment" spellcheck="true">&lt;!-- 初始化参数名 --></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>param-value</span><span class="token punctuation">></span></span>UTF-8<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>param-value</span><span class="token punctuation">></span></span><span class="token comment" spellcheck="true">&lt;!-- 初始化参数值 --></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>init-param</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filter</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filter-mapping</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filter-name</span><span class="token punctuation">></span></span>EncodeFilter<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filter-name</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>url-pattern</span><span class="token punctuation">></span></span>/*<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>url-pattern</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filter-mapping</span><span class="token punctuation">></span></span></code></pre><h3 id="案例二：登录权限过滤器"><a href="#案例二：登录权限过滤器" class="headerlink" title="案例二：登录权限过滤器"></a>案例二：登录权限过滤器</h3><blockquote><p>解决权限的统一控制问题，没有登录，就不能直接跳转到其他详情页面</p></blockquote><pre class=" language-java"><code class="language-java">   <span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">LoginFilter</span> <span class="token keyword">implements</span> <span class="token class-name">Filter</span> <span class="token punctuation">{</span>   <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">init</span><span class="token punctuation">(</span>FilterConfig fConfig<span class="token punctuation">)</span> <span class="token keyword">throws</span> ServletException <span class="token punctuation">{</span>   <span class="token punctuation">}</span>   <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">doFilter</span><span class="token punctuation">(</span>ServletRequest request<span class="token punctuation">,</span> ServletResponse response<span class="token punctuation">,</span> FilterChain chain<span class="token punctuation">)</span> <span class="token keyword">throws</span> IOException<span class="token punctuation">,</span> ServletException <span class="token punctuation">{</span>       HttpServletRequest req <span class="token operator">=</span> <span class="token punctuation">(</span>HttpServletRequest<span class="token punctuation">)</span> request<span class="token punctuation">;</span>       HttpServletResponse resp <span class="token operator">=</span> <span class="token punctuation">(</span>HttpServletResponse<span class="token punctuation">)</span> response<span class="token punctuation">;</span>              <span class="token comment" spellcheck="true">//获取请求地址</span>       String uri <span class="token operator">=</span> req<span class="token punctuation">.</span><span class="token function">getRequestURI</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token comment" spellcheck="true">//获取请求链接的Get数据</span>       String queryString <span class="token operator">=</span> request<span class="token punctuation">.</span><span class="token function">getQueryString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token keyword">if</span><span class="token punctuation">(</span>queryString <span class="token operator">==</span> null<span class="token punctuation">)</span><span class="token punctuation">{</span>           queryString <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>       <span class="token punctuation">}</span>       <span class="token keyword">if</span><span class="token punctuation">(</span>uri<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span><span class="token string">"welcome.jsp"</span><span class="token punctuation">)</span> <span class="token operator">||</span>uri<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span><span class="token string">"login.jsp"</span><span class="token punctuation">)</span>                <span class="token operator">||</span> uri<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span><span class="token string">"register.jsp"</span><span class="token punctuation">)</span> <span class="token operator">||</span> queryString<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span><span class="token string">"action=login"</span><span class="token punctuation">)</span>                <span class="token operator">||</span> queryString<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span><span class="token string">"action=register"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>           chain<span class="token punctuation">.</span><span class="token function">doFilter</span><span class="token punctuation">(</span>request<span class="token punctuation">,</span> response<span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>               HttpSession session <span class="token operator">=</span> req<span class="token punctuation">.</span><span class="token function">getSession</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>           String user <span class="token operator">=</span> <span class="token punctuation">(</span>String<span class="token punctuation">)</span> session<span class="token punctuation">.</span><span class="token function">getAttribute</span><span class="token punctuation">(</span><span class="token string">"user"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>           <span class="token keyword">if</span><span class="token punctuation">(</span>user <span class="token operator">==</span> null<span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token comment" spellcheck="true">//没登录过</span>               resp<span class="token punctuation">.</span><span class="token function">sendRedirect</span><span class="token punctuation">(</span><span class="token string">"login.jsp"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>           <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span><span class="token comment" spellcheck="true">//登录过</span>               chain<span class="token punctuation">.</span><span class="token function">doFilter</span><span class="token punctuation">(</span>request<span class="token punctuation">,</span> response<span class="token punctuation">)</span><span class="token punctuation">;</span>           <span class="token punctuation">}</span>       <span class="token punctuation">}</span>   <span class="token punctuation">}</span>   <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">destroy</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>   <span class="token punctuation">}</span><span class="token punctuation">}</span></code></pre><pre class=" language-xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filter</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filter-name</span><span class="token punctuation">></span></span>LoginFilter<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filter-name</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filter-class</span><span class="token punctuation">></span></span>com.dream.filter.LoginFilter<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filter-class</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filter</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filter-mapping</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filter-name</span><span class="token punctuation">></span></span>LoginFilter<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filter-name</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>url-pattern</span><span class="token punctuation">></span></span>/*<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>url-pattern</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filter-mapping</span><span class="token punctuation">></span></span></code></pre><h3 id="案例三：关键字过滤器"><a href="#案例三：关键字过滤器" class="headerlink" title="案例三：关键字过滤器"></a>案例三：关键字过滤器</h3><blockquote><p>解决文档内的一个敏感词汇</p></blockquote><pre class=" language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SensitiveWordsFilter</span> <span class="token keyword">implements</span> <span class="token class-name">Filter</span> <span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">init</span><span class="token punctuation">(</span>FilterConfig fConfig<span class="token punctuation">)</span> <span class="token keyword">throws</span> ServletException <span class="token punctuation">{</span>    <span class="token punctuation">}</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">doFilter</span><span class="token punctuation">(</span>ServletRequest request<span class="token punctuation">,</span> ServletResponse response<span class="token punctuation">,</span> FilterChain chain<span class="token punctuation">)</span> <span class="token keyword">throws</span> IOException<span class="token punctuation">,</span> ServletException <span class="token punctuation">{</span>                chain<span class="token punctuation">.</span><span class="token function">doFilter</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">MyHttpServletRequestWapper</span><span class="token punctuation">(</span><span class="token punctuation">(</span>HttpServletRequest<span class="token punctuation">)</span> request<span class="token punctuation">)</span><span class="token punctuation">,</span> response<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//放行</span>    <span class="token punctuation">}</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">destroy</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>     <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true">///请求包装类</span>    <span class="token keyword">class</span> <span class="token class-name">MyHttpServletRequestWapper</span> <span class="token keyword">extends</span> <span class="token class-name">HttpServletRequestWrapper</span><span class="token punctuation">{</span>        <span class="token keyword">public</span> <span class="token function">MyHttpServletRequestWapper</span><span class="token punctuation">(</span>HttpServletRequest request<span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">super</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token annotation punctuation">@Override</span>        <span class="token keyword">public</span> String <span class="token function">getParameter</span><span class="token punctuation">(</span>String name<span class="token punctuation">)</span> <span class="token punctuation">{</span>                        String value <span class="token operator">=</span> <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">getParameter</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>            value <span class="token operator">=</span> value<span class="token punctuation">.</span><span class="token function">replaceAll</span><span class="token punctuation">(</span><span class="token string">"傻逼"</span><span class="token punctuation">,</span> <span class="token string">"**"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment" spellcheck="true">//把尖括号替换成字符尖括号，替换后不会认为是html里的尖括号符号</span>            value <span class="token operator">=</span> value<span class="token punctuation">.</span><span class="token function">replaceAll</span><span class="token punctuation">(</span><span class="token string">"&lt;"</span><span class="token punctuation">,</span> <span class="token string">"&amp;lt;"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            value <span class="token operator">=</span> value<span class="token punctuation">.</span><span class="token function">replaceAll</span><span class="token punctuation">(</span><span class="token string">">"</span><span class="token punctuation">,</span> <span class="token string">"&amp;gt;"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                        <span class="token keyword">return</span> value<span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span></code></pre><pre class=" language-xml"><code class="language-xml">  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filter</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filter-name</span><span class="token punctuation">></span></span>SensitiveWordsFilter<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filter-name</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filter-class</span><span class="token punctuation">></span></span>com.dream.filter.SensitiveWordsFilter<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filter-class</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filter</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filter-mapping</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filter-name</span><span class="token punctuation">></span></span>SensitiveWordsFilter<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filter-name</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>url-pattern</span><span class="token punctuation">></span></span>/*<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>url-pattern</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filter-mapping</span><span class="token punctuation">></span></span></code></pre><h3 id="注解配置过滤器（简化配置）"><a href="#注解配置过滤器（简化配置）" class="headerlink" title="注解配置过滤器（简化配置）"></a>注解配置过滤器（简化配置）</h3><blockquote><p>@WebFilter(</p><p>​value=”/*”,</p><p>​initParams= {@WebInitParam(name = “encode”, value = “UTF-8”),</p><p>​@WebInitParam(name = “name”, value = “java”)}</p><p>)</p><p>创建顺序：创建顺序无序</p><p>执行顺序：按照类名的顺序执行</p></blockquote><pre class=" language-java"><code class="language-java"><span class="token annotation punctuation">@WebFilter</span><span class="token punctuation">(</span>value<span class="token operator">=</span><span class="token string">"/*"</span><span class="token punctuation">,</span>initParams<span class="token operator">=</span><span class="token punctuation">{</span><span class="token annotation punctuation">@WebInitParam</span><span class="token punctuation">(</span>name<span class="token operator">=</span><span class="token string">"encode"</span><span class="token punctuation">,</span>value<span class="token operator">=</span><span class="token string">"UTF-8"</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">EncodeFilter</span> <span class="token keyword">implements</span> <span class="token class-name">Filter</span> <span class="token punctuation">{</span>    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">}</span></code></pre>]]></content>
      
      
      <categories>
          
          <category> JavaWeb </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>手撕TreeSet底层源码</title>
      <link href="/2023/01/11/shou-si-treeset-di-ceng-yuan-ma/"/>
      <url>/2023/01/11/shou-si-treeset-di-ceng-yuan-ma/</url>
      
        <content type="html"><![CDATA[<p>   TreeSet底层由TreeMap实现，将元素添加到TreeMapkey的位置</p><pre class=" language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TreeMap</span><span class="token operator">&lt;</span>K<span class="token punctuation">,</span>V<span class="token operator">></span> <span class="token keyword">extends</span> <span class="token class-name">AbstractMap</span><span class="token operator">&lt;</span>K<span class="token punctuation">,</span>V<span class="token operator">></span> <span class="token keyword">implements</span> <span class="token class-name">NavigableMap</span><span class="token operator">&lt;</span>K<span class="token punctuation">,</span>V<span class="token operator">></span><span class="token punctuation">{</span>        <span class="token keyword">private</span> Comparator<span class="token operator">&lt;</span>K<span class="token operator">></span> comparator<span class="token punctuation">;</span><span class="token comment" spellcheck="true">//外置比较器</span>        <span class="token comment" spellcheck="true">//使用无参构造创建TreeMap对象，外置比较器为null</span>    <span class="token keyword">public</span> <span class="token function">TreeMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        comparator <span class="token operator">=</span> null<span class="token punctuation">;</span>    <span class="token punctuation">}</span>         <span class="token comment" spellcheck="true">//使用有参构造创建TreeMap对象，外置比较器由外界传入</span>    <span class="token keyword">public</span> <span class="token function">TreeMap</span><span class="token punctuation">(</span>Comparator<span class="token operator">&lt;</span>K<span class="token operator">></span> comparator<span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>comparator <span class="token operator">=</span> comparator<span class="token punctuation">;</span>    <span class="token punctuation">}</span>        <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">put</span><span class="token punctuation">(</span>K key<span class="token punctuation">,</span>V value<span class="token punctuation">)</span><span class="token punctuation">{</span>                <span class="token comment" spellcheck="true">//下面这个判断说明了外置比较器优先级别大于内置比较器，因为底层先判断的是外置比较器是否存在</span>                <span class="token comment" spellcheck="true">//判断是否有外置比较器</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>comparator <span class="token operator">!=</span> null<span class="token punctuation">)</span><span class="token punctuation">{</span>            <span class="token comment" spellcheck="true">//有 - 就使用外置比较器的排序规则</span>            comparator<span class="token punctuation">.</span><span class="token function">compare</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>            <span class="token comment" spellcheck="true">//没有 - 就使用内置比较器的排序规则</span>            key<span class="token punctuation">.</span><span class="token function">compareTo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span></code></pre><pre class=" language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TreeSet</span><span class="token operator">&lt;</span>E<span class="token operator">></span> <span class="token keyword">extends</span> <span class="token class-name">AbstractSet</span><span class="token operator">&lt;</span>E<span class="token operator">></span> <span class="token keyword">implements</span> <span class="token class-name">NavigableSet</span><span class="token operator">&lt;</span>E<span class="token operator">></span><span class="token punctuation">{</span>        <span class="token keyword">private</span> <span class="token keyword">transient</span> NavigableMap<span class="token operator">&lt;</span>E<span class="token punctuation">,</span>Object<span class="token operator">></span> m<span class="token punctuation">;</span>        <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> Object PRESENT <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Object</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">public</span> <span class="token function">TreeSet</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        NavigableMap<span class="token operator">&lt;</span>E<span class="token punctuation">,</span>Object<span class="token operator">></span> m <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">TreeMap</span><span class="token operator">&lt;</span>E<span class="token punctuation">,</span>Object<span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token keyword">this</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>        <span class="token keyword">public</span> <span class="token function">TreeSet</span><span class="token punctuation">(</span>Comparator<span class="token operator">&lt;</span><span class="token operator">?</span> <span class="token keyword">super</span> E<span class="token operator">></span> comparator<span class="token punctuation">)</span> <span class="token punctuation">{</span>        NavigableMap<span class="token operator">&lt;</span>E<span class="token punctuation">,</span>Object<span class="token operator">></span> m <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">TreeMap</span><span class="token operator">&lt;</span><span class="token operator">></span><span class="token punctuation">(</span>comparator<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">this</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>        <span class="token function">TreeSet</span><span class="token punctuation">(</span>NavigableMap<span class="token operator">&lt;</span>E<span class="token punctuation">,</span>Object<span class="token operator">></span> m<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>m <span class="token operator">=</span> m<span class="token punctuation">;</span>    <span class="token punctuation">}</span>        <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">add</span><span class="token punctuation">(</span>E e<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">return</span> m<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>e<span class="token punctuation">,</span> PRESENT<span class="token punctuation">)</span><span class="token operator">==</span>null<span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span></code></pre><pre class=" language-java"><code class="language-java">TreeSet<span class="token operator">&lt;</span>Student<span class="token operator">></span> set <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">TreeSet</span><span class="token operator">&lt;</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//排序规则- 内置比较器</span>                TreeSet<span class="token operator">&lt;</span>Student<span class="token operator">></span> set <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">TreeSet</span><span class="token operator">&lt;</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Comparator</span><span class="token operator">&lt;</span>Student<span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token annotation punctuation">@Override</span>            <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">compare</span><span class="token punctuation">(</span>Student o1<span class="token punctuation">,</span> Student o2<span class="token punctuation">)</span> <span class="token punctuation">{</span>                <span class="token keyword">if</span><span class="token punctuation">(</span>o1<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>o2<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>                    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>                <span class="token punctuation">}</span>                                <span class="token keyword">int</span> nameLen1 <span class="token operator">=</span> o1<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">int</span> nameLen2 <span class="token operator">=</span> o2<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">if</span><span class="token punctuation">(</span>nameLen1 <span class="token operator">!=</span> nameLen2<span class="token punctuation">)</span><span class="token punctuation">{</span>                    <span class="token keyword">return</span> nameLen1 <span class="token operator">-</span> nameLen2<span class="token punctuation">;</span>                <span class="token punctuation">}</span>                                <span class="token keyword">int</span> age1 <span class="token operator">=</span> o1<span class="token punctuation">.</span><span class="token function">getAge</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">int</span> age2 <span class="token operator">=</span> o2<span class="token punctuation">.</span><span class="token function">getAge</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">if</span><span class="token punctuation">(</span>age1 <span class="token operator">!=</span> age2<span class="token punctuation">)</span><span class="token punctuation">{</span>                    <span class="token keyword">return</span> age1<span class="token operator">-</span>age2<span class="token punctuation">;</span>                <span class="token punctuation">}</span>                <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                        set<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Student</span><span class="token punctuation">(</span><span class="token string">"马小龙"</span><span class="token punctuation">,</span> <span class="token string">'男'</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">,</span> <span class="token string">"2213"</span><span class="token punctuation">,</span> <span class="token string">"002"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        set<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Student</span><span class="token punctuation">(</span><span class="token string">"李博"</span><span class="token punctuation">,</span> <span class="token string">'男'</span><span class="token punctuation">,</span> <span class="token number">21</span><span class="token punctuation">,</span> <span class="token string">"2213"</span><span class="token punctuation">,</span> <span class="token string">"001"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        set<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Student</span><span class="token punctuation">(</span><span class="token string">"黄艳清"</span><span class="token punctuation">,</span> <span class="token string">'女'</span><span class="token punctuation">,</span> <span class="token number">19</span><span class="token punctuation">,</span> <span class="token string">"2213"</span><span class="token punctuation">,</span> <span class="token string">"005"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        set<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Student</span><span class="token punctuation">(</span><span class="token string">"蔡文静"</span><span class="token punctuation">,</span> <span class="token string">'女'</span><span class="token punctuation">,</span> <span class="token number">18</span><span class="token punctuation">,</span> <span class="token string">"2213"</span><span class="token punctuation">,</span> <span class="token string">"006"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        set<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Student</span><span class="token punctuation">(</span><span class="token string">"何周钰"</span><span class="token punctuation">,</span> <span class="token string">'女'</span><span class="token punctuation">,</span> <span class="token number">23</span><span class="token punctuation">,</span> <span class="token string">"2213"</span><span class="token punctuation">,</span> <span class="token string">"003"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        set<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Student</span><span class="token punctuation">(</span><span class="token string">"范慧聪"</span><span class="token punctuation">,</span> <span class="token string">'女'</span><span class="token punctuation">,</span> <span class="token number">22</span><span class="token punctuation">,</span> <span class="token string">"2213"</span><span class="token punctuation">,</span> <span class="token string">"004"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">for</span> <span class="token punctuation">(</span>Student stu <span class="token operator">:</span> set<span class="token punctuation">)</span> <span class="token punctuation">{</span>            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>stu<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span></code></pre>]]></content>
      
      
      <categories>
          
          <category> 源码分析 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>手撕TreeMap底层源码</title>
      <link href="/2023/01/10/shou-si-treemap-di-ceng-yuan-ma/"/>
      <url>/2023/01/10/shou-si-treemap-di-ceng-yuan-ma/</url>
      
        <content type="html"><![CDATA[<pre class=" language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">HashMap</span><span class="token operator">&lt;</span>K<span class="token punctuation">,</span>V<span class="token operator">></span> <span class="token keyword">extends</span> <span class="token class-name">AbstractMap</span><span class="token operator">&lt;</span>K<span class="token punctuation">,</span>V<span class="token operator">></span> <span class="token keyword">implements</span> <span class="token class-name">Map</span><span class="token operator">&lt;</span>K<span class="token punctuation">,</span>V<span class="token operator">></span><span class="token punctuation">{</span>        <span class="token comment" spellcheck="true">//初始化容量（必须是2的幂）</span>    <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> DEFAULT_INITIAL_CAPACITY <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">&lt;&lt;</span> <span class="token number">4</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// aka 16</span>    <span class="token comment" spellcheck="true">//最大容量</span>    <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> MAXIMUM_CAPACITY <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">&lt;&lt;</span> <span class="token number">30</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">//默认的负载因子</span>    <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">float</span> DEFAULT_LOAD_FACTOR <span class="token operator">=</span> <span class="token number">0.75f</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">//长度为0的数组</span>    <span class="token keyword">static</span> <span class="token keyword">final</span> Entry<span class="token operator">&lt;</span><span class="token operator">?</span><span class="token punctuation">,</span><span class="token operator">?</span><span class="token operator">></span><span class="token punctuation">[</span><span class="token punctuation">]</span> EMPTY_TABLE <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">//hash表/hash数组</span>    <span class="token keyword">transient</span> Entry<span class="token operator">&lt;</span>K<span class="token punctuation">,</span>V<span class="token operator">></span><span class="token punctuation">[</span><span class="token punctuation">]</span> table <span class="token operator">=</span> <span class="token punctuation">(</span>Entry<span class="token operator">&lt;</span>K<span class="token punctuation">,</span>V<span class="token operator">></span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span> EMPTY_TABLE<span class="token punctuation">;</span><span class="token comment" spellcheck="true">//new Entry[16];</span>    <span class="token comment" spellcheck="true">//映射关系的个数</span>    <span class="token keyword">transient</span> <span class="token keyword">int</span> size<span class="token punctuation">;</span><span class="token comment" spellcheck="true">//0</span>    <span class="token comment" spellcheck="true">//阈值（数组长度*负载因子）</span>    <span class="token keyword">int</span> threshold<span class="token punctuation">;</span><span class="token comment" spellcheck="true">//12</span>    <span class="token comment" spellcheck="true">//负载因子</span>    <span class="token keyword">final</span> <span class="token keyword">float</span> loadFactor<span class="token punctuation">;</span><span class="token comment" spellcheck="true">//0.75f</span>    <span class="token comment" spellcheck="true">//操作数（记录添加和删除的次数）</span>    <span class="token keyword">transient</span> <span class="token keyword">int</span> modCount<span class="token punctuation">;</span><span class="token comment" spellcheck="true">//0</span>    <span class="token comment" spellcheck="true">//hash种子数</span>    <span class="token keyword">transient</span> <span class="token keyword">int</span> hashSeed <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token keyword">public</span> <span class="token function">HashMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">this</span><span class="token punctuation">(</span>DEFAULT_INITIAL_CAPACITY<span class="token punctuation">,</span> DEFAULT_LOAD_FACTOR<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>        <span class="token comment" spellcheck="true">//initialCapacity - 16</span>    <span class="token comment" spellcheck="true">//loadFactor - 0.75f</span>    <span class="token keyword">public</span> <span class="token function">HashMap</span><span class="token punctuation">(</span><span class="token keyword">int</span> initialCapacity<span class="token punctuation">,</span> <span class="token keyword">float</span> loadFactor<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>initialCapacity <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span>            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">IllegalArgumentException</span><span class="token punctuation">(</span><span class="token string">"Illegal initial capacity: "</span> <span class="token operator">+</span>                                               initialCapacity<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>initialCapacity <span class="token operator">></span> MAXIMUM_CAPACITY<span class="token punctuation">)</span>            initialCapacity <span class="token operator">=</span> MAXIMUM_CAPACITY<span class="token punctuation">;</span>                <span class="token comment" spellcheck="true">//Float.isNaN(loadFactor)考虑到外界传入的数据：new Float(0.0/0.0)</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>loadFactor <span class="token operator">&lt;=</span> <span class="token number">0</span> <span class="token operator">||</span> Float<span class="token punctuation">.</span><span class="token function">isNaN</span><span class="token punctuation">(</span>loadFactor<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">//NaN：Not a Number</span>            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">IllegalArgumentException</span><span class="token punctuation">(</span><span class="token string">"Illegal load factor: "</span> <span class="token operator">+</span>                                               loadFactor<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>loadFactor <span class="token operator">=</span> loadFactor<span class="token punctuation">;</span>        threshold <span class="token operator">=</span> initialCapacity<span class="token punctuation">;</span>        <span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>        <span class="token comment" spellcheck="true">//留给子类去重写的方法</span>    <span class="token keyword">void</span> <span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token punctuation">}</span>        <span class="token comment" spellcheck="true">//key - null</span>    <span class="token comment" spellcheck="true">//value -"写代码"</span>    <span class="token keyword">public</span> V <span class="token function">put</span><span class="token punctuation">(</span>K key<span class="token punctuation">,</span> V value<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token comment" spellcheck="true">//第一次添加元素时进入的判断</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>table <span class="token operator">==</span> EMPTY_TABLE<span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token comment" spellcheck="true">//1.计算阈值 -- 12</span>            <span class="token comment" spellcheck="true">//2.初始化hash数组</span>            <span class="token comment" spellcheck="true">//3.获取了hash种子数</span>            <span class="token function">inflateTable</span><span class="token punctuation">(</span>threshold<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token comment" spellcheck="true">//判断key是否为null</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>key <span class="token operator">==</span> null<span class="token punctuation">)</span>            <span class="token keyword">return</span> <span class="token function">putForNullKey</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token comment" spellcheck="true">//获取key的hash值</span>        <span class="token keyword">int</span> hash <span class="token operator">=</span> <span class="token function">hash</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">//利用hash值计算在数组中的下标</span>        <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token function">indexFor</span><span class="token punctuation">(</span>hash<span class="token punctuation">,</span> table<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">//一旦进入到该循环，就说明hash碰撞了</span>        <span class="token comment" spellcheck="true">//e - 0x003</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span>Entry<span class="token operator">&lt;</span>K<span class="token punctuation">,</span>V<span class="token operator">></span> e <span class="token operator">=</span> table<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span> e <span class="token operator">!=</span> null<span class="token punctuation">;</span> e <span class="token operator">=</span> e<span class="token punctuation">.</span>next<span class="token punctuation">)</span> <span class="token punctuation">{</span>            Object k<span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>e<span class="token punctuation">.</span>hash <span class="token operator">==</span> hash <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>k <span class="token operator">=</span> e<span class="token punctuation">.</span>key<span class="token punctuation">)</span> <span class="token operator">==</span> key <span class="token operator">||</span> key<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                <span class="token comment" spellcheck="true">//oldValue - 赏月</span>                V oldValue <span class="token operator">=</span> e<span class="token punctuation">.</span>value<span class="token punctuation">;</span>                e<span class="token punctuation">.</span>value <span class="token operator">=</span> value<span class="token punctuation">;</span>                e<span class="token punctuation">.</span><span class="token function">recordAccess</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">return</span> oldValue<span class="token punctuation">;</span><span class="token comment" spellcheck="true">//返回被替换的值</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span>        modCount<span class="token operator">++</span><span class="token punctuation">;</span>        <span class="token function">addEntry</span><span class="token punctuation">(</span>hash<span class="token punctuation">,</span> key<span class="token punctuation">,</span> value<span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> null<span class="token punctuation">;</span>    <span class="token punctuation">}</span>        <span class="token comment" spellcheck="true">//value - 写代码</span>    <span class="token keyword">private</span> V <span class="token function">putForNullKey</span><span class="token punctuation">(</span>V value<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token comment" spellcheck="true">//e - 0x004</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span>Entry<span class="token operator">&lt;</span>K<span class="token punctuation">,</span>V<span class="token operator">></span> e <span class="token operator">=</span> table<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span> e <span class="token operator">!=</span> null<span class="token punctuation">;</span> e <span class="token operator">=</span> e<span class="token punctuation">.</span>next<span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>e<span class="token punctuation">.</span>key <span class="token operator">==</span> null<span class="token punctuation">)</span> <span class="token punctuation">{</span>                <span class="token comment" spellcheck="true">//oldValue - 打游戏</span>                V oldValue <span class="token operator">=</span> e<span class="token punctuation">.</span>value<span class="token punctuation">;</span>                e<span class="token punctuation">.</span>value <span class="token operator">=</span> value<span class="token punctuation">;</span>                e<span class="token punctuation">.</span><span class="token function">recordAccess</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">return</span> oldValue<span class="token punctuation">;</span><span class="token comment" spellcheck="true">//返回被替换的值</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span>        modCount<span class="token operator">++</span><span class="token punctuation">;</span>        <span class="token function">addEntry</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> null<span class="token punctuation">,</span> value<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> null<span class="token punctuation">;</span>    <span class="token punctuation">}</span>        <span class="token comment" spellcheck="true">//hash - 0</span>    <span class="token comment" spellcheck="true">//key - null</span>    <span class="token comment" spellcheck="true">//value - "打游戏"</span>    <span class="token comment" spellcheck="true">//bucketIndex - 0</span>    <span class="token keyword">void</span> <span class="token function">addEntry</span><span class="token punctuation">(</span><span class="token keyword">int</span> hash<span class="token punctuation">,</span> K key<span class="token punctuation">,</span> V value<span class="token punctuation">,</span> <span class="token keyword">int</span> bucketIndex<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token comment" spellcheck="true">//判断是否扩容</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>size <span class="token operator">>=</span> threshold<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>null <span class="token operator">!=</span> table<span class="token punctuation">[</span>bucketIndex<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token comment" spellcheck="true">//进入到扩容的方法</span>            <span class="token function">resize</span><span class="token punctuation">(</span><span class="token number">2</span> <span class="token operator">*</span> table<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment" spellcheck="true">//重新计算key的hash值</span>            hash <span class="token operator">=</span> <span class="token punctuation">(</span>null <span class="token operator">!=</span> key<span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token function">hash</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">;</span>            <span class="token comment" spellcheck="true">//重新利用hash值计算在数组中的下标</span>            bucketIndex <span class="token operator">=</span> <span class="token function">indexFor</span><span class="token punctuation">(</span>hash<span class="token punctuation">,</span> table<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token function">createEntry</span><span class="token punctuation">(</span>hash<span class="token punctuation">,</span> key<span class="token punctuation">,</span> value<span class="token punctuation">,</span> bucketIndex<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>        <span class="token comment" spellcheck="true">//newCapacity - 32</span>    <span class="token keyword">void</span> <span class="token function">resize</span><span class="token punctuation">(</span><span class="token keyword">int</span> newCapacity<span class="token punctuation">)</span> <span class="token punctuation">{</span>        Entry<span class="token punctuation">[</span><span class="token punctuation">]</span> oldTable <span class="token operator">=</span> table<span class="token punctuation">;</span>        <span class="token keyword">int</span> oldCapacity <span class="token operator">=</span> oldTable<span class="token punctuation">.</span>length<span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">//如果老的容量等于了数组的最大容量,直接将阈值变作为int类型的最大值，那么以后就不会扩容</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>oldCapacity <span class="token operator">==</span> MAXIMUM_CAPACITY<span class="token punctuation">)</span> <span class="token punctuation">{</span>            threshold <span class="token operator">=</span> Integer<span class="token punctuation">.</span>MAX_VALUE<span class="token punctuation">;</span>            <span class="token keyword">return</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        Entry<span class="token punctuation">[</span><span class="token punctuation">]</span> newTable <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Entry</span><span class="token punctuation">[</span>newCapacity<span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//new Entry[32];</span>        <span class="token comment" spellcheck="true">//将老的数组中的数据复制到新的数组中，并且重新计算hash种子数</span>        <span class="token function">transfer</span><span class="token punctuation">(</span>newTable<span class="token punctuation">,</span> <span class="token function">initHashSeedAsNeeded</span><span class="token punctuation">(</span>newCapacity<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">//将新数组的地址赋值给hash数组</span>        table <span class="token operator">=</span> newTable<span class="token punctuation">;</span>           <span class="token comment" spellcheck="true">//重新计算阈值</span>        threshold <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span>Math<span class="token punctuation">.</span><span class="token function">min</span><span class="token punctuation">(</span>newCapacity <span class="token operator">*</span> loadFactor<span class="token punctuation">,</span> MAXIMUM_CAPACITY <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>        <span class="token comment" spellcheck="true">//多线程下可能会出现hash回环的问题</span>    <span class="token keyword">void</span> <span class="token function">transfer</span><span class="token punctuation">(</span>Entry<span class="token punctuation">[</span><span class="token punctuation">]</span> newTable<span class="token punctuation">,</span> <span class="token keyword">boolean</span> rehash<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">int</span> newCapacity <span class="token operator">=</span> newTable<span class="token punctuation">.</span>length<span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span>Entry<span class="token operator">&lt;</span>K<span class="token punctuation">,</span>V<span class="token operator">></span> e <span class="token operator">:</span> table<span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">while</span><span class="token punctuation">(</span>null <span class="token operator">!=</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>                Entry<span class="token operator">&lt;</span>K<span class="token punctuation">,</span>V<span class="token operator">></span> next <span class="token operator">=</span> e<span class="token punctuation">.</span>next<span class="token punctuation">;</span>                <span class="token keyword">if</span> <span class="token punctuation">(</span>rehash<span class="token punctuation">)</span> <span class="token punctuation">{</span>                    e<span class="token punctuation">.</span>hash <span class="token operator">=</span> null <span class="token operator">==</span> e<span class="token punctuation">.</span>key <span class="token operator">?</span> <span class="token number">0</span> <span class="token operator">:</span> <span class="token function">hash</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token punctuation">}</span>                <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token function">indexFor</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>hash<span class="token punctuation">,</span> newCapacity<span class="token punctuation">)</span><span class="token punctuation">;</span>                e<span class="token punctuation">.</span>next <span class="token operator">=</span> newTable<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>                newTable<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> e<span class="token punctuation">;</span>                e <span class="token operator">=</span> next<span class="token punctuation">;</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>        <span class="token comment" spellcheck="true">//hash - 0</span>    <span class="token comment" spellcheck="true">//key - null</span>    <span class="token comment" spellcheck="true">//value - "打游戏"</span>    <span class="token comment" spellcheck="true">//bucketIndex - 0</span>    <span class="token keyword">void</span> <span class="token function">createEntry</span><span class="token punctuation">(</span><span class="token keyword">int</span> hash<span class="token punctuation">,</span> K key<span class="token punctuation">,</span> V value<span class="token punctuation">,</span> <span class="token keyword">int</span> bucketIndex<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token comment" spellcheck="true">//e = null</span>        Entry<span class="token operator">&lt;</span>K<span class="token punctuation">,</span>V<span class="token operator">></span> e <span class="token operator">=</span> table<span class="token punctuation">[</span>bucketIndex<span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">//创建新的Entry对象，并把Entry对象的地址赋值到hash数组中当前下标的位置上</span>        table<span class="token punctuation">[</span>bucketIndex<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Entry</span><span class="token operator">&lt;</span><span class="token operator">></span><span class="token punctuation">(</span>hash<span class="token punctuation">,</span> key<span class="token punctuation">,</span> value<span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//0x004</span>        size<span class="token operator">++</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>        <span class="token keyword">static</span> <span class="token keyword">int</span> <span class="token function">indexFor</span><span class="token punctuation">(</span><span class="token keyword">int</span> h<span class="token punctuation">,</span> <span class="token keyword">int</span> length<span class="token punctuation">)</span> <span class="token punctuation">{</span>         <span class="token comment" spellcheck="true">//h - 0000,0000,0000,0000,0000,0000,0001,0100</span>        <span class="token comment" spellcheck="true">//length-1  - 0000,0000,0000,0000,0000,0000,0000,1111</span>        <span class="token comment" spellcheck="true">//  0000,0000,0000,0000,0000,0000,0000,0100</span>        <span class="token keyword">return</span> h <span class="token operator">&amp;</span> <span class="token punctuation">(</span>length<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>        <span class="token keyword">final</span> <span class="token keyword">int</span> <span class="token function">hash</span><span class="token punctuation">(</span>Object k<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">int</span> h <span class="token operator">=</span> hashSeed<span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">//判断种子数是否为0 并且 判断key是否为String类型</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token number">0</span> <span class="token operator">!=</span> h <span class="token operator">&amp;&amp;</span> k <span class="token keyword">instanceof</span> <span class="token class-name">String</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token comment" spellcheck="true">//获取到有hash种子数参与计算出的hash值</span>            <span class="token keyword">return</span> sun<span class="token punctuation">.</span>misc<span class="token punctuation">.</span>Hashing<span class="token punctuation">.</span><span class="token function">stringHash32</span><span class="token punctuation">(</span><span class="token punctuation">(</span>String<span class="token punctuation">)</span> k<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        h <span class="token operator">^=</span> k<span class="token punctuation">.</span><span class="token function">hashCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        h <span class="token operator">^=</span> <span class="token punctuation">(</span>h <span class="token operator">>>></span> <span class="token number">20</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span>h <span class="token operator">>>></span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> h <span class="token operator">^</span> <span class="token punctuation">(</span>h <span class="token operator">>>></span> <span class="token number">7</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span>h <span class="token operator">>>></span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>        <span class="token comment" spellcheck="true">//toSize - 16</span>    <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">inflateTable</span><span class="token punctuation">(</span><span class="token keyword">int</span> toSize<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token comment" spellcheck="true">// 传入toSize，获取到>=toSize的2的幂的数字</span>        <span class="token comment" spellcheck="true">//capacity - 16</span>        <span class="token keyword">int</span> capacity <span class="token operator">=</span> <span class="token function">roundUpToPowerOf2</span><span class="token punctuation">(</span>toSize<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">//threshold - 12</span>        threshold <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span> Math<span class="token punctuation">.</span><span class="token function">min</span><span class="token punctuation">(</span>capacity <span class="token operator">*</span> loadFactor<span class="token punctuation">,</span> MAXIMUM_CAPACITY <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        table <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Entry</span><span class="token punctuation">[</span>capacity<span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token function">initHashSeedAsNeeded</span><span class="token punctuation">(</span>capacity<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>        <span class="token comment" spellcheck="true">//根据容量计算出hash种子数</span>    <span class="token keyword">final</span> <span class="token keyword">boolean</span> <span class="token function">initHashSeedAsNeeded</span><span class="token punctuation">(</span><span class="token keyword">int</span> capacity<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">boolean</span> currentAltHashing <span class="token operator">=</span> hashSeed <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token keyword">boolean</span> useAltHashing <span class="token operator">=</span> sun<span class="token punctuation">.</span>misc<span class="token punctuation">.</span>VM<span class="token punctuation">.</span><span class="token function">isBooted</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span>                <span class="token punctuation">(</span>capacity <span class="token operator">>=</span> Holder<span class="token punctuation">.</span>ALTERNATIVE_HASHING_THRESHOLD<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">boolean</span> switching <span class="token operator">=</span> currentAltHashing <span class="token operator">^</span> useAltHashing<span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>switching<span class="token punctuation">)</span> <span class="token punctuation">{</span>            hashSeed <span class="token operator">=</span> useAltHashing                <span class="token operator">?</span> sun<span class="token punctuation">.</span>misc<span class="token punctuation">.</span>Hashing<span class="token punctuation">.</span><span class="token function">randomHashSeed</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span>                <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token keyword">return</span> switching<span class="token punctuation">;</span>    <span class="token punctuation">}</span>        <span class="token comment" spellcheck="true">//number - 16</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">int</span> <span class="token function">roundUpToPowerOf2</span><span class="token punctuation">(</span><span class="token keyword">int</span> number<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token comment" spellcheck="true">//Integer.highestOneBit(数字)：将数字二进制中最高位的1保留下来，其余全部变为0</span>        <span class="token keyword">return</span> number <span class="token operator">>=</span> MAXIMUM_CAPACITY                <span class="token operator">?</span> MAXIMUM_CAPACITY                <span class="token operator">:</span> <span class="token punctuation">(</span>number <span class="token operator">></span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">?</span> Integer<span class="token punctuation">.</span><span class="token function">highestOneBit</span><span class="token punctuation">(</span><span class="token punctuation">(</span>number <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>        <span class="token comment" spellcheck="true">//映射关系类/节点类</span>    <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">Entry</span><span class="token operator">&lt;</span>K<span class="token punctuation">,</span>V<span class="token operator">></span> <span class="token keyword">implements</span> <span class="token class-name">Map<span class="token punctuation">.</span>Entry</span><span class="token operator">&lt;</span>K<span class="token punctuation">,</span>V<span class="token operator">></span> <span class="token punctuation">{</span>        <span class="token keyword">final</span> K key<span class="token punctuation">;</span> <span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span> 键        V value<span class="token punctuation">;</span> <span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span> 值        Entry<span class="token operator">&lt;</span>K<span class="token punctuation">,</span>V<span class="token operator">></span> next<span class="token punctuation">;</span> <span class="token operator">-</span> 下一个节点的内存地址        <span class="token keyword">int</span> hash<span class="token punctuation">;</span> <span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span> key的hash值        <span class="token function">Entry</span><span class="token punctuation">(</span><span class="token keyword">int</span> h<span class="token punctuation">,</span> K k<span class="token punctuation">,</span> V v<span class="token punctuation">,</span> Entry<span class="token operator">&lt;</span>K<span class="token punctuation">,</span>V<span class="token operator">></span> n<span class="token punctuation">)</span> <span class="token punctuation">{</span>            value <span class="token operator">=</span> v<span class="token punctuation">;</span>            next <span class="token operator">=</span> n<span class="token punctuation">;</span>            key <span class="token operator">=</span> k<span class="token punctuation">;</span>            hash <span class="token operator">=</span> h<span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token punctuation">}</span></code></pre><pre class=" language-java"><code class="language-java">TreeMap<span class="token operator">&lt;</span>Student<span class="token punctuation">,</span> String<span class="token operator">></span> map <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">TreeMap</span><span class="token operator">&lt;</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>TreeMap<span class="token operator">&lt;</span>Student<span class="token punctuation">,</span> String<span class="token operator">></span> map <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">TreeMap</span><span class="token operator">&lt;</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Comparator</span><span class="token operator">&lt;</span>Student<span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token comment" spellcheck="true">//排序规则：判断两个学生是否相同，不相同就按照名字长度排序，名字长度一致就按照年龄排序</span>            <span class="token annotation punctuation">@Override</span>            <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">compare</span><span class="token punctuation">(</span>Student o1<span class="token punctuation">,</span> Student o2<span class="token punctuation">)</span> <span class="token punctuation">{</span>                <span class="token keyword">if</span><span class="token punctuation">(</span>o1<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>o2<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>                    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>                <span class="token punctuation">}</span>                                <span class="token keyword">int</span> nameLen1 <span class="token operator">=</span> o1<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">int</span> nameLen2 <span class="token operator">=</span> o2<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">if</span><span class="token punctuation">(</span>nameLen1 <span class="token operator">!=</span> nameLen2<span class="token punctuation">)</span><span class="token punctuation">{</span>                    <span class="token keyword">return</span> nameLen1 <span class="token operator">-</span> nameLen2<span class="token punctuation">;</span>                <span class="token punctuation">}</span>                                <span class="token keyword">int</span> age1 <span class="token operator">=</span> o1<span class="token punctuation">.</span><span class="token function">getAge</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">int</span> age2 <span class="token operator">=</span> o2<span class="token punctuation">.</span><span class="token function">getAge</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">if</span><span class="token punctuation">(</span>age1 <span class="token operator">!=</span> age2<span class="token punctuation">)</span><span class="token punctuation">{</span>                    <span class="token keyword">return</span> age1<span class="token operator">-</span>age2<span class="token punctuation">;</span>                <span class="token punctuation">}</span>                <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Student</span><span class="token punctuation">(</span><span class="token string">"麻生希"</span><span class="token punctuation">,</span> <span class="token string">'女'</span><span class="token punctuation">,</span> <span class="token number">21</span><span class="token punctuation">,</span> <span class="token string">"2213"</span><span class="token punctuation">,</span> <span class="token string">"001"</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">"美食"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Student</span><span class="token punctuation">(</span><span class="token string">"椎名空"</span><span class="token punctuation">,</span> <span class="token string">'女'</span><span class="token punctuation">,</span> <span class="token number">23</span><span class="token punctuation">,</span> <span class="token string">"2213"</span><span class="token punctuation">,</span> <span class="token string">"002"</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">"写代码"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Student</span><span class="token punctuation">(</span><span class="token string">"水菜丽"</span><span class="token punctuation">,</span> <span class="token string">'女'</span><span class="token punctuation">,</span> <span class="token number">22</span><span class="token punctuation">,</span> <span class="token string">"2213"</span><span class="token punctuation">,</span> <span class="token string">"003"</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">"拍电影"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Student</span><span class="token punctuation">(</span><span class="token string">"朝桐光"</span><span class="token punctuation">,</span> <span class="token string">'女'</span><span class="token punctuation">,</span> <span class="token number">19</span><span class="token punctuation">,</span> <span class="token string">"2213"</span><span class="token punctuation">,</span> <span class="token string">"004"</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">"焚香"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  </code></pre><p>TreeMap的数据结构是红黑树</p><p>红黑树的理解：小的放右边，大的方左边</p><p>红黑树的特点：根节点到任意叶子节点的黑树都是一样的</p><p>红黑树的优点：查询快</p>]]></content>
      
      
      <categories>
          
          <category> 源码分析 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>手撕HashMap底层源码</title>
      <link href="/2023/01/09/shou-si-hashmap-di-ceng-yuan-ma/"/>
      <url>/2023/01/09/shou-si-hashmap-di-ceng-yuan-ma/</url>
      
        <content type="html"><![CDATA[<pre class=" language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">HashMap</span><span class="token operator">&lt;</span>K<span class="token punctuation">,</span>V<span class="token operator">></span> <span class="token keyword">extends</span> <span class="token class-name">AbstractMap</span><span class="token operator">&lt;</span>K<span class="token punctuation">,</span>V<span class="token operator">></span> <span class="token keyword">implements</span> <span class="token class-name">Map</span><span class="token operator">&lt;</span>K<span class="token punctuation">,</span>V<span class="token operator">></span><span class="token punctuation">{</span>        <span class="token comment" spellcheck="true">//初始化容量（必须是2的幂）</span>    <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> DEFAULT_INITIAL_CAPACITY <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">&lt;&lt;</span> <span class="token number">4</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// aka 16</span>    <span class="token comment" spellcheck="true">//最大容量</span>    <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> MAXIMUM_CAPACITY <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">&lt;&lt;</span> <span class="token number">30</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">//默认的负载因子</span>    <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">float</span> DEFAULT_LOAD_FACTOR <span class="token operator">=</span> <span class="token number">0.75f</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">//长度为0的数组</span>    <span class="token keyword">static</span> <span class="token keyword">final</span> Entry<span class="token operator">&lt;</span><span class="token operator">?</span><span class="token punctuation">,</span><span class="token operator">?</span><span class="token operator">></span><span class="token punctuation">[</span><span class="token punctuation">]</span> EMPTY_TABLE <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">//hash表/hash数组</span>    <span class="token keyword">transient</span> Entry<span class="token operator">&lt;</span>K<span class="token punctuation">,</span>V<span class="token operator">></span><span class="token punctuation">[</span><span class="token punctuation">]</span> table <span class="token operator">=</span> <span class="token punctuation">(</span>Entry<span class="token operator">&lt;</span>K<span class="token punctuation">,</span>V<span class="token operator">></span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span> EMPTY_TABLE<span class="token punctuation">;</span><span class="token comment" spellcheck="true">//new Entry[16];</span>    <span class="token comment" spellcheck="true">//映射关系的个数</span>    <span class="token keyword">transient</span> <span class="token keyword">int</span> size<span class="token punctuation">;</span><span class="token comment" spellcheck="true">//0</span>    <span class="token comment" spellcheck="true">//阈值（数组长度*负载因子）</span>    <span class="token keyword">int</span> threshold<span class="token punctuation">;</span><span class="token comment" spellcheck="true">//12</span>    <span class="token comment" spellcheck="true">//负载因子</span>    <span class="token keyword">final</span> <span class="token keyword">float</span> loadFactor<span class="token punctuation">;</span><span class="token comment" spellcheck="true">//0.75f</span>    <span class="token comment" spellcheck="true">//操作数（记录添加和删除的次数）</span>    <span class="token keyword">transient</span> <span class="token keyword">int</span> modCount<span class="token punctuation">;</span><span class="token comment" spellcheck="true">//0</span>    <span class="token comment" spellcheck="true">//hash种子数</span>    <span class="token keyword">transient</span> <span class="token keyword">int</span> hashSeed <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token keyword">public</span> <span class="token function">HashMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">this</span><span class="token punctuation">(</span>DEFAULT_INITIAL_CAPACITY<span class="token punctuation">,</span> DEFAULT_LOAD_FACTOR<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>        <span class="token comment" spellcheck="true">//initialCapacity - 16</span>    <span class="token comment" spellcheck="true">//loadFactor - 0.75f</span>    <span class="token keyword">public</span> <span class="token function">HashMap</span><span class="token punctuation">(</span><span class="token keyword">int</span> initialCapacity<span class="token punctuation">,</span> <span class="token keyword">float</span> loadFactor<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>initialCapacity <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span>            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">IllegalArgumentException</span><span class="token punctuation">(</span><span class="token string">"Illegal initial capacity: "</span> <span class="token operator">+</span>                                               initialCapacity<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>initialCapacity <span class="token operator">></span> MAXIMUM_CAPACITY<span class="token punctuation">)</span>            initialCapacity <span class="token operator">=</span> MAXIMUM_CAPACITY<span class="token punctuation">;</span>                <span class="token comment" spellcheck="true">//Float.isNaN(loadFactor)考虑到外界传入的数据：new Float(0.0/0.0)</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>loadFactor <span class="token operator">&lt;=</span> <span class="token number">0</span> <span class="token operator">||</span> Float<span class="token punctuation">.</span><span class="token function">isNaN</span><span class="token punctuation">(</span>loadFactor<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">//NaN：Not a Number</span>            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">IllegalArgumentException</span><span class="token punctuation">(</span><span class="token string">"Illegal load factor: "</span> <span class="token operator">+</span>                                               loadFactor<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>loadFactor <span class="token operator">=</span> loadFactor<span class="token punctuation">;</span>        threshold <span class="token operator">=</span> initialCapacity<span class="token punctuation">;</span>        <span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>        <span class="token comment" spellcheck="true">//留给子类去重写的方法</span>    <span class="token keyword">void</span> <span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token punctuation">}</span>        <span class="token comment" spellcheck="true">//key - null</span>    <span class="token comment" spellcheck="true">//value -"写代码"</span>    <span class="token keyword">public</span> V <span class="token function">put</span><span class="token punctuation">(</span>K key<span class="token punctuation">,</span> V value<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token comment" spellcheck="true">//第一次添加元素时进入的判断</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>table <span class="token operator">==</span> EMPTY_TABLE<span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token comment" spellcheck="true">//1.计算阈值 -- 12</span>            <span class="token comment" spellcheck="true">//2.初始化hash数组</span>            <span class="token comment" spellcheck="true">//3.获取了hash种子数</span>            <span class="token function">inflateTable</span><span class="token punctuation">(</span>threshold<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token comment" spellcheck="true">//判断key是否为null</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>key <span class="token operator">==</span> null<span class="token punctuation">)</span>            <span class="token keyword">return</span> <span class="token function">putForNullKey</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token comment" spellcheck="true">//获取key的hash值</span>        <span class="token keyword">int</span> hash <span class="token operator">=</span> <span class="token function">hash</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">//利用hash值计算在数组中的下标</span>        <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token function">indexFor</span><span class="token punctuation">(</span>hash<span class="token punctuation">,</span> table<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">//一旦进入到该循环，就说明hash碰撞了</span>        <span class="token comment" spellcheck="true">//e - 0x003</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span>Entry<span class="token operator">&lt;</span>K<span class="token punctuation">,</span>V<span class="token operator">></span> e <span class="token operator">=</span> table<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span> e <span class="token operator">!=</span> null<span class="token punctuation">;</span> e <span class="token operator">=</span> e<span class="token punctuation">.</span>next<span class="token punctuation">)</span> <span class="token punctuation">{</span>            Object k<span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>e<span class="token punctuation">.</span>hash <span class="token operator">==</span> hash <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>k <span class="token operator">=</span> e<span class="token punctuation">.</span>key<span class="token punctuation">)</span> <span class="token operator">==</span> key <span class="token operator">||</span> key<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                <span class="token comment" spellcheck="true">//oldValue - 赏月</span>                V oldValue <span class="token operator">=</span> e<span class="token punctuation">.</span>value<span class="token punctuation">;</span>                e<span class="token punctuation">.</span>value <span class="token operator">=</span> value<span class="token punctuation">;</span>                e<span class="token punctuation">.</span><span class="token function">recordAccess</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">return</span> oldValue<span class="token punctuation">;</span><span class="token comment" spellcheck="true">//返回被替换的值</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span>        modCount<span class="token operator">++</span><span class="token punctuation">;</span>        <span class="token function">addEntry</span><span class="token punctuation">(</span>hash<span class="token punctuation">,</span> key<span class="token punctuation">,</span> value<span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> null<span class="token punctuation">;</span>    <span class="token punctuation">}</span>        <span class="token comment" spellcheck="true">//value - 写代码</span>    <span class="token keyword">private</span> V <span class="token function">putForNullKey</span><span class="token punctuation">(</span>V value<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token comment" spellcheck="true">//e - 0x004</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span>Entry<span class="token operator">&lt;</span>K<span class="token punctuation">,</span>V<span class="token operator">></span> e <span class="token operator">=</span> table<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span> e <span class="token operator">!=</span> null<span class="token punctuation">;</span> e <span class="token operator">=</span> e<span class="token punctuation">.</span>next<span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>e<span class="token punctuation">.</span>key <span class="token operator">==</span> null<span class="token punctuation">)</span> <span class="token punctuation">{</span>                <span class="token comment" spellcheck="true">//oldValue - 打游戏</span>                V oldValue <span class="token operator">=</span> e<span class="token punctuation">.</span>value<span class="token punctuation">;</span>                e<span class="token punctuation">.</span>value <span class="token operator">=</span> value<span class="token punctuation">;</span>                e<span class="token punctuation">.</span><span class="token function">recordAccess</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">return</span> oldValue<span class="token punctuation">;</span><span class="token comment" spellcheck="true">//返回被替换的值</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span>        modCount<span class="token operator">++</span><span class="token punctuation">;</span>        <span class="token function">addEntry</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> null<span class="token punctuation">,</span> value<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> null<span class="token punctuation">;</span>    <span class="token punctuation">}</span>        <span class="token comment" spellcheck="true">//hash - 0</span>    <span class="token comment" spellcheck="true">//key - null</span>    <span class="token comment" spellcheck="true">//value - "打游戏"</span>    <span class="token comment" spellcheck="true">//bucketIndex - 0</span>    <span class="token keyword">void</span> <span class="token function">addEntry</span><span class="token punctuation">(</span><span class="token keyword">int</span> hash<span class="token punctuation">,</span> K key<span class="token punctuation">,</span> V value<span class="token punctuation">,</span> <span class="token keyword">int</span> bucketIndex<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token comment" spellcheck="true">//判断是否扩容</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>size <span class="token operator">>=</span> threshold<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>null <span class="token operator">!=</span> table<span class="token punctuation">[</span>bucketIndex<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token comment" spellcheck="true">//进入到扩容的方法</span>            <span class="token function">resize</span><span class="token punctuation">(</span><span class="token number">2</span> <span class="token operator">*</span> table<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment" spellcheck="true">//重新计算key的hash值</span>            hash <span class="token operator">=</span> <span class="token punctuation">(</span>null <span class="token operator">!=</span> key<span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token function">hash</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">;</span>            <span class="token comment" spellcheck="true">//重新利用hash值计算在数组中的下标</span>            bucketIndex <span class="token operator">=</span> <span class="token function">indexFor</span><span class="token punctuation">(</span>hash<span class="token punctuation">,</span> table<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token function">createEntry</span><span class="token punctuation">(</span>hash<span class="token punctuation">,</span> key<span class="token punctuation">,</span> value<span class="token punctuation">,</span> bucketIndex<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>        <span class="token comment" spellcheck="true">//newCapacity - 32</span>    <span class="token keyword">void</span> <span class="token function">resize</span><span class="token punctuation">(</span><span class="token keyword">int</span> newCapacity<span class="token punctuation">)</span> <span class="token punctuation">{</span>        Entry<span class="token punctuation">[</span><span class="token punctuation">]</span> oldTable <span class="token operator">=</span> table<span class="token punctuation">;</span>        <span class="token keyword">int</span> oldCapacity <span class="token operator">=</span> oldTable<span class="token punctuation">.</span>length<span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">//如果老的容量等于了数组的最大容量,直接将阈值变作为int类型的最大值，那么以后就不会扩容</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>oldCapacity <span class="token operator">==</span> MAXIMUM_CAPACITY<span class="token punctuation">)</span> <span class="token punctuation">{</span>            threshold <span class="token operator">=</span> Integer<span class="token punctuation">.</span>MAX_VALUE<span class="token punctuation">;</span>            <span class="token keyword">return</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        Entry<span class="token punctuation">[</span><span class="token punctuation">]</span> newTable <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Entry</span><span class="token punctuation">[</span>newCapacity<span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//new Entry[32];</span>        <span class="token comment" spellcheck="true">//将老的数组中的数据复制到新的数组中，并且重新计算hash种子数</span>        <span class="token function">transfer</span><span class="token punctuation">(</span>newTable<span class="token punctuation">,</span> <span class="token function">initHashSeedAsNeeded</span><span class="token punctuation">(</span>newCapacity<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">//将新数组的地址赋值给hash数组</span>        table <span class="token operator">=</span> newTable<span class="token punctuation">;</span>           <span class="token comment" spellcheck="true">//重新计算阈值</span>        threshold <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span>Math<span class="token punctuation">.</span><span class="token function">min</span><span class="token punctuation">(</span>newCapacity <span class="token operator">*</span> loadFactor<span class="token punctuation">,</span> MAXIMUM_CAPACITY <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>        <span class="token comment" spellcheck="true">//多线程下可能会出现hash回环的问题</span>    <span class="token keyword">void</span> <span class="token function">transfer</span><span class="token punctuation">(</span>Entry<span class="token punctuation">[</span><span class="token punctuation">]</span> newTable<span class="token punctuation">,</span> <span class="token keyword">boolean</span> rehash<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">int</span> newCapacity <span class="token operator">=</span> newTable<span class="token punctuation">.</span>length<span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span>Entry<span class="token operator">&lt;</span>K<span class="token punctuation">,</span>V<span class="token operator">></span> e <span class="token operator">:</span> table<span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">while</span><span class="token punctuation">(</span>null <span class="token operator">!=</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>                Entry<span class="token operator">&lt;</span>K<span class="token punctuation">,</span>V<span class="token operator">></span> next <span class="token operator">=</span> e<span class="token punctuation">.</span>next<span class="token punctuation">;</span>                <span class="token keyword">if</span> <span class="token punctuation">(</span>rehash<span class="token punctuation">)</span> <span class="token punctuation">{</span>                    e<span class="token punctuation">.</span>hash <span class="token operator">=</span> null <span class="token operator">==</span> e<span class="token punctuation">.</span>key <span class="token operator">?</span> <span class="token number">0</span> <span class="token operator">:</span> <span class="token function">hash</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token punctuation">}</span>                <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token function">indexFor</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>hash<span class="token punctuation">,</span> newCapacity<span class="token punctuation">)</span><span class="token punctuation">;</span>                e<span class="token punctuation">.</span>next <span class="token operator">=</span> newTable<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>                newTable<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> e<span class="token punctuation">;</span>                e <span class="token operator">=</span> next<span class="token punctuation">;</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>        <span class="token comment" spellcheck="true">//hash - 0</span>    <span class="token comment" spellcheck="true">//key - null</span>    <span class="token comment" spellcheck="true">//value - "打游戏"</span>    <span class="token comment" spellcheck="true">//bucketIndex - 0</span>    <span class="token keyword">void</span> <span class="token function">createEntry</span><span class="token punctuation">(</span><span class="token keyword">int</span> hash<span class="token punctuation">,</span> K key<span class="token punctuation">,</span> V value<span class="token punctuation">,</span> <span class="token keyword">int</span> bucketIndex<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token comment" spellcheck="true">//e = null</span>        Entry<span class="token operator">&lt;</span>K<span class="token punctuation">,</span>V<span class="token operator">></span> e <span class="token operator">=</span> table<span class="token punctuation">[</span>bucketIndex<span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">//创建新的Entry对象，并把Entry对象的地址赋值到hash数组中当前下标的位置上</span>        table<span class="token punctuation">[</span>bucketIndex<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Entry</span><span class="token operator">&lt;</span><span class="token operator">></span><span class="token punctuation">(</span>hash<span class="token punctuation">,</span> key<span class="token punctuation">,</span> value<span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//0x004</span>        size<span class="token operator">++</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>        <span class="token keyword">static</span> <span class="token keyword">int</span> <span class="token function">indexFor</span><span class="token punctuation">(</span><span class="token keyword">int</span> h<span class="token punctuation">,</span> <span class="token keyword">int</span> length<span class="token punctuation">)</span> <span class="token punctuation">{</span>         <span class="token comment" spellcheck="true">//h - 0000,0000,0000,0000,0000,0000,0001,0100</span>        <span class="token comment" spellcheck="true">//length-1  - 0000,0000,0000,0000,0000,0000,0000,1111</span>        <span class="token comment" spellcheck="true">//  0000,0000,0000,0000,0000,0000,0000,0100</span>        <span class="token keyword">return</span> h <span class="token operator">&amp;</span> <span class="token punctuation">(</span>length<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>        <span class="token keyword">final</span> <span class="token keyword">int</span> <span class="token function">hash</span><span class="token punctuation">(</span>Object k<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">int</span> h <span class="token operator">=</span> hashSeed<span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">//判断种子数是否为0 并且 判断key是否为String类型</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token number">0</span> <span class="token operator">!=</span> h <span class="token operator">&amp;&amp;</span> k <span class="token keyword">instanceof</span> <span class="token class-name">String</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token comment" spellcheck="true">//获取到有hash种子数参与计算出的hash值</span>            <span class="token keyword">return</span> sun<span class="token punctuation">.</span>misc<span class="token punctuation">.</span>Hashing<span class="token punctuation">.</span><span class="token function">stringHash32</span><span class="token punctuation">(</span><span class="token punctuation">(</span>String<span class="token punctuation">)</span> k<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        h <span class="token operator">^=</span> k<span class="token punctuation">.</span><span class="token function">hashCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        h <span class="token operator">^=</span> <span class="token punctuation">(</span>h <span class="token operator">>>></span> <span class="token number">20</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span>h <span class="token operator">>>></span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> h <span class="token operator">^</span> <span class="token punctuation">(</span>h <span class="token operator">>>></span> <span class="token number">7</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span>h <span class="token operator">>>></span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>        <span class="token comment" spellcheck="true">//toSize - 16</span>    <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">inflateTable</span><span class="token punctuation">(</span><span class="token keyword">int</span> toSize<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token comment" spellcheck="true">// 传入toSize，获取到>=toSize的2的幂的数字</span>        <span class="token comment" spellcheck="true">//capacity - 16</span>        <span class="token keyword">int</span> capacity <span class="token operator">=</span> <span class="token function">roundUpToPowerOf2</span><span class="token punctuation">(</span>toSize<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">//threshold - 12</span>        threshold <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span> Math<span class="token punctuation">.</span><span class="token function">min</span><span class="token punctuation">(</span>capacity <span class="token operator">*</span> loadFactor<span class="token punctuation">,</span> MAXIMUM_CAPACITY <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        table <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Entry</span><span class="token punctuation">[</span>capacity<span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token function">initHashSeedAsNeeded</span><span class="token punctuation">(</span>capacity<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>        <span class="token comment" spellcheck="true">//根据容量计算出hash种子数</span>    <span class="token keyword">final</span> <span class="token keyword">boolean</span> <span class="token function">initHashSeedAsNeeded</span><span class="token punctuation">(</span><span class="token keyword">int</span> capacity<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">boolean</span> currentAltHashing <span class="token operator">=</span> hashSeed <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token keyword">boolean</span> useAltHashing <span class="token operator">=</span> sun<span class="token punctuation">.</span>misc<span class="token punctuation">.</span>VM<span class="token punctuation">.</span><span class="token function">isBooted</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span>                <span class="token punctuation">(</span>capacity <span class="token operator">>=</span> Holder<span class="token punctuation">.</span>ALTERNATIVE_HASHING_THRESHOLD<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">boolean</span> switching <span class="token operator">=</span> currentAltHashing <span class="token operator">^</span> useAltHashing<span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>switching<span class="token punctuation">)</span> <span class="token punctuation">{</span>            hashSeed <span class="token operator">=</span> useAltHashing                <span class="token operator">?</span> sun<span class="token punctuation">.</span>misc<span class="token punctuation">.</span>Hashing<span class="token punctuation">.</span><span class="token function">randomHashSeed</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span>                <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token keyword">return</span> switching<span class="token punctuation">;</span>    <span class="token punctuation">}</span>        <span class="token comment" spellcheck="true">//number - 16</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">int</span> <span class="token function">roundUpToPowerOf2</span><span class="token punctuation">(</span><span class="token keyword">int</span> number<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token comment" spellcheck="true">//Integer.highestOneBit(数字)：将数字二进制中最高位的1保留下来，其余全部变为0</span>        <span class="token keyword">return</span> number <span class="token operator">>=</span> MAXIMUM_CAPACITY                <span class="token operator">?</span> MAXIMUM_CAPACITY                <span class="token operator">:</span> <span class="token punctuation">(</span>number <span class="token operator">></span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">?</span> Integer<span class="token punctuation">.</span><span class="token function">highestOneBit</span><span class="token punctuation">(</span><span class="token punctuation">(</span>number <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>        <span class="token comment" spellcheck="true">//映射关系类/节点类</span>    <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">Entry</span><span class="token operator">&lt;</span>K<span class="token punctuation">,</span>V<span class="token operator">></span> <span class="token keyword">implements</span> <span class="token class-name">Map<span class="token punctuation">.</span>Entry</span><span class="token operator">&lt;</span>K<span class="token punctuation">,</span>V<span class="token operator">></span> <span class="token punctuation">{</span>        <span class="token keyword">final</span> K key<span class="token punctuation">;</span> <span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span> 键        V value<span class="token punctuation">;</span> <span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span> 值        Entry<span class="token operator">&lt;</span>K<span class="token punctuation">,</span>V<span class="token operator">></span> next<span class="token punctuation">;</span> <span class="token operator">-</span> 下一个节点的内存地址        <span class="token keyword">int</span> hash<span class="token punctuation">;</span> <span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span> key的hash值        <span class="token function">Entry</span><span class="token punctuation">(</span><span class="token keyword">int</span> h<span class="token punctuation">,</span> K k<span class="token punctuation">,</span> V v<span class="token punctuation">,</span> Entry<span class="token operator">&lt;</span>K<span class="token punctuation">,</span>V<span class="token operator">></span> n<span class="token punctuation">)</span> <span class="token punctuation">{</span>            value <span class="token operator">=</span> v<span class="token punctuation">;</span>            next <span class="token operator">=</span> n<span class="token punctuation">;</span>            key <span class="token operator">=</span> k<span class="token punctuation">;</span>            hash <span class="token operator">=</span> h<span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token punctuation">}</span></code></pre><pre class=" language-java"><code class="language-java">HashMap<span class="token operator">&lt;</span>Student<span class="token punctuation">,</span> String<span class="token operator">></span> map <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token operator">&lt;</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Student</span><span class="token punctuation">(</span><span class="token string">"李博"</span><span class="token punctuation">,</span> <span class="token string">'男'</span><span class="token punctuation">,</span> <span class="token number">23</span><span class="token punctuation">,</span> <span class="token string">"2213"</span><span class="token punctuation">,</span> <span class="token string">"001"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"品茗"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Student</span><span class="token punctuation">(</span><span class="token string">"马小龙"</span><span class="token punctuation">,</span> <span class="token string">'男'</span><span class="token punctuation">,</span> <span class="token number">24</span><span class="token punctuation">,</span> <span class="token string">"2213"</span><span class="token punctuation">,</span> <span class="token string">"002"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"焚香"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Student</span><span class="token punctuation">(</span><span class="token string">"何周钰"</span><span class="token punctuation">,</span> <span class="token string">'女'</span><span class="token punctuation">,</span> <span class="token number">18</span><span class="token punctuation">,</span> <span class="token string">"2213"</span><span class="token punctuation">,</span> <span class="token string">"003"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"赏月"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>String put1 <span class="token operator">=</span> map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Student</span><span class="token punctuation">(</span><span class="token string">"何周钰"</span><span class="token punctuation">,</span> <span class="token string">'女'</span><span class="token punctuation">,</span> <span class="token number">18</span><span class="token punctuation">,</span> <span class="token string">"2213"</span><span class="token punctuation">,</span> <span class="token string">"003"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"听雨"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>put1<span class="token punctuation">)</span><span class="token punctuation">;</span>map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>null<span class="token punctuation">,</span> <span class="token string">"打游戏"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>String put2 <span class="token operator">=</span> map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>null<span class="token punctuation">,</span> <span class="token string">"写代码"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>put2<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//打游戏</span>Set<span class="token operator">&lt;</span>Entry<span class="token operator">&lt;</span>Student<span class="token punctuation">,</span>String<span class="token operator">>></span> entrySet <span class="token operator">=</span> map<span class="token punctuation">.</span><span class="token function">entrySet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">for</span> <span class="token punctuation">(</span>Entry<span class="token operator">&lt;</span>Student<span class="token punctuation">,</span> String<span class="token operator">></span> entry <span class="token operator">:</span> entrySet<span class="token punctuation">)</span> <span class="token punctuation">{</span>    System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>entry<span class="token punctuation">.</span><span class="token function">getKey</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">" -- "</span> <span class="token operator">+</span> entry<span class="token punctuation">.</span><span class="token function">getValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><blockquote><ol><li><p>JDK1.7版本的HashMap数据结构是什么？</p><p>一维数组+单向链表</p></li><li><p>默认的初始化容量是多少？</p><p>1&lt;&lt;4 – 16</p></li><li><p>容量为什么必须是2的幂？</p><p>因为如果不为2的幂，长度-1会造成二进制中某一位为0，就会导致通过key的hash值计算出数组中的下标分布不均匀</p></li><li><p>最大容量是多少？</p><p>1&lt;&lt;30 – 1073741824</p></li><li><p>最大容量为什么是1&lt;&lt;30?</p><p>因为容量是int类型的值，并且容量必须是2的幂，1&lt;&lt;30是int类型取值范围内最大的2的幂的数字，所以最大容量就是1&lt;&lt;30</p></li><li><p>默认的负载因子是多少？其作用是什么？</p><p>0.75f</p><p>作用：控制何时扩容，因为阈值(扩容值)=容量*负载因子</p></li><li><p>默认的负载因子为什么是0.75？</p><p>因为取得了时间和空间的平衡</p><p>如果负载因子过小（比如0.1），利用时间，牺牲空间</p><p>如果负载因子过大（比如1.0），利用空间，牺牲时间</p></li><li><p>什么叫做hash冲突？</p><p>多个对象的hash值相同，导致在数组中的下标也是相同的，这就是hash冲突</p><p>使用HashMap应该尽量避免hash冲突，因为效率低下</p></li><li><p>怎么提高HashMap的运行效率呢？</p><p>key所属的类重写hashCode()和equals()，减少hash碰撞</p></li><li><p>HashMap何时扩容？</p><p>当前元素个数大于等于阈值，并且添加的当前下标上的元素不为null</p></li><li><p>HashMap存放nullkey的位置在哪？</p><p>存放在hash表的下标为0的位置</p></li><li><p>HashMap的扩容机制是什么？</p><p>是原来数组的长度的两倍</p></li><li><p>什么是Hash回环？</p><p>在多线程的情况下</p><p>一个线程在不断的添加元素，导致了扩容，扩容还没有完成（局部单向链表的回环）</p><p>另一个线程抢到CPU资源后，遍历数据，就会出现Hash回环的问题</p><p>如果出现Hash回环，HashMap不应该背锅，因为HashMap明确表示该实现不是一个线程安全的类，如果多线程下使用Map，应该使用线程安全的Map（ConcurrentHashMsap）</p></li><li><p>JDK1.7版本的HashMap和JDK1.8版本的HashMap有什么区别？</p><p>JDK1.7版本的HashMap的数据结构是：一维数组+单向链表</p><p>JDK1.8版本的HashMap的数据结构是：一维数组+单向链表  —- 单向链表长度&gt;8  —-&gt;单向链表+二叉树</p><p>JDK1.7版本的HashMap的插入方式是：头插法</p><p>JDK1.8版本的HashMap的插入方式是：尾插法</p><p>JDK1.8版本计算hash值更加简便：int h = key.hashCode()) ^ (h &gt;&gt;&gt; 16），二进制高16位^低十六位</p></li><li><p>JDK1.8版本的HashMap数据结果会发生改变？</p><p>一维数组+单向链表  —- 单向链表长度&gt;8  —-&gt;单向链表+二叉树</p><p>因为单向链表的查询效率较低，二叉树的效率高</p></li><li><p>JDK1.8版本的HashMap单向链表长度为什么大于8后会将单向链表转换成二叉树？</p><p>因为泊松分布</p></li></ol></blockquote><blockquote><p>为什么要看源码？</p><ol><li>面试的差异性</li><li>通过看底层源码可以学习到很多编程思维</li><li>看懂源码后，对该集合的运用会更加得心应手</li></ol></blockquote>]]></content>
      
      
      <categories>
          
          <category> 源码分析 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>初识servlet</title>
      <link href="/2023/01/09/servlet/"/>
      <url>/2023/01/09/servlet/</url>
      
        <content type="html"><![CDATA[<pre class=" language-java"><code class="language-java"><span class="token operator">*</span>  注意：<span class="token operator">*</span>      <span class="token number">1</span><span class="token punctuation">.</span>Servlet对象是在普遍情况下是单例的，但是在实现了SingleThreadModel接口，当Servlet有线程阻塞的情况下就会新创建一个对象<span class="token operator">*</span>      <span class="token number">2</span><span class="token punctuation">.</span>重写<span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">--</span> 无参<span class="token operator">*</span>          定制当前Servlet初始化的功能<span class="token operator">*</span><span class="token operator">*</span>  Servlet何时被创建？<span class="token operator">*</span>      <span class="token number">1</span><span class="token punctuation">.</span>第一次想Servlet发送请求时<span class="token operator">*</span>      <span class="token number">2</span><span class="token punctuation">.</span>在web<span class="token punctuation">.</span>xml <span class="token operator">-</span><span class="token operator">></span> <span class="token operator">&lt;</span>servlet<span class="token operator">></span>标签中配置了<span class="token operator">&lt;</span>load<span class="token operator">-</span>on<span class="token operator">-</span>startup<span class="token operator">></span>数字<span class="token operator">&lt;</span><span class="token operator">/</span>load<span class="token operator">-</span>on<span class="token operator">-</span>stSingleThreadModel接口，当Servlet有线程阻塞的情况下就会新创建一个对象rtup<span class="token operator">></span>，项目启动时就创建Servlet对象<span class="token operator">*</span>      注意：<span class="token operator">&lt;</span>load<span class="token operator">-</span>on<span class="token operator">-</span>startup<span class="token operator">></span>数字<span class="token operator">&lt;</span><span class="token operator">/</span>load<span class="token operator">-</span>on<span class="token operator">-</span>startup<span class="token operator">></span>，数字必须大于<span class="token number">0</span>，数字越小优先级越高<span class="token operator">*</span><span class="token operator">*</span>  创建Servlet的步骤 <span class="token operator">--</span> 版本<span class="token number">1</span>：<span class="token operator">*</span>      <span class="token number">1</span><span class="token punctuation">.</span>创建类，继承HttpServlet<span class="token operator">*</span>      <span class="token number">2</span><span class="token punctuation">.</span>在web<span class="token punctuation">.</span>xml中配置Servlet信息<span class="token operator">*</span><span class="token operator">*</span>  创建Servlet的步骤 <span class="token operator">--</span> 版本<span class="token number">2</span>：<span class="token operator">*</span>      <span class="token number">1</span><span class="token punctuation">.</span>创建类，继承HttpServlet<span class="token operator">*</span>      <span class="token number">2</span><span class="token punctuation">.</span>使用WebServlet的注解去配置Servlet的信息</code></pre><h1 id="Servlet生命周期"><a href="#Servlet生命周期" class="headerlink" title="Servlet生命周期"></a>Servlet生命周期</h1><ol><li><p>用户第一次发送请求，会创建Servlet对象，然后调用构造方法和init()初始化方法</p><p><img src="http://rnn4o4eu8.hd-bkt.clouddn.com/blog_image/image-20230109130634391.png"></p></li><li><p>根据请求类型去调用doGet，doPost等方法</p><p><img src="http://rnn4o4eu8.hd-bkt.clouddn.com/blog_image/image-20230109130741677.png" alt="image-20230109130741677"></p></li><li><p>在项目销毁或者关闭服务器的时候调用destroy方法销毁</p><p><img src="http://rnn4o4eu8.hd-bkt.clouddn.com/blog_image/image-20230109130723641.png"></p></li></ol><h1 id="Servlet创建流程图"><a href="#Servlet创建流程图" class="headerlink" title="Servlet创建流程图"></a>Servlet创建流程图</h1><p><img src="http://rnn4o4eu8.hd-bkt.clouddn.com/blog_image/image-20230109130815223.png"></p><h1 id="WebServlet注解"><a href="#WebServlet注解" class="headerlink" title="@WebServlet注解"></a>@WebServlet注解</h1><h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>Servlet 中，web.xml 扮演的角色十分的重要，它可以将所有的 Servlet 的配置集中进行管理，但是若项目中 Servelt 数量较多时，web.xml 的配置会变得十分的冗长。这种情况下，注解（Annotation）就是一种更好的选择。</p><h2 id="一、-WebServlet-注解的属性"><a href="#一、-WebServlet-注解的属性" class="headerlink" title="一、@WebServlet 注解的属性"></a>一、@WebServlet 注解的属性</h2><p><img src="http://rnn4o4eu8.hd-bkt.clouddn.com/blog_image/a0d973f655b34ca6a4e4267689f81acb.png"></p><h2 id="二、-WebServlet-注解的使用"><a href="#二、-WebServlet-注解的使用" class="headerlink" title="二、@WebServlet 注解的使用"></a>二、@WebServlet 注解的使用</h2><h3 id="1-启用注解支持"><a href="#1-启用注解支持" class="headerlink" title="1. 启用注解支持"></a>1. 启用注解支持</h3><p>web.xml 的顶层标签 中有一个属性：metadata-complete，该属性用于指定当前 web.xml 是否是完全的。若该属性设置为 true，则容器在部署时将只依赖 web.xml，忽略所有的注解。若不配置该属性，或者将其设置为 false，则表示启用注解支持。<br>由于 metadata-complete 属性的默认值是 false，即默认启用 Servlet 注解支持，所以默认情况下，使用该注解时，不必创建 web.xml 文件。</p><h3 id="2-使用-WebServlet-注解"><a href="#2-使用-WebServlet-注解" class="headerlink" title="2.使用 @WebServlet 注解"></a>2.使用 @WebServlet 注解</h3><p>@WebServlet 属于类级别的注解，标注在继承了 HttpServlet 的类之上。常用的写法是将 Servlet 的相对请求路径（即 value）直接写在注解内，<br>@WebServlet(​urlPatterns = “/MyServlet”)。<br>@Web​Servlet(“/MyServlet”) 省略了 urlPatterns 属性名<br>如果 @WebServlet 中需要设置多个属性，则属性之间必须使用逗号隔开.<br>通过实现 Serlvet 接口或继承 GenericServlet 创建的 Servlet 类无法使用 @WebServlet 注解。<br>使用 @WebServlet 注解配置的 Servlet 类，不要在 web.xml 文件中再次配置该 Servlet 相关属性。若同时使用 web.xml 与 @WebServlet 配置同一 Servlet 类，则 web.xml 中 的值与注解中 name 取值不能相同，否则容器会忽略注解中的配置。</p><p><img src="http://rnn4o4eu8.hd-bkt.clouddn.com/blog_image/image-20230109132036384.png"></p><hr><h3 id="WebServlet-注解-和-web-xml-的区别"><a href="#WebServlet-注解-和-web-xml-的区别" class="headerlink" title="@WebServlet 注解 和 web.xml 的区别"></a>@WebServlet 注解 和 web.xml 的区别</h3><p>使用 web.xml 或 @WebServlet 注解都可以配置 Servlet<br>@WebServlet 注解配置 Servlet<br>优点：@WebServlet 直接在 Servlet 类中使用，代码量少，配置简单。每个类只关注自身业务逻辑，与其他 Servlet 类互不干扰，适合多人同时开发。<br>缺点：Servlet 较多时，每个 Servlet 的配置分布在各自的类中，不便于查找和修改。</p><p>web.xml 配置文件配置 Servlet<br>优点：集中管理 Servlet 的配置，便于查找和修改。<br>缺点：代码较繁琐，可读性不强，不易于理解。</p><h1 id="请求转发和重定向区别"><a href="#请求转发和重定向区别" class="headerlink" title="请求转发和重定向区别"></a>请求转发和重定向区别</h1><ol><li>请求转发地址栏url不会改变；重定向会改变</li><li>请求转发只发送一次请求，可以实现request域对象的数据共享；重定向可以发送多次请求，数据会丢失</li><li>请求转发是request对象调用方法；重定向是response对象调用方法</li><li>请求转发是服务器行为，因此只能在项目内部进行转发；重定向是客户端浏览器行为，所以可以跳转到不是受保护页面(即WEB-INF下的页面)的其他任意页面</li></ol>]]></content>
      
      
      <categories>
          
          <category> JavaWeb </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>自定义函数</title>
      <link href="/2023/01/08/zi-ding-yi-han-shu/"/>
      <url>/2023/01/08/zi-ding-yi-han-shu/</url>
      
        <content type="html"><![CDATA[<h1 id="自定义函数"><a href="#自定义函数" class="headerlink" title="自定义函数"></a>自定义函数</h1><h3 id="注意：MySQL函数必须有返回值"><a href="#注意：MySQL函数必须有返回值" class="headerlink" title="注意：MySQL函数必须有返回值"></a>注意：MySQL函数必须有返回值</h3><h3 id="需求：传入id，返回id对应的姓名"><a href="#需求：传入id，返回id对应的姓名" class="headerlink" title="需求：传入id，返回id对应的姓名"></a>需求：传入id，返回id对应的姓名</h3><pre><code>delimiter xxCREATE FUNCTION getName(s_id INT(3)) RETURNS VARCHAR(32)    BEGIN        declare s_name VARCHAR(32);#声明函数中的变量        SELECT name INTO s_name FROM student WHERE id=s_id;        RETURN s_name;    END xxdelimiter ;</code></pre><h3 id="调用函数"><a href="#调用函数" class="headerlink" title="调用函数"></a>调用函数</h3><pre><code>SELECT getName(1);</code></pre><h3 id="删除函数"><a href="#删除函数" class="headerlink" title="删除函数"></a>删除函数</h3><pre><code>DROP FUNCTION getName;</code></pre>]]></content>
      
      
      <categories>
          
          <category> 数据库 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>约束</title>
      <link href="/2023/01/08/yue-shu/"/>
      <url>/2023/01/08/yue-shu/</url>
      
        <content type="html"><![CDATA[<h1 id="约束"><a href="#约束" class="headerlink" title="约束"></a>约束</h1><p>含义：约束是一种限制，它通过对表的行或列的数据做出限制，来确保表的数据的完整性、唯一性。</p><h3 id="创建表"><a href="#创建表" class="headerlink" title="创建表"></a>创建表</h3><pre class=" language-mys"><code class="language-mys">CREATE TABLE student(    username VARCHAR(32) PRIMARY KEY,    password VARCHAR(32),    name VARCHAR(32),    sex VARCHAR(32),    age INT(3),    salary FLOAT(8,2),    course VARCHAR(32));INSERT INTO student(username,password,name,sex,age,salary,course) VALUES('hezhouyu','123123','何周钰','女',18,13000,'Java');INSERT INTO student(username,password,name,sex,age,salary,course) VALUES('fanhuicong','123123','范慧聪','女',18,14000,'Java');INSERT INTO student(username,password,name,sex,age,salary,course) VALUES('huangyanqing','123123','黄艳清','女',18,15000,'Java');INSERT INTO student(username,password,name,sex,age,salary,course) VALUES('huachengyu','123123','华晨宇','男',32,8000,'HTML');INSERT INTO student(username,password,name,sex,age,salary,course) VALUES('liudehua','123123','刘德华','男',61,9000,'HTML');INSERT INTO student(username,password,name,sex,age,salary,course) VALUES('zhouhuajian','123123','周华健','男',63,12000,'HTML');INSERT INTO student(username,password,name,sex,age,salary,course) VALUES('ouyangzhenghua','123123','欧阳震华','男',45,10000,'Python');INSERT INTO student(username,password,name,sex,age,salary,course) VALUES('huojianhua','123123','霍建华','男',43,13000,'Python');INSERT INTO student(username,password,name,sex,age,salary,course) VALUES('yuanhua','123123','元华','男',70,13000,'Python');</code></pre><h3 id="主键约束"><a href="#主键约束" class="headerlink" title="主键约束"></a>主键约束</h3><p>含义：唯一约束+非空约束，该字段上的数据不能重复，并且不能为null</p><p>注意：一张表中的主键只能有一个</p><p>创建表时，添加主键约束</p><pre class=" language-mysql"><code class="language-mysql">CREATE TABLE student(    username VARCHAR(32) PRIMARY KEY,    password VARCHAR(32),    name VARCHAR(32),    sex VARCHAR(32),    age INT(3),    salary FLOAT(8,2),    course VARCHAR(32));</code></pre><h3 id="添加联合主键约束"><a href="#添加联合主键约束" class="headerlink" title="添加联合主键约束"></a>添加联合主键约束</h3><pre><code>alter table student add primary key(username,password);</code></pre><h3 id="删除主键约束"><a href="#删除主键约束" class="headerlink" title="删除主键约束"></a>删除主键约束</h3><pre><code>alter table student drop primary key;</code></pre><h3 id="修改主键约束"><a href="#修改主键约束" class="headerlink" title="修改主键约束"></a>修改主键约束</h3><pre><code>alter table student modify username int primary key;</code></pre><h3 id="唯一约束"><a href="#唯一约束" class="headerlink" title="唯一约束"></a>唯一约束</h3><p>含义：该字段上的数据不允许重复，但是可以为null</p><h3 id="添加唯一约束"><a href="#添加唯一约束" class="headerlink" title="添加唯一约束"></a>添加唯一约束</h3><pre><code>alter table student add unique(name);</code></pre><h3 id="修改唯一约束"><a href="#修改唯一约束" class="headerlink" title="修改唯一约束"></a>修改唯一约束</h3><pre><code>alter table student modify name varchar(25) unique;</code></pre><h3 id="删除唯一约束"><a href="#删除唯一约束" class="headerlink" title="删除唯一约束"></a>删除唯一约束</h3><pre><code>alter table student drop index name;</code></pre><h3 id="删除唯一约束-1"><a href="#删除唯一约束-1" class="headerlink" title="删除唯一约束"></a>删除唯一约束</h3><h3 id="非空约束"><a href="#非空约束" class="headerlink" title="非空约束"></a>非空约束</h3><p>含义：该字段上的数据不允许为null</p><h3 id="增加非空约束"><a href="#增加非空约束" class="headerlink" title="增加非空约束"></a>增加非空约束</h3><pre><code>alter table student modify sex varchar(32) not null;</code></pre><h3 id="增加非空约束-添加默认值"><a href="#增加非空约束-添加默认值" class="headerlink" title="增加非空约束 + 添加默认值"></a>增加非空约束 + 添加默认值</h3><pre><code>alter table student modify sex varchar(32) not null default '男';-- 取消非空约束alter table student modify sex varchar(32) null;</code></pre><h3 id="外键约束"><a href="#外键约束" class="headerlink" title="外键约束"></a>外键约束</h3><p>含义：外键约束是保证一个或两个表之间的参照完整性，外键是构建于一个表的两个字段或是两个表的两个字段之间的参照关系</p><h3 id="创建老师表"><a href="#创建老师表" class="headerlink" title="创建老师表"></a>创建老师表</h3><pre><code>CREATE TABLE teacher(    id INT(3) PRIMARY KEY aotu_increment,    name VARCHAR(32),);</code></pre><h3 id="创建学生表"><a href="#创建学生表" class="headerlink" title="创建学生表"></a>创建学生表</h3><pre><code>CREATE TABLE student(    username VARCHAR(32) PRIMARY KEY,    password VARCHAR(32),    name VARCHAR(32),    sex VARCHAR(32),    age INT(3),    salary FLOAT(8,2),    course VARCHAR(32),    t_id INT(3));</code></pre><h3 id="添加外键约束"><a href="#添加外键约束" class="headerlink" title="添加外键约束"></a>添加外键约束</h3><pre><code>alter table student add foreign key(t_id) references teacher(id);</code></pre><h3 id="删除外键约束"><a href="#删除外键约束" class="headerlink" title="删除外键约束"></a>删除外键约束</h3><p>注意：获取表的创建信息 SHOW CREATE TABLE student;找到系统自动生成的外键名</p><pre><code>alter table student drop foreign key student_ibfk_1;</code></pre><h3 id="约束的应用："><a href="#约束的应用：" class="headerlink" title="约束的应用："></a>约束的应用：</h3><p>主键约束：该表中的唯一标识的字段</p><p>唯一约束：不允许重复的字段</p><p>非空约束：不允许为null的字段</p><p>添加默认值：银行中的密码字段-初识密码 – ‘000000’</p><h3 id="外键约束：不用（效率低-–-原因：添加数据时，MySQL还会去外键指向的表中去查询）"><a href="#外键约束：不用（效率低-–-原因：添加数据时，MySQL还会去外键指向的表中去查询）" class="headerlink" title="外键约束：不用（效率低 – 原因：添加数据时，MySQL还会去外键指向的表中去查询）"></a>外键约束：不用（效率低 – 原因：添加数据时，MySQL还会去外键指向的表中去查询）</h3><h3 id="外键约束的优缺点："><a href="#外键约束的优缺点：" class="headerlink" title="外键约束的优缺点："></a>外键约束的优缺点：</h3><p>优点：避免脏数据的出现（但是该优点可以在业务中去避免脏数据的出现）</p><p>缺点：效率低 – 原因：添加数据时，MySQL还会去外键指向的表中去查询</p>]]></content>
      
      
      <categories>
          
          <category> 数据库 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>预定义函数</title>
      <link href="/2023/01/08/yu-ding-yi-han-shu/"/>
      <url>/2023/01/08/yu-ding-yi-han-shu/</url>
      
        <content type="html"><![CDATA[<h1 id="预定义函数"><a href="#预定义函数" class="headerlink" title="预定义函数"></a>预定义函数</h1><h3 id="含义：MySQL自带的函数"><a href="#含义：MySQL自带的函数" class="headerlink" title="含义：MySQL自带的函数"></a>含义：MySQL自带的函数</h3><h3 id="注意：函数必须有返回值，因为函数是和Select一起使用"><a href="#注意：函数必须有返回值，因为函数是和Select一起使用" class="headerlink" title="注意：函数必须有返回值，因为函数是和Select一起使用"></a>注意：函数必须有返回值，因为函数是和Select一起使用</h3><h3 id="数学函数"><a href="#数学函数" class="headerlink" title="数学函数"></a>数学函数</h3><pre><code>SELECT ABS(-100);# 求绝对值SELECT SQRT(9);# 求平方根SELECT MOD(10,3);# 求余数SELECT POW(2,4);# 求次方SELECT RAND();# 求随机值</code></pre><h3 id="字符串函数"><a href="#字符串函数" class="headerlink" title="字符串函数"></a>字符串函数</h3><pre><code>SELECT CONCAT("123","abc","def");# 拼接字符串SELECT SUBSTRING("123abcdef",4,3);# 截取字符串(目标字符串，第几个字符(从1开始)，截取的长度)SELECT LENGTH("123abcdef");# 字符串长度</code></pre><h3 id="日期时间函数"><a href="#日期时间函数" class="headerlink" title="日期时间函数"></a>日期时间函数</h3><pre><code>SELECT NOW();# 获取现在日期时间SELECT YEAR(NOW());SELECT MONTH(NOW());SELECT DAY(NOW());SELECT HOUR(NOW());SELECT MINUTE(NOW());SELECT SECOND(NOW());SELECT DATE_FORMAT(NOW(),"%Y年%m月%d日 %H时%i分%s秒");</code></pre>]]></content>
      
      
      <categories>
          
          <category> 数据库 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>索引</title>
      <link href="/2023/01/08/suo-yin/"/>
      <url>/2023/01/08/suo-yin/</url>
      
        <content type="html"><![CDATA[<h1 id="索引"><a href="#索引" class="headerlink" title="索引"></a>索引</h1><h3 id="理解：一本书的目录"><a href="#理解：一本书的目录" class="headerlink" title="理解：一本书的目录"></a>理解：一本书的目录</h3><h3 id="好处：查询效率快"><a href="#好处：查询效率快" class="headerlink" title="好处：查询效率快"></a>好处：查询效率快</h3><h3 id="主键索引（约束）"><a href="#主键索引（约束）" class="headerlink" title="主键索引（约束）"></a>主键索引（约束）</h3><h3 id="创建表时，添加主键索引"><a href="#创建表时，添加主键索引" class="headerlink" title="创建表时，添加主键索引"></a>创建表时，添加主键索引</h3><pre><code>CREATE TABLE student(    username VARCHAR(32) PRIMARY KEY,    password VARCHAR(32),    name VARCHAR(32),    sex VARCHAR(32),    age INT(3),    salary FLOAT(8,2),    course VARCHAR(32)); </code></pre><h3 id="添加联合主键索引"><a href="#添加联合主键索引" class="headerlink" title="添加联合主键索引"></a>添加联合主键索引</h3><pre><code>alter table student add primary key(username,password);</code></pre><h3 id="删除主键索引"><a href="#删除主键索引" class="headerlink" title="删除主键索引"></a>删除主键索引</h3><pre><code>alter table student drop primary key;</code></pre><h3 id="修改主键索引"><a href="#修改主键索引" class="headerlink" title="修改主键索引"></a>修改主键索引</h3><pre><code>alter table student modify username int primary key;</code></pre><h3 id="唯一索引（约束）"><a href="#唯一索引（约束）" class="headerlink" title="唯一索引（约束）"></a>唯一索引（约束）</h3><h3 id="添加唯一索引"><a href="#添加唯一索引" class="headerlink" title="添加唯一索引"></a>添加唯一索引</h3><pre><code>alter table student add unique(name);</code></pre><h3 id="修改唯一索引"><a href="#修改唯一索引" class="headerlink" title="修改唯一索引"></a>修改唯一索引</h3><pre><code>alter table student modify name varchar(25) unique;</code></pre><h3 id="删除唯一索引"><a href="#删除唯一索引" class="headerlink" title="删除唯一索引"></a>删除唯一索引</h3><pre><code>alter table student drop index name;</code></pre><h3 id="普通索引"><a href="#普通索引" class="headerlink" title="普通索引"></a>普通索引</h3><h3 id="理解：单纯想查询的时候该字段更快，该字段上的数据没有任何的限制"><a href="#理解：单纯想查询的时候该字段更快，该字段上的数据没有任何的限制" class="headerlink" title="理解：单纯想查询的时候该字段更快，该字段上的数据没有任何的限制"></a>理解：单纯想查询的时候该字段更快，该字段上的数据没有任何的限制</h3><h3 id="添加普通索引"><a href="#添加普通索引" class="headerlink" title="添加普通索引"></a>添加普通索引</h3><pre><code>alter table student add index(name);</code></pre><h3 id="删除普通索引"><a href="#删除普通索引" class="headerlink" title="删除普通索引"></a>删除普通索引</h3><pre><code>drop index name on student;</code></pre><h2 id="全文索引-–-没用"><a href="#全文索引-–-没用" class="headerlink" title="全文索引 – 没用"></a>全文索引 – 没用</h2><h3 id="索引怎么用-条件上使用到的字段上有索引"><a href="#索引怎么用-条件上使用到的字段上有索引" class="headerlink" title="索引怎么用(条件上使用到的字段上有索引)"></a>索引怎么用(条件上使用到的字段上有索引)</h3><pre><code>SELECT * FROM student WHERE name="何周钰";</code></pre><h3 id="InnoDB引擎-–-索引的数据结构：B-tree"><a href="#InnoDB引擎-–-索引的数据结构：B-tree" class="headerlink" title="InnoDB引擎 – 索引的数据结构：B+tree"></a>InnoDB引擎 – 索引的数据结构：B+tree</h3><h2 id="索引的优缺点"><a href="#索引的优缺点" class="headerlink" title="索引的优缺点"></a>索引的优缺点</h2><p>优点：查询快</p><p>缺点：添加数据、删除数据时，MySQL不仅仅要改变表中的数据，还是改变索引文件中的数据节点（解决方法：批量添加数据、删除数据之前，先把索引删除，批量处理后再添加索引）</p><p>索引的分类：聚簇索引、非聚簇索引</p><p>聚簇索引（主键索引）：叶子节点存储的是数据行在硬盘的地址</p><p>非聚簇索引（唯一索引、普通索引、全文索引）：叶子节点存储的是主键</p><p>小结：查询条件中最好使用聚簇索引</p><h2 id="索引失效的情况："><a href="#索引失效的情况：" class="headerlink" title="索引失效的情况："></a>索引失效的情况：</h2><h3 id="1-模糊查询"><a href="#1-模糊查询" class="headerlink" title="1.模糊查询"></a>1.模糊查询</h3><h3 id="2-MySQL索引算法（判断是走索引查询更快还是顺序查找更快）"><a href="#2-MySQL索引算法（判断是走索引查询更快还是顺序查找更快）" class="headerlink" title="2.MySQL索引算法（判断是走索引查询更快还是顺序查找更快）"></a>2.MySQL索引算法（判断是走索引查询更快还是顺序查找更快）</h3><h3 id="3-最左匹配原则"><a href="#3-最左匹配原则" class="headerlink" title="3.最左匹配原则"></a>3.最左匹配原则</h3>]]></content>
      
      
      <categories>
          
          <category> 数据库 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>视图</title>
      <link href="/2023/01/08/shi-tu/"/>
      <url>/2023/01/08/shi-tu/</url>
      
        <content type="html"><![CDATA[<h1 id="视图"><a href="#视图" class="headerlink" title="视图"></a>视图</h1><h3 id="含义：虚拟表"><a href="#含义：虚拟表" class="headerlink" title="含义：虚拟表"></a>含义：虚拟表</h3><h3 id="创建学生表"><a href="#创建学生表" class="headerlink" title="创建学生表"></a>创建学生表</h3><pre class=" language-mysql"><code class="language-mysql">CREATE TABLE student(    username VARCHAR(32) PRIMARY KEY,    password VARCHAR(32),    name VARCHAR(32),    sex VARCHAR(32),    age INT(3),    salary FLOAT(8,2),    course VARCHAR(32));</code></pre><h3 id="创建视图"><a href="#创建视图" class="headerlink" title="创建视图"></a>创建视图</h3><h3 id="with-check-option-–-当修改值超过条件时，不允许修改"><a href="#with-check-option-–-当修改值超过条件时，不允许修改" class="headerlink" title="with check option – 当修改值超过条件时，不允许修改"></a>with check option – 当修改值超过条件时，不允许修改</h3><h3 id="or-replace-–-如果已有视图，则替换"><a href="#or-replace-–-如果已有视图，则替换" class="headerlink" title="or replace – 如果已有视图，则替换"></a>or replace – 如果已有视图，则替换</h3><pre class=" language-mysql"><code class="language-mysql">create or replace view view01 as select username,name,age from student where age<40 with check option;</code></pre><h3 id="查询视图"><a href="#查询视图" class="headerlink" title="查询视图"></a>查询视图</h3><pre class=" language-mysql"><code class="language-mysql">SELECT * FROM view01;xxxxxxxxxx&nbsp;SELECT * FROM view01;private int id;</code></pre><h3 id="修改数据"><a href="#修改数据" class="headerlink" title="修改数据"></a>修改数据</h3><pre class=" language-mysql"><code class="language-mysql">UPDATE view01 SET age=30 WHERE name='华晨宇';</code></pre><h3 id="删除视图"><a href="#删除视图" class="headerlink" title="删除视图"></a>删除视图</h3><pre class=" language-mysql"><code class="language-mysql">drop view view01;</code></pre>]]></content>
      
      
      <categories>
          
          <category> 数据库 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>存储过程</title>
      <link href="/2023/01/08/cun-chu-guo-cheng/"/>
      <url>/2023/01/08/cun-chu-guo-cheng/</url>
      
        <content type="html"><![CDATA[<h1 id="存储过程"><a href="#存储过程" class="headerlink" title="存储过程"></a>存储过程</h1><p>理解：存储过程类似于Java中的方法</p><p>注意：存储过程没有返回值，但是有返回参数</p><p>存储过程的参数分类：</p><p>IN    – 传入参数 – 调用存储过程时，将数据传入到存储过程内部</p><p>OUT   – 传出参数 – 调用存储过程时，将存储过程内部的数据返回给调用方（类似于Java方法中的返回值）</p><p>INOUT – 传入传出参数 – 调用存储过程时，既可以传入参数也可以返回参数</p><h3 id="没有参数的存储过程"><a href="#没有参数的存储过程" class="headerlink" title="没有参数的存储过程"></a>没有参数的存储过程</h3><pre><code>delimiter xxCREATE PROCEDURE pro01()    BEGIN        SELECT * FROM student;        SELECT * FROM student WHERE sex='女';    END xxdelimiter ;</code></pre><h3 id="调用存储过程"><a href="#调用存储过程" class="headerlink" title="调用存储过程"></a>调用存储过程</h3><pre><code>CALL pro01();</code></pre><h3 id="需求1：按照指定的id查询出姓名"><a href="#需求1：按照指定的id查询出姓名" class="headerlink" title="需求1：按照指定的id查询出姓名"></a>需求1：按照指定的id查询出姓名</h3><pre><code>delimiter xxCREATE PROCEDURE pro02(IN s_id INT(3))    BEGIN        SELECT name FROM student WHERE id=s_id;    END xxdelimiter ;CALL pro02(1);</code></pre><h3 id="需求2：按照指定的id查询出姓名-并返回"><a href="#需求2：按照指定的id查询出姓名-并返回" class="headerlink" title="需求2：按照指定的id查询出姓名,并返回"></a>需求2：按照指定的id查询出姓名,并返回</h3><pre><code>delimiter xxCREATE PROCEDURE pro03(IN s_id INT(3),OUT s_name VARCHAR(32))    BEGIN        SELECT name INTO s_name FROM student WHERE id=s_id;    END xxdelimiter ;CALL pro03(1,@s_name);SELECT @s_name;</code></pre><h3 id="需求3：按照指定的id查询出年龄-并返回"><a href="#需求3：按照指定的id查询出年龄-并返回" class="headerlink" title="需求3：按照指定的id查询出年龄,并返回"></a>需求3：按照指定的id查询出年龄,并返回</h3><pre><code>delimiter xxCREATE PROCEDURE pro04(INOUT param INT(3))    BEGIN        SELECT age INTO param FROM student WHERE id=param;    END xxdelimiter ;SET @param = 1;CALL pro04(@param);SELECT @param;</code></pre><h3 id="删除存储过程"><a href="#删除存储过程" class="headerlink" title="删除存储过程"></a>删除存储过程</h3><pre><code>DROP PROCEDURE pro01;DROP PROCEDURE pro02;DROP PROCEDURE pro03;DROP PROCEDURE pro04;</code></pre>]]></content>
      
      
      <categories>
          
          <category> 数据库 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>触发器</title>
      <link href="/2023/01/08/hong-fa-qi/"/>
      <url>/2023/01/08/hong-fa-qi/</url>
      
        <content type="html"><![CDATA[<h1 id="触发器"><a href="#触发器" class="headerlink" title="触发器"></a>触发器</h1><h3 id="创建班级表并添加数据"><a href="#创建班级表并添加数据" class="headerlink" title="创建班级表并添加数据"></a>创建班级表并添加数据</h3><pre><code>CREATE TABLE class(    id INT(3) PRIMARY KEY auto_increment,    name VARCHAR(32),    sum INT(3) DEFAULT 0);INSERT INTO class(name) VALUES('Java2213');INSERT INTO class(name) VALUES('Java2214');INSERT INTO class(name) VALUES('Java2215');INSERT INTO class(name) VALUES('HTML2213');INSERT INTO class(name) VALUES('HTML2214');INSERT INTO class(name) VALUES('Python2213');</code></pre><h3 id="创建学科表并添加数据"><a href="#创建学科表并添加数据" class="headerlink" title="创建学科表并添加数据"></a>创建学科表并添加数据</h3><pre><code>CREATE TABLE course(    id INT(3) PRIMARY KEY auto_increment,    name VARCHAR(32),    sum INT(3) DEFAULT 0);INSERT INTO course(name) VALUES('Java');INSERT INTO course(name) VALUES('HTML');INSERT INTO course(name) VALUES('Python');</code></pre><h3 id="创建学生表"><a href="#创建学生表" class="headerlink" title="创建学生表"></a>创建学生表</h3><pre><code>CREATE TABLE student(    id INT(3) PRIMARY KEY auto_increment,    name VARCHAR(32),    class_id INT(3),    course_id INT(3));</code></pre><h3 id="后置触发器：student表中INSERT事件之后更新class表和course表"><a href="#后置触发器：student表中INSERT事件之后更新class表和course表" class="headerlink" title="后置触发器：student表中INSERT事件之后更新class表和course表"></a>后置触发器：student表中INSERT事件之后更新class表和course表</h3><pre><code>delimiter xxcreate trigger tri01 after INSERT on student for each row     BEGIN        UPDATE class SET sum=sum+1 WHERE id=new.class_id;        UPDATE course SET sum=sum+1 WHERE id=new.course_id;    END xxdelimiter ;</code></pre><h3 id="需求：添加学生"><a href="#需求：添加学生" class="headerlink" title="需求：添加学生"></a>需求：添加学生</h3><pre><code>INSERT INTO student(name,class_id,course_id) VALUES('何周钰',1,1);INSERT INTO student(name,class_id,course_id) VALUES('蔡文静',1,1);INSERT INTO student(name,class_id,course_id) VALUES('aaa',5,2);</code></pre><h3 id="前置触发器：student表中DELETE事件之前更新class表和course表"><a href="#前置触发器：student表中DELETE事件之前更新class表和course表" class="headerlink" title="前置触发器：student表中DELETE事件之前更新class表和course表"></a>前置触发器：student表中DELETE事件之前更新class表和course表</h3><pre><code>delimiter xxcreate trigger tri02 BEFORE DELETE on student for each row     BEGIN        UPDATE class SET sum=sum-1 WHERE id=old.class_id;        UPDATE course SET sum=sum-1 WHERE id=old.course_id;    END xxdelimiter ;</code></pre><h3 id="需求：删除学生"><a href="#需求：删除学生" class="headerlink" title="需求：删除学生"></a>需求：删除学生</h3><pre><code>delete from student where id=1;delete from student where id=3;</code></pre><h3 id="删除触发器"><a href="#删除触发器" class="headerlink" title="删除触发器"></a>删除触发器</h3><pre><code>drop TRIGGER tri01;drop TRIGGER tri02;</code></pre>]]></content>
      
      
      <categories>
          
          <category> 数据库 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>DML</title>
      <link href="/2023/01/07/dml/"/>
      <url>/2023/01/07/dml/</url>
      
        <content type="html"><![CDATA[<h1 id="DML"><a href="#DML" class="headerlink" title="DML"></a>DML</h1><h3 id="含义：操作数据行"><a href="#含义：操作数据行" class="headerlink" title="含义：操作数据行"></a>含义：操作数据行</h3><h3 id="建表（DDL）"><a href="#建表（DDL）" class="headerlink" title="建表（DDL）"></a>建表（DDL）</h3><pre><code>PRIMARY KRY - 主键auto_increament - 自动增长(从1开始)CREATE TABLE student(    id INT(3) PRIMARY KEY auto_increment,    name VARCHAR(32),    sex VARCHAR(32),    age INT(3),    salary FLOAT(8,2),    course VARCHAR(32));</code></pre><h3 id="添加数据方式1"><a href="#添加数据方式1" class="headerlink" title="添加数据方式1"></a>添加数据方式1</h3><pre><code>INSERT INTO student VALUES(1,'蔡文静','女',18,12000,'Java');</code></pre><h3 id="添加数据方式2"><a href="#添加数据方式2" class="headerlink" title="添加数据方式2"></a>添加数据方式2</h3><pre><code># DML ### 含义：操作数据行### 建表（DDL）    PRIMARY KRY - 主键    auto_increament - 自动增长(从1开始)    CREATE TABLE student(        id INT(3) PRIMARY KEY auto_increment,        name VARCHAR(32),        sex VARCHAR(32),        age INT(3),        salary FLOAT(8,2),        course VARCHAR(32)    );### 添加数据方式1INSERT INTO student VALUES(1,'蔡文静','女',18,12000,'Java');### 添加数据方式2INSERT INTO student(name,sex,age,salary,course) VALUES('何周钰','女',18,13000,'Java');INSERT INTO student(name,sex,age,salary,course) VALUES('范慧聪','女',18,14000,'Java');INSERT INTO student(name,sex,age,salary,course) VALUES('黄艳清','女',18,15000,'Java');INSERT INTO student(name,sex,age,salary,course) VALUES('华晨宇','男',32,8000,'HTML');INSERT INTO student(name,sex,age,salary,course) VALUES('刘德华','男',61,9000,'HTML');INSERT INTO student(name,sex,age,salary,course) VALUES('周华健','男',63,12000,'HTML');INSERT INTO student(name,sex,age,salary,course) VALUES('欧阳震华','男',45,10000,'Python');INSERT INTO student(name,sex,age,salary,course) VALUES('霍建华','男',43,13000,'Python');INSERT INTO student(name,sex,age,salary,course) VALUES('元华','男',70,13000,'Python');### 查询所有字段SELECT * FROM student;</code></pre><h3 id="查询所有字段"><a href="#查询所有字段" class="headerlink" title="查询所有字段"></a>查询所有字段</h3><pre><code>SELECT * FROM student;</code></pre>]]></content>
      
      
      <categories>
          
          <category> 数据库 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>DDL</title>
      <link href="/2023/01/07/ddl/"/>
      <url>/2023/01/07/ddl/</url>
      
        <content type="html"><![CDATA[<h1 id="SQL-DDL"><a href="#SQL-DDL" class="headerlink" title="SQL - DDL"></a>SQL - DDL</h1><h3 id="含义：操作库、表、字段的语言"><a href="#含义：操作库、表、字段的语言" class="headerlink" title="含义：操作库、表、字段的语言"></a>含义：操作库、表、字段的语言</h3><h3 id="查询所有的数据库"><a href="#查询所有的数据库" class="headerlink" title="查询所有的数据库"></a>查询所有的数据库</h3><p>SHOW DATABASES;</p><h3 id="创建数据库"><a href="#创建数据库" class="headerlink" title="创建数据库"></a>创建数据库</h3><p>CREATE DATABASE 2213javaee;</p><h3 id="删除数据库"><a href="#删除数据库" class="headerlink" title="删除数据库"></a>删除数据库</h3><p>DROP DATABASE 2213javaee;</p><h3 id="使用数据库"><a href="#使用数据库" class="headerlink" title="使用数据库"></a>使用数据库</h3><p>USER 2213javaee;</p><h3 id="查询所有的表名"><a href="#查询所有的表名" class="headerlink" title="查询所有的表名"></a>查询所有的表名</h3><p>SHOW TABLES;</p><h3 id="创建表"><a href="#创建表" class="headerlink" title="创建表"></a>创建表</h3><p>CREATE TABLE s_student(<br>    s_name VARCHAR(32),<br>    s_sex VARCHAR(32),<br>    age INT(3),<br>    salary FLOAT(8,2),<br>    course VARCHAR(32)<br>);</p><h3 id="修改表名"><a href="#修改表名" class="headerlink" title="修改表名"></a>修改表名</h3><p>ALTER TABLE s_student RENAME student;</p><h3 id="删除表"><a href="#删除表" class="headerlink" title="删除表"></a>删除表</h3><p>DROP TABLE student;</p><h3 id="查询表字段"><a href="#查询表字段" class="headerlink" title="查询表字段"></a>查询表字段</h3><p>DESC student;</p><h3 id="获取创建表信息"><a href="#获取创建表信息" class="headerlink" title="获取创建表信息"></a>获取创建表信息</h3><p>CREATE TABLE <code>student</code> (<br>  <code>s_name</code> varchar(32) DEFAULT NULL,<br>  <code>s_sex</code> varchar(32) DEFAULT NULL,<br>  <code>age</code> int(3) DEFAULT NULL,<br>  <code>salary</code> float(8,2) DEFAULT NULL,<br>  <code>course</code> varchar(32) DEFAULT NULL<br>) ENGINE=InnoDB DEFAULT CHARSET=utf8</p><p>DEFAULT NULL - 设置默认值<br>ENGINE=InnoDB - 指定数据库引擎<br>DEFAULT CHARSET=utf8 - 设置编码格式<br>注意：表名和字段名都会用 ``括起来，防止表名和字段名与关键字重复</p><p>SHOW CREATE TABLE student;</p><h3 id="修改字段类型"><a href="#修改字段类型" class="headerlink" title="修改字段类型"></a>修改字段类型</h3><p>ALTER TABLE student MODIFY course VARCHAR(20);</p><h3 id="修改字段名"><a href="#修改字段名" class="headerlink" title="修改字段名"></a>修改字段名</h3><p>ALTER TABLE student CHANGE s_name name VARCHAR(32);</p><h3 id="修改字段名-字段类型"><a href="#修改字段名-字段类型" class="headerlink" title="修改字段名 + 字段类型"></a>修改字段名 + 字段类型</h3><p>ALTER TABLE student CHANGE s_sex sex VARCHAR(8);</p><h3 id="添加字段"><a href="#添加字段" class="headerlink" title="添加字段"></a>添加字段</h3><p>ALTER TABLE student ADD xxx VARCHAR(32);</p><h3 id="删除字段"><a href="#删除字段" class="headerlink" title="删除字段"></a>删除字段</h3><p>ALTER TABLE student DROP xxx;</p>]]></content>
      
      
      <categories>
          
          <category> 数据库 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>ForkJoin并行计算框架</title>
      <link href="/2023/01/07/forkjoin-bing-xing-ji-suan-kuang-jia/"/>
      <url>/2023/01/07/forkjoin-bing-xing-ji-suan-kuang-jia/</url>
      
        <content type="html"><![CDATA[<h1 id="Fork-x2F-Join并行计算框架"><a href="#Fork-x2F-Join并行计算框架" class="headerlink" title="Fork/Join并行计算框架"></a>Fork/Join并行计算框架</h1><h3 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h3><blockquote><p>Fork/Join框架：在必要时将一个大任务进行拆分（fork）成若干个小任务（拆到不可再拆时），再将一个个</p><p>小任务的运行结果进行join合并，一般都是在大数据搜索中使用</p><p>Fork/Join采用“工作窃取” 模式(work-stealing) ：</p><p>当执行新的任务时它可以将其拆分分成更小的任务执行，并将小任务加到线程队列中。在程序执行过程中如果有闲置线程，闲置线程会把其他线程的线程队列末尾的任务偷偷拿到自己的线程中执行，注意线程队列是双关，即队列里最前面的任务会被直接，最后的任务会被闲置线程拿走去执行。这种方式减少了线程的等待时间，提高了性能</p></blockquote><p>![avatar][img1]</p><h3 id="具体使用"><a href="#具体使用" class="headerlink" title="具体使用"></a>具体使用</h3><pre class=" language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Test1</span> <span class="token punctuation">{</span>    <span class="token annotation punctuation">@Test</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test01</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token comment" spellcheck="true">//需求：计算1-10000000L之和</span>                <span class="token comment" spellcheck="true">//创建并发线程池对象</span>        ForkJoinPool pool <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ForkJoinPool</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">//提交任务并得到结果</span>        Long sum <span class="token operator">=</span> pool<span class="token punctuation">.</span><span class="token function">invoke</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ForkJoinCalculateTask</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>10000000L<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>sum<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token comment" spellcheck="true">//计算任务类</span><span class="token comment" spellcheck="true">//class ForkJoinCalculateTask extends RecursiveAction{//无返回值的任务类</span><span class="token keyword">class</span> <span class="token class-name">ForkJoinCalculateTask</span> <span class="token keyword">extends</span> <span class="token class-name">RecursiveTask</span><span class="token operator">&lt;</span>Long<span class="token operator">></span><span class="token punctuation">{</span><span class="token comment" spellcheck="true">//有返回值的任务类</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">long</span> serialVersionUID <span class="token operator">=</span> 1975909145028788652L<span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token keyword">long</span> startNum<span class="token punctuation">;</span><span class="token comment" spellcheck="true">//开始数字</span>    <span class="token keyword">private</span> <span class="token keyword">long</span> endNum<span class="token punctuation">;</span><span class="token comment" spellcheck="true">//结束数字</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">long</span> THRESHOLD <span class="token operator">=</span> <span class="token number">10000</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//临界值，每到10000就分成小任务</span>    <span class="token keyword">public</span> <span class="token function">ForkJoinCalculateTask</span><span class="token punctuation">(</span><span class="token keyword">long</span> startNum<span class="token punctuation">,</span> <span class="token keyword">long</span> endNum<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>startNum <span class="token operator">=</span> startNum<span class="token punctuation">;</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>endNum <span class="token operator">=</span> endNum<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">protected</span> Long <span class="token function">compute</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                <span class="token keyword">long</span> len <span class="token operator">=</span> endNum<span class="token operator">-</span>startNum<span class="token punctuation">;</span>                <span class="token keyword">if</span><span class="token punctuation">(</span>len <span class="token operator">&lt;=</span> THRESHOLD<span class="token punctuation">)</span><span class="token punctuation">{</span>            <span class="token keyword">long</span> sum <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">long</span> i <span class="token operator">=</span> startNum<span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> endNum<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                sum <span class="token operator">+=</span> i<span class="token punctuation">;</span>            <span class="token punctuation">}</span>            <span class="token keyword">return</span> sum<span class="token punctuation">;</span>        <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>                        <span class="token keyword">long</span> mid <span class="token operator">=</span> <span class="token punctuation">(</span>startNum<span class="token operator">+</span>endNum<span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">;</span>                        ForkJoinCalculateTask left <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ForkJoinCalculateTask</span><span class="token punctuation">(</span>startNum<span class="token punctuation">,</span> mid<span class="token punctuation">)</span><span class="token punctuation">;</span>            left<span class="token punctuation">.</span><span class="token function">fork</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//拆分成子任务并压入新队列</span>                        ForkJoinCalculateTask right <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ForkJoinCalculateTask</span><span class="token punctuation">(</span>mid<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span> endNum<span class="token punctuation">)</span><span class="token punctuation">;</span>            right<span class="token punctuation">.</span><span class="token function">fork</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//拆分成子任务并压入新队列</span>                        <span class="token comment" spellcheck="true">//把结果合并返回</span>            <span class="token keyword">return</span> left<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> right<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span></code></pre>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>JDBC封装查询</title>
      <link href="/2023/01/05/jdbc-feng-zhuang-cha-xun/"/>
      <url>/2023/01/05/jdbc-feng-zhuang-cha-xun/</url>
      
        <content type="html"><![CDATA[<h3 id="使用JDBC封装查询语句，只需要传入sql语句和参数即可实现"><a href="#使用JDBC封装查询语句，只需要传入sql语句和参数即可实现" class="headerlink" title="使用JDBC封装查询语句，只需要传入sql语句和参数即可实现"></a>使用JDBC封装查询语句，只需要传入sql语句和参数即可实现</h3><h4 id="首先需要根据数据库的表创建实体类"><a href="#首先需要根据数据库的表创建实体类" class="headerlink" title="首先需要根据数据库的表创建实体类"></a>首先需要根据数据库的表创建实体类</h4><h4 id="Student实体类"><a href="#Student实体类" class="headerlink" title="Student实体类"></a>Student实体类</h4><pre class=" language-java"><code class="language-java"><span class="token annotation punctuation">@NoArgsConstructor</span><span class="token annotation punctuation">@AllArgsConstructor</span><span class="token annotation punctuation">@Data</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Student</span> <span class="token punctuation">{</span>    <span class="token keyword">private</span> <span class="token keyword">int</span> id<span class="token punctuation">;</span>    <span class="token keyword">private</span> String username<span class="token punctuation">;</span>    <span class="token keyword">private</span> String password<span class="token punctuation">;</span>    <span class="token keyword">private</span> String name<span class="token punctuation">;</span>    <span class="token keyword">private</span> String sex<span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token keyword">int</span> age<span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token keyword">float</span> salary<span class="token punctuation">;</span>    <span class="token keyword">private</span> String course<span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><h4 id="DBUtils添加commonQuery-方法和getField-方法"><a href="#DBUtils添加commonQuery-方法和getField-方法" class="headerlink" title="DBUtils添加commonQuery()方法和getField()方法"></a>DBUtils添加commonQuery()方法和getField()方法</h4><pre class=" language-java"><code class="language-java"><span class="token comment" spellcheck="true">/** * * @param clazz 要查询的实体类 * @param sql sql语句 * @param params 参数 * @param &lt;T> 泛型 * @return */</span><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token operator">&lt;</span>T<span class="token operator">></span> List<span class="token operator">&lt;</span>T<span class="token operator">></span> <span class="token function">commonQuery</span><span class="token punctuation">(</span>Class<span class="token operator">&lt;</span>T<span class="token operator">></span> clazz<span class="token punctuation">,</span> String sql<span class="token punctuation">,</span> Object<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> params<span class="token punctuation">)</span> <span class="token punctuation">{</span>    Connection connection<span class="token punctuation">;</span>    PreparedStatement statement<span class="token punctuation">;</span>    ResultSet resultSet<span class="token punctuation">;</span>    <span class="token keyword">try</span> <span class="token punctuation">{</span>        connection <span class="token operator">=</span> <span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        statement <span class="token operator">=</span> connection<span class="token punctuation">.</span><span class="token function">prepareStatement</span><span class="token punctuation">(</span>sql<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">setParams</span><span class="token punctuation">(</span>statement<span class="token punctuation">,</span>params<span class="token punctuation">)</span><span class="token punctuation">;</span>        resultSet <span class="token operator">=</span> statement<span class="token punctuation">.</span><span class="token function">executeQuery</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">//获取表信息对象</span>        ResultSetMetaData metaData <span class="token operator">=</span> statement<span class="token punctuation">.</span><span class="token function">getMetaData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">//获取表对应的字段数</span>        <span class="token keyword">int</span> count <span class="token operator">=</span> metaData<span class="token punctuation">.</span><span class="token function">getColumnCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">//创建一个容器来存储对象信息</span>        ArrayList<span class="token operator">&lt;</span>T<span class="token operator">></span> list <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token operator">&lt;</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">while</span> <span class="token punctuation">(</span>resultSet<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">try</span> <span class="token punctuation">{</span>                <span class="token comment" spellcheck="true">//通过反射创建实体对象</span>                T t <span class="token operator">=</span> clazz<span class="token punctuation">.</span><span class="token function">newInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> count<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                    <span class="token comment" spellcheck="true">//获取到字段名字</span>                    String columnName <span class="token operator">=</span> metaData<span class="token punctuation">.</span><span class="token function">getColumnName</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>                    <span class="token comment" spellcheck="true">//获取到字段名对应的数据</span>                    Object value <span class="token operator">=</span> resultSet<span class="token punctuation">.</span><span class="token function">getObject</span><span class="token punctuation">(</span>columnName<span class="token punctuation">)</span><span class="token punctuation">;</span>                    <span class="token comment" spellcheck="true">//通过反射获取字段名对应的属性对象</span>                    Field field <span class="token operator">=</span> <span class="token function">getField</span><span class="token punctuation">(</span>clazz<span class="token punctuation">,</span> columnName<span class="token punctuation">)</span><span class="token punctuation">;</span>                    <span class="token comment" spellcheck="true">//设置属性值</span>                    <span class="token keyword">if</span> <span class="token punctuation">(</span>field <span class="token operator">!=</span> null<span class="token punctuation">)</span> <span class="token punctuation">{</span>                        field<span class="token punctuation">.</span><span class="token function">setAccessible</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                        field<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>t<span class="token punctuation">,</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>                    <span class="token punctuation">}</span>                <span class="token punctuation">}</span>                <span class="token comment" spellcheck="true">//设置完一个t对象就添加到list中</span>                list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>t<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InstantiationException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>                e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IllegalAccessException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>                e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span>        <span class="token keyword">return</span> list<span class="token punctuation">;</span>    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">SQLException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>        e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">return</span> null<span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><pre class=" language-java"><code class="language-java"><span class="token comment" spellcheck="true">/** *  反射获取本类及其父类的属性对象 * @param clazz 实体类 * @param name 属性名字 * @return 属性对象 */</span><span class="token keyword">public</span> <span class="token keyword">static</span> Field <span class="token function">getField</span><span class="token punctuation">(</span>Class<span class="token operator">&lt;</span><span class="token operator">?</span><span class="token operator">></span> clazz<span class="token punctuation">,</span>String name<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>Class<span class="token operator">&lt;</span><span class="token operator">?</span><span class="token operator">></span> c <span class="token operator">=</span>clazz<span class="token punctuation">;</span> c <span class="token operator">!=</span> null<span class="token punctuation">;</span> c <span class="token operator">=</span> c<span class="token punctuation">.</span><span class="token function">getSuperclass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        Field<span class="token punctuation">[</span><span class="token punctuation">]</span> declaredFields <span class="token operator">=</span> c<span class="token punctuation">.</span><span class="token function">getDeclaredFields</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span>Field declaredField <span class="token operator">:</span> declaredFields<span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>declaredField<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>                <span class="token keyword">return</span> declaredField<span class="token punctuation">;</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token keyword">return</span> null<span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><h4 id="测试类"><a href="#测试类" class="headerlink" title="测试类"></a>测试类</h4><pre class=" language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Test03</span> <span class="token punctuation">{</span>    <span class="token comment" spellcheck="true">/**     * 知识点：封装DBUtil -- List&lt;T> commonQuery(Class&lt;T> clazz,String sql,Object... params) -- 查询     */</span>    <span class="token annotation punctuation">@Test</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testQueryStudents</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token comment" spellcheck="true">//查询学生表 -- List&lt;Student></span>        String sql <span class="token operator">=</span> <span class="token string">"select * from student where sex = ?"</span><span class="token punctuation">;</span>        List<span class="token operator">&lt;</span>Student<span class="token operator">></span> stuList <span class="token operator">=</span> DBUtils<span class="token punctuation">.</span><span class="token function">commonQuery</span><span class="token punctuation">(</span>Student<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> sql<span class="token punctuation">,</span> <span class="token string">"男"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        stuList<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>System<span class="token punctuation">.</span>out<span class="token operator">:</span><span class="token operator">:</span>println<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span></code></pre><h4 id="结果"><a href="#结果" class="headerlink" title="结果"></a>结果</h4><pre class=" language-java"><code class="language-java"><span class="token function">Student</span><span class="token punctuation">(</span>id<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">,</span> username<span class="token operator">=</span>null<span class="token punctuation">,</span> password<span class="token operator">=</span>null<span class="token punctuation">,</span> name<span class="token operator">=</span>华晨宇<span class="token punctuation">,</span> sex<span class="token operator">=</span>男<span class="token punctuation">,</span> age<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">,</span> salary<span class="token operator">=</span><span class="token number">10000.0</span><span class="token punctuation">,</span> course<span class="token operator">=</span>HTML<span class="token punctuation">)</span><span class="token function">Student</span><span class="token punctuation">(</span>id<span class="token operator">=</span><span class="token number">6</span><span class="token punctuation">,</span> username<span class="token operator">=</span>null<span class="token punctuation">,</span> password<span class="token operator">=</span>null<span class="token punctuation">,</span> name<span class="token operator">=</span>刘德华<span class="token punctuation">,</span> sex<span class="token operator">=</span>男<span class="token punctuation">,</span> age<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">,</span> salary<span class="token operator">=</span><span class="token number">10000.0</span><span class="token punctuation">,</span> course<span class="token operator">=</span>HTML<span class="token punctuation">)</span><span class="token function">Student</span><span class="token punctuation">(</span>id<span class="token operator">=</span><span class="token number">7</span><span class="token punctuation">,</span> username<span class="token operator">=</span>null<span class="token punctuation">,</span> password<span class="token operator">=</span>null<span class="token punctuation">,</span> name<span class="token operator">=</span>周华健<span class="token punctuation">,</span> sex<span class="token operator">=</span>男<span class="token punctuation">,</span> age<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">,</span> salary<span class="token operator">=</span><span class="token number">10000.0</span><span class="token punctuation">,</span> course<span class="token operator">=</span>HTML<span class="token punctuation">)</span><span class="token function">Student</span><span class="token punctuation">(</span>id<span class="token operator">=</span><span class="token number">8</span><span class="token punctuation">,</span> username<span class="token operator">=</span>null<span class="token punctuation">,</span> password<span class="token operator">=</span>null<span class="token punctuation">,</span> name<span class="token operator">=</span>欧阳震华<span class="token punctuation">,</span> sex<span class="token operator">=</span>男<span class="token punctuation">,</span> age<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">,</span> salary<span class="token operator">=</span><span class="token number">10000.0</span><span class="token punctuation">,</span> course<span class="token operator">=</span>Python<span class="token punctuation">)</span><span class="token function">Student</span><span class="token punctuation">(</span>id<span class="token operator">=</span><span class="token number">9</span><span class="token punctuation">,</span> username<span class="token operator">=</span>null<span class="token punctuation">,</span> password<span class="token operator">=</span>null<span class="token punctuation">,</span> name<span class="token operator">=</span>霍建华<span class="token punctuation">,</span> sex<span class="token operator">=</span>男<span class="token punctuation">,</span> age<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">,</span> salary<span class="token operator">=</span><span class="token number">10000.0</span><span class="token punctuation">,</span> course<span class="token operator">=</span>Python<span class="token punctuation">)</span><span class="token function">Student</span><span class="token punctuation">(</span>id<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">,</span> username<span class="token operator">=</span>null<span class="token punctuation">,</span> password<span class="token operator">=</span>null<span class="token punctuation">,</span> name<span class="token operator">=</span>元华<span class="token punctuation">,</span> sex<span class="token operator">=</span>男<span class="token punctuation">,</span> age<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">,</span> salary<span class="token operator">=</span><span class="token number">10000.0</span><span class="token punctuation">,</span> course<span class="token operator">=</span>Python<span class="token punctuation">)</span><span class="token function">Student</span><span class="token punctuation">(</span>id<span class="token operator">=</span><span class="token number">10117</span><span class="token punctuation">,</span> username<span class="token operator">=</span>xuyujiao<span class="token punctuation">,</span> password<span class="token operator">=</span><span class="token number">123321</span><span class="token punctuation">,</span> name<span class="token operator">=</span>徐雨蛟<span class="token punctuation">,</span> sex<span class="token operator">=</span>男<span class="token punctuation">,</span> age<span class="token operator">=</span><span class="token number">19</span><span class="token punctuation">,</span> salary<span class="token operator">=</span><span class="token number">21000.0</span><span class="token punctuation">,</span> course<span class="token operator">=</span>Java<span class="token punctuation">)</span><span class="token function">Student</span><span class="token punctuation">(</span>id<span class="token operator">=</span><span class="token number">10118</span><span class="token punctuation">,</span> username<span class="token operator">=</span>xuyujiao<span class="token punctuation">,</span> password<span class="token operator">=</span><span class="token number">123321</span><span class="token punctuation">,</span> name<span class="token operator">=</span>徐雨蛟<span class="token punctuation">,</span> sex<span class="token operator">=</span>男<span class="token punctuation">,</span> age<span class="token operator">=</span><span class="token number">19</span><span class="token punctuation">,</span> salary<span class="token operator">=</span><span class="token number">21000.0</span><span class="token punctuation">,</span> course<span class="token operator">=</span>Java<span class="token punctuation">)</span></code></pre>]]></content>
      
      
      <categories>
          
          <category> JDBC </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>JDBC封装增删改</title>
      <link href="/2023/01/05/jdbc-feng-zhuang-zeng-shan-gai/"/>
      <url>/2023/01/05/jdbc-feng-zhuang-zeng-shan-gai/</url>
      
        <content type="html"><![CDATA[<h3 id="使用JDBC封装增删查的方法，只需要传入sql语句和各种参数即可实现"><a href="#使用JDBC封装增删查的方法，只需要传入sql语句和各种参数即可实现" class="headerlink" title="使用JDBC封装增删查的方法，只需要传入sql语句和各种参数即可实现"></a>使用JDBC封装增删查的方法，只需要传入sql语句和各种参数即可实现</h3><h4 id="DBUtils工具类添加commonUpdate-方法和setParams-方法"><a href="#DBUtils工具类添加commonUpdate-方法和setParams-方法" class="headerlink" title="DBUtils工具类添加commonUpdate()方法和setParams()方法"></a>DBUtils工具类添加commonUpdate()方法和setParams()方法</h4><pre class=" language-java"><code class="language-java"><span class="token comment" spellcheck="true">/** * 公共更新的方法 * @param sql sql语句 * @param params 参数 * @return 影响行数 */</span><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">int</span> <span class="token function">commonUpdate</span><span class="token punctuation">(</span>String sql<span class="token punctuation">,</span> Object<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> params<span class="token punctuation">)</span> <span class="token punctuation">{</span>    Connection connection <span class="token operator">=</span> null<span class="token punctuation">;</span>    PreparedStatement statement <span class="token operator">=</span> null<span class="token punctuation">;</span>    <span class="token keyword">try</span> <span class="token punctuation">{</span>        connection <span class="token operator">=</span> <span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        statement <span class="token operator">=</span> connection<span class="token punctuation">.</span><span class="token function">prepareStatement</span><span class="token punctuation">(</span>sql<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">//调用setParams设置?的值</span>        <span class="token function">setParams</span><span class="token punctuation">(</span>statement<span class="token punctuation">,</span>params<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> num <span class="token operator">=</span> statement<span class="token punctuation">.</span><span class="token function">executeUpdate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> num<span class="token punctuation">;</span>    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">SQLException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>        e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token keyword">finally</span> <span class="token punctuation">{</span>        <span class="token function">closeAll</span><span class="token punctuation">(</span>null<span class="token punctuation">,</span>statement<span class="token punctuation">,</span>connection<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token comment" spellcheck="true">/** * 设置参数的值 * @param statement PreparedStatement对象 * @param params 参数 */</span><span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">setParams</span><span class="token punctuation">(</span>PreparedStatement statement<span class="token punctuation">,</span>Object<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> params<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> params<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">try</span> <span class="token punctuation">{</span>            statement<span class="token punctuation">.</span><span class="token function">setObject</span><span class="token punctuation">(</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span>params<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">SQLException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span></code></pre><h4 id="测试类"><a href="#测试类" class="headerlink" title="测试类"></a>测试类</h4><pre class=" language-java"><code class="language-java"><span class="token keyword">import</span> org<span class="token punctuation">.</span>junit<span class="token punctuation">.</span>Test<span class="token punctuation">;</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Test01</span> <span class="token punctuation">{</span>    <span class="token comment" spellcheck="true">/**     * 知识点：封装DBUtil -- commonUpdate(String sql,Object... params) -- 添加、删除、修改     */</span>    <span class="token comment" spellcheck="true">//添加</span>    <span class="token annotation punctuation">@Test</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testAdd</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        String sql <span class="token operator">=</span> <span class="token string">"insert into student(username,password,name,sex,age,salary,course) values(?,?,?,?,?,?,?)"</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> num <span class="token operator">=</span> DBUtils<span class="token punctuation">.</span><span class="token function">commonUpdate</span><span class="token punctuation">(</span>sql<span class="token punctuation">,</span> <span class="token string">"zhangsan"</span><span class="token punctuation">,</span> <span class="token string">"123321"</span><span class="token punctuation">,</span> <span class="token string">"张三"</span><span class="token punctuation">,</span> <span class="token string">"男"</span><span class="token punctuation">,</span> <span class="token number">19</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">,</span> <span class="token string">"Java"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true">//删除</span>    <span class="token annotation punctuation">@Test</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testDelete</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        String sql <span class="token operator">=</span> <span class="token string">"delete from student where id > ?"</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> num <span class="token operator">=</span> DBUtils<span class="token punctuation">.</span><span class="token function">commonUpdate</span><span class="token punctuation">(</span>sql<span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true">//修改</span>    <span class="token annotation punctuation">@Test</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testUpdate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        String sql <span class="token operator">=</span> <span class="token string">"update student set age = ?, salary = ?"</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> num <span class="token operator">=</span> DBUtils<span class="token punctuation">.</span><span class="token function">commonUpdate</span><span class="token punctuation">(</span>sql<span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">10000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span></code></pre><h4 id="主键回填：增加信息的时候传入sql语句和参数返回该字段的主键，因为主键在数据库自增，在一定场景下需要获取到这个主键"><a href="#主键回填：增加信息的时候传入sql语句和参数返回该字段的主键，因为主键在数据库自增，在一定场景下需要获取到这个主键" class="headerlink" title="主键回填：增加信息的时候传入sql语句和参数返回该字段的主键，因为主键在数据库自增，在一定场景下需要获取到这个主键"></a>主键回填：增加信息的时候传入sql语句和参数返回该字段的主键，因为主键在数据库自增，在一定场景下需要获取到这个主键</h4><h4 id="DBUtils工具类里添加commonInset-方法"><a href="#DBUtils工具类里添加commonInset-方法" class="headerlink" title="DBUtils工具类里添加commonInset()方法"></a>DBUtils工具类里添加commonInset()方法</h4><pre class=" language-java"><code class="language-java"><span class="token comment" spellcheck="true">/** * 添加数据(主键回填) * @param sql SQL指令 * @param params 参数的可变参数 * @return 返回主键 */</span><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">int</span> <span class="token function">commonInsert</span><span class="token punctuation">(</span>String sql<span class="token punctuation">,</span>Object<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> params<span class="token punctuation">)</span> <span class="token punctuation">{</span>    Connection connection <span class="token operator">=</span> null<span class="token punctuation">;</span>    PreparedStatement statement <span class="token operator">=</span> null<span class="token punctuation">;</span>    ResultSet resultSet <span class="token operator">=</span> null<span class="token punctuation">;</span>    <span class="token keyword">try</span> <span class="token punctuation">{</span>        connection <span class="token operator">=</span> <span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        statement <span class="token operator">=</span> connection<span class="token punctuation">.</span><span class="token function">prepareStatement</span><span class="token punctuation">(</span>sql<span class="token punctuation">,</span>PreparedStatement<span class="token punctuation">.</span>RETURN_GENERATED_KEYS<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">setParams</span><span class="token punctuation">(</span>statement<span class="token punctuation">,</span>params<span class="token punctuation">)</span><span class="token punctuation">;</span>        statement<span class="token punctuation">.</span><span class="token function">executeUpdate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        resultSet <span class="token operator">=</span> statement<span class="token punctuation">.</span><span class="token function">getGeneratedKeys</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//返回一个主键列</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>resultSet<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">return</span> resultSet<span class="token punctuation">.</span><span class="token function">getInt</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">SQLException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>        e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token keyword">finally</span> <span class="token punctuation">{</span>        <span class="token function">closeAll</span><span class="token punctuation">(</span>resultSet<span class="token punctuation">,</span>statement<span class="token punctuation">,</span>connection<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><h4 id="测试类-1"><a href="#测试类-1" class="headerlink" title="测试类"></a>测试类</h4><pre class=" language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Test02</span> <span class="token punctuation">{</span>    <span class="token comment" spellcheck="true">/**     * 知识点：封装DBUtil -- commonUpdate(String sql,Object... params) -- 主键回填     */</span>    <span class="token annotation punctuation">@Test</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testAdd</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token comment" spellcheck="true">//添加数据</span>        String sql <span class="token operator">=</span> <span class="token string">"insert into student(username,password,name,sex,age,salary,course) values(?,?,?,?,?,?,?)"</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> primaryKey <span class="token operator">=</span> DBUtils<span class="token punctuation">.</span><span class="token function">commonInsert</span><span class="token punctuation">(</span>sql<span class="token punctuation">,</span> <span class="token string">"zhangsan"</span><span class="token punctuation">,</span> <span class="token string">"123321"</span><span class="token punctuation">,</span> <span class="token string">"张三"</span><span class="token punctuation">,</span> <span class="token string">"男"</span><span class="token punctuation">,</span> <span class="token number">19</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">,</span> <span class="token string">"Java"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>primaryKey<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span></code></pre>]]></content>
      
      
      <categories>
          
          <category> JDBC </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>深入JDBC事务2</title>
      <link href="/2023/01/04/shen-ru-jdbc-shi-wu-2/"/>
      <url>/2023/01/04/shen-ru-jdbc-shi-wu-2/</url>
      
        <content type="html"><![CDATA[<h2 id="深入JDBC事务2"><a href="#深入JDBC事务2" class="headerlink" title="深入JDBC事务2"></a>深入JDBC事务2</h2><h4 id="多线程同时操作的解决办法：把全局静态变量变成ThreadLocal对象，因为ThreadLocal存储类型是map，key是线程对象，value存得Connection对象，所以可以创建多个Connection对象来使用。"><a href="#多线程同时操作的解决办法：把全局静态变量变成ThreadLocal对象，因为ThreadLocal存储类型是map，key是线程对象，value存得Connection对象，所以可以创建多个Connection对象来使用。" class="headerlink" title="多线程同时操作的解决办法：把全局静态变量变成ThreadLocal对象，因为ThreadLocal存储类型是map，key是线程对象，value存得Connection对象，所以可以创建多个Connection对象来使用。"></a>多线程同时操作的解决办法：把全局静态变量变成ThreadLocal对象，因为ThreadLocal存储类型是map，key是线程对象，value存得Connection对象，所以可以创建多个Connection对象来使用。</h4><h4 id="具体实现细节与深入JDBC事务1大同小异"><a href="#具体实现细节与深入JDBC事务1大同小异" class="headerlink" title="具体实现细节与深入JDBC事务1大同小异"></a>具体实现细节与深入JDBC事务1大同小异</h4><h4 id="工具类DBUitls2"><a href="#工具类DBUitls2" class="headerlink" title="工具类DBUitls2"></a>工具类DBUitls2</h4><pre class=" language-java"><code class="language-java"><span class="token keyword">package</span> com<span class="token punctuation">.</span>qf<span class="token punctuation">.</span>utils<span class="token punctuation">;</span><span class="token keyword">import</span> java<span class="token punctuation">.</span>io<span class="token punctuation">.</span>IOException<span class="token punctuation">;</span><span class="token keyword">import</span> java<span class="token punctuation">.</span>io<span class="token punctuation">.</span>InputStream<span class="token punctuation">;</span><span class="token keyword">import</span> java<span class="token punctuation">.</span>sql<span class="token punctuation">.</span>*<span class="token punctuation">;</span><span class="token keyword">import</span> java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>Properties<span class="token punctuation">;</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DBUtils2</span> <span class="token punctuation">{</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> String driverName<span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> String url<span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> String username<span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> String password<span class="token punctuation">;</span>    <span class="token keyword">static</span> <span class="token punctuation">{</span>        InputStream inputStream <span class="token operator">=</span> DBUtils<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">.</span><span class="token function">getClassLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getResourceAsStream</span><span class="token punctuation">(</span><span class="token string">"dbconfig.properties"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        Properties p <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Properties</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">try</span> <span class="token punctuation">{</span>            p<span class="token punctuation">.</span><span class="token function">load</span><span class="token punctuation">(</span>inputStream<span class="token punctuation">)</span><span class="token punctuation">;</span>            driverName <span class="token operator">=</span> p<span class="token punctuation">.</span><span class="token function">getProperty</span><span class="token punctuation">(</span><span class="token string">"driverName"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            url <span class="token operator">=</span> p<span class="token punctuation">.</span><span class="token function">getProperty</span><span class="token punctuation">(</span><span class="token string">"url"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            username <span class="token operator">=</span> p<span class="token punctuation">.</span><span class="token function">getProperty</span><span class="token punctuation">(</span><span class="token string">"username"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            password <span class="token operator">=</span> p<span class="token punctuation">.</span><span class="token function">getProperty</span><span class="token punctuation">(</span><span class="token string">"password"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            Class<span class="token punctuation">.</span><span class="token function">forName</span><span class="token punctuation">(</span>driverName<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> <span class="token operator">|</span> ClassNotFoundException e<span class="token punctuation">)</span> <span class="token punctuation">{</span>            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> ThreadLocal<span class="token operator">&lt;</span>Connection<span class="token operator">></span> local <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ThreadLocal</span><span class="token operator">&lt;</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">/**     * 开启事务     * @throws SQLException     */</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">startTransaction</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> SQLException <span class="token punctuation">{</span>        Connection connection <span class="token operator">=</span> <span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        connection<span class="token punctuation">.</span><span class="token function">setAutoCommit</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true">/**     *  提交事务     * @throws SQLException     */</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">commit</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> SQLException <span class="token punctuation">{</span>        Connection connection <span class="token operator">=</span> local<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>connection <span class="token operator">!=</span> null<span class="token punctuation">)</span><span class="token punctuation">{</span>            connection<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            local<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>null<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">rollBack</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> SQLException <span class="token punctuation">{</span>        Connection connection <span class="token operator">=</span> local<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>connection <span class="token operator">!=</span> null<span class="token punctuation">)</span><span class="token punctuation">{</span>            connection<span class="token punctuation">.</span><span class="token function">rollback</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            local<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>null<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true">/**     * 获取连接对象     * @return 连接对象     */</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> Connection <span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> SQLException <span class="token punctuation">{</span>        Connection connection <span class="token operator">=</span> local<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>connection <span class="token operator">==</span> null<span class="token punctuation">)</span><span class="token punctuation">{</span>            connection <span class="token operator">=</span> DriverManager<span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span>username<span class="token punctuation">,</span>password<span class="token punctuation">)</span><span class="token punctuation">;</span>            local<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>connection<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token keyword">return</span> connection<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true">/**     * 关闭资源     * @param rs 需要关闭的结果集     * @param stmt 需要关闭的statement对象     * @param connection 需要关闭的连接对象     */</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">closeAll</span><span class="token punctuation">(</span>ResultSet rs<span class="token punctuation">,</span>Statement stmt<span class="token punctuation">,</span>Connection connection<span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>rs <span class="token operator">!=</span> null<span class="token punctuation">)</span><span class="token punctuation">{</span>            <span class="token keyword">try</span> <span class="token punctuation">{</span>                rs<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">SQLException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>                e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>stmt <span class="token operator">!=</span> null<span class="token punctuation">)</span><span class="token punctuation">{</span>            <span class="token keyword">try</span> <span class="token punctuation">{</span>                stmt<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">SQLException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>                e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>connection <span class="token operator">!=</span> null<span class="token punctuation">)</span><span class="token punctuation">{</span>            <span class="token keyword">try</span> <span class="token punctuation">{</span>                <span class="token comment" spellcheck="true">//判断连接对象是否开启自动提交</span>                <span class="token keyword">if</span> <span class="token punctuation">(</span>connection<span class="token punctuation">.</span><span class="token function">getAutoCommit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>                    connection<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                    local<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>null<span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token punctuation">}</span>            <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">SQLException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>                e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span></code></pre><h4 id="Test02类："><a href="#Test02类：" class="headerlink" title="Test02类："></a>Test02类：</h4><pre class=" language-java"><code class="language-java"><span class="token keyword">package</span> com<span class="token punctuation">.</span>qf<span class="token punctuation">.</span>jdbc02<span class="token punctuation">;</span><span class="token keyword">import</span> com<span class="token punctuation">.</span>qf<span class="token punctuation">.</span>utils<span class="token punctuation">.</span>DBUtils2<span class="token punctuation">;</span><span class="token keyword">import</span> java<span class="token punctuation">.</span>sql<span class="token punctuation">.</span>Connection<span class="token punctuation">;</span><span class="token keyword">import</span> java<span class="token punctuation">.</span>sql<span class="token punctuation">.</span>PreparedStatement<span class="token punctuation">;</span><span class="token keyword">import</span> java<span class="token punctuation">.</span>sql<span class="token punctuation">.</span>SQLException<span class="token punctuation">;</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Test02</span> <span class="token punctuation">{</span>    <span class="token comment" spellcheck="true">/**     * 知识点：深入JDBC中事务2     *     * 需求：模拟银行转账     *     * 分析：     *      单独调用存钱、取钱 -- 两个Connection对象     *      转账 -- 一个Connection对象（因为我们需要将两个SQL命令放在同一个事务中，并提交）     * 解决多线程下同时转账的功能     */</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token comment" spellcheck="true">//转账</span>        <span class="token keyword">try</span> <span class="token punctuation">{</span>            DBUtils2<span class="token punctuation">.</span><span class="token function">startTransaction</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token function">save</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//            System.out.println(1/0);</span>            <span class="token function">get</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            DBUtils2<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">SQLException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token comment" spellcheck="true">//            try {</span><span class="token comment" spellcheck="true">//                DBUtils2.rollBack();</span><span class="token comment" spellcheck="true">//            } catch (SQLException ex) {</span><span class="token comment" spellcheck="true">//                ex.printStackTrace();</span><span class="token comment" spellcheck="true">//            }</span>            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token comment" spellcheck="true">//单独存钱取钱</span><span class="token comment" spellcheck="true">//        try {</span><span class="token comment" spellcheck="true">//            save(1,200);</span><span class="token comment" spellcheck="true">//        } catch (SQLException e) {</span><span class="token comment" spellcheck="true">//            e.printStackTrace();</span><span class="token comment" spellcheck="true">//        }</span><span class="token comment" spellcheck="true">//        try {</span><span class="token comment" spellcheck="true">//            get(2,200);</span><span class="token comment" spellcheck="true">//        } catch (SQLException e) {</span><span class="token comment" spellcheck="true">//            e.printStackTrace();</span><span class="token comment" spellcheck="true">//        }</span>    <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true">/**     * 存钱     * @param id 用户在bank表的id字段     * @param money 存入的金额     * @throws SQLException     */</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">save</span><span class="token punctuation">(</span><span class="token keyword">int</span> id<span class="token punctuation">,</span><span class="token keyword">float</span> money<span class="token punctuation">)</span> <span class="token keyword">throws</span> SQLException <span class="token punctuation">{</span>        Connection connection <span class="token operator">=</span> null<span class="token punctuation">;</span>        PreparedStatement statement <span class="token operator">=</span> null<span class="token punctuation">;</span>        <span class="token keyword">try</span> <span class="token punctuation">{</span>            connection <span class="token operator">=</span> DBUtils2<span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>connection<span class="token punctuation">)</span><span class="token punctuation">;</span>            String sql <span class="token operator">=</span> <span class="token string">"update bank set money=money+? where id=?"</span><span class="token punctuation">;</span>            statement <span class="token operator">=</span> connection<span class="token punctuation">.</span><span class="token function">prepareStatement</span><span class="token punctuation">(</span>sql<span class="token punctuation">)</span><span class="token punctuation">;</span>            statement<span class="token punctuation">.</span><span class="token function">setFloat</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>money<span class="token punctuation">)</span><span class="token punctuation">;</span>            statement<span class="token punctuation">.</span><span class="token function">setInt</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>            statement<span class="token punctuation">.</span><span class="token function">executeUpdate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{</span>            DBUtils2<span class="token punctuation">.</span><span class="token function">closeAll</span><span class="token punctuation">(</span>null<span class="token punctuation">,</span>statement<span class="token punctuation">,</span>connection<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true">/**     * 取钱     * @param id 用户在bank表的id字段     * @param money 存入的金额     * @throws SQLException     */</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">get</span><span class="token punctuation">(</span><span class="token keyword">int</span> id<span class="token punctuation">,</span><span class="token keyword">float</span> money<span class="token punctuation">)</span> <span class="token keyword">throws</span> SQLException <span class="token punctuation">{</span>        Connection connection <span class="token operator">=</span> null<span class="token punctuation">;</span>        PreparedStatement statement <span class="token operator">=</span> null<span class="token punctuation">;</span>        <span class="token keyword">try</span><span class="token punctuation">{</span>            connection <span class="token operator">=</span> DBUtils2<span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>connection<span class="token punctuation">)</span><span class="token punctuation">;</span>            String sql <span class="token operator">=</span> <span class="token string">"update bank set money = money-? where id = ?"</span><span class="token punctuation">;</span>            statement <span class="token operator">=</span> connection<span class="token punctuation">.</span><span class="token function">prepareStatement</span><span class="token punctuation">(</span>sql<span class="token punctuation">)</span><span class="token punctuation">;</span>            statement<span class="token punctuation">.</span><span class="token function">setFloat</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>money<span class="token punctuation">)</span><span class="token punctuation">;</span>            statement<span class="token punctuation">.</span><span class="token function">setInt</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>            statement<span class="token punctuation">.</span><span class="token function">executeUpdate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span><span class="token keyword">finally</span> <span class="token punctuation">{</span>            DBUtils2<span class="token punctuation">.</span><span class="token function">closeAll</span><span class="token punctuation">(</span>null<span class="token punctuation">,</span>statement<span class="token punctuation">,</span>connection<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span></code></pre>]]></content>
      
      
      <categories>
          
          <category> JDBC </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>深入JDBC事务1</title>
      <link href="/2023/01/04/shen-ru-jdbc-shi-wu-1/"/>
      <url>/2023/01/04/shen-ru-jdbc-shi-wu-1/</url>
      
        <content type="html"><![CDATA[<h1 id="深入JDBC中事务"><a href="#深入JDBC中事务" class="headerlink" title="深入JDBC中事务"></a>深入JDBC中事务</h1><ul><li><h4 id="需求：模拟银行转账"><a href="#需求：模拟银行转账" class="headerlink" title="需求：模拟银行转账"></a>需求：模拟银行转账</h4></li><li><h4 id="分析："><a href="#分析：" class="headerlink" title="分析："></a>分析：</h4><ul><li><h4 id="单独调用存钱、取钱-–-两个Connection对象"><a href="#单独调用存钱、取钱-–-两个Connection对象" class="headerlink" title="单独调用存钱、取钱 – 两个Connection对象"></a>单独调用存钱、取钱 – 两个Connection对象</h4></li><li><h4 id="转账-–-一个Connection对象（因为我们需要将两个SQL命令放在同一个事务中，并提交）"><a href="#转账-–-一个Connection对象（因为我们需要将两个SQL命令放在同一个事务中，并提交）" class="headerlink" title="转账 – 一个Connection对象（因为我们需要将两个SQL命令放在同一个事务中，并提交）"></a>转账 – 一个Connection对象（因为我们需要将两个SQL命令放在同一个事务中，并提交）</h4></li></ul></li></ul><h4 id=""><a href="#" class="headerlink" title=""></a></h4><h4 id="普通存钱取钱只需要分别调用save-和get-就行，创建两个connection对象，分别执行SQL语句，并关闭流"><a href="#普通存钱取钱只需要分别调用save-和get-就行，创建两个connection对象，分别执行SQL语句，并关闭流" class="headerlink" title="普通存钱取钱只需要分别调用save() 和get()就行，创建两个connection对象，分别执行SQL语句，并关闭流"></a>普通存钱取钱只需要分别调用save() 和get()就行，创建两个connection对象，分别执行SQL语句，并关闭流</h4><h4 id="存钱取钱方法"><a href="#存钱取钱方法" class="headerlink" title="存钱取钱方法"></a>存钱取钱方法</h4><pre class=" language-java"><code class="language-java"><span class="token comment" spellcheck="true">/** * 存钱 * @param id 用户在bank表的id字段 * @param money 存入的金额 * @throws SQLException */</span><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">save</span><span class="token punctuation">(</span><span class="token keyword">int</span> id<span class="token punctuation">,</span><span class="token keyword">float</span> money<span class="token punctuation">)</span> <span class="token keyword">throws</span> SQLException <span class="token punctuation">{</span>    Connection connection <span class="token operator">=</span> null<span class="token punctuation">;</span>    PreparedStatement statement <span class="token operator">=</span> null<span class="token punctuation">;</span>    <span class="token keyword">try</span> <span class="token punctuation">{</span>        connection <span class="token operator">=</span> DBUtils<span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>connection<span class="token punctuation">)</span><span class="token punctuation">;</span>        String sql <span class="token operator">=</span> <span class="token string">"update bank set money=money+? where id=?"</span><span class="token punctuation">;</span>        statement <span class="token operator">=</span> connection<span class="token punctuation">.</span><span class="token function">prepareStatement</span><span class="token punctuation">(</span>sql<span class="token punctuation">)</span><span class="token punctuation">;</span>        statement<span class="token punctuation">.</span><span class="token function">setFloat</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>money<span class="token punctuation">)</span><span class="token punctuation">;</span>        statement<span class="token punctuation">.</span><span class="token function">setInt</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>        statement<span class="token punctuation">.</span><span class="token function">executeUpdate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{</span>        DBUtils<span class="token punctuation">.</span><span class="token function">closeAll</span><span class="token punctuation">(</span>null<span class="token punctuation">,</span>statement<span class="token punctuation">,</span>connection<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token comment" spellcheck="true">/** * 取钱 * @param id 用户在bank表的id字段 * @param money 存入的金额 * @throws SQLException */</span><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">get</span><span class="token punctuation">(</span><span class="token keyword">int</span> id<span class="token punctuation">,</span><span class="token keyword">float</span> money<span class="token punctuation">)</span> <span class="token keyword">throws</span> SQLException <span class="token punctuation">{</span>    Connection connection <span class="token operator">=</span> null<span class="token punctuation">;</span>    PreparedStatement statement <span class="token operator">=</span> null<span class="token punctuation">;</span>    <span class="token keyword">try</span><span class="token punctuation">{</span>        connection <span class="token operator">=</span> DBUtils<span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>connection<span class="token punctuation">)</span><span class="token punctuation">;</span>        String sql <span class="token operator">=</span> <span class="token string">"update bank set money = money-? where id = ?"</span><span class="token punctuation">;</span>        statement <span class="token operator">=</span> connection<span class="token punctuation">.</span><span class="token function">prepareStatement</span><span class="token punctuation">(</span>sql<span class="token punctuation">)</span><span class="token punctuation">;</span>        statement<span class="token punctuation">.</span><span class="token function">setFloat</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>money<span class="token punctuation">)</span><span class="token punctuation">;</span>        statement<span class="token punctuation">.</span><span class="token function">setInt</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>        statement<span class="token punctuation">.</span><span class="token function">executeUpdate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token keyword">finally</span> <span class="token punctuation">{</span>        DBUtils<span class="token punctuation">.</span><span class="token function">closeAll</span><span class="token punctuation">(</span>null<span class="token punctuation">,</span>statement<span class="token punctuation">,</span>connection<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span></code></pre><h4 id="单独存取"><a href="#单独存取" class="headerlink" title="单独存取"></a>单独存取</h4><pre class=" language-java"><code class="language-java"><span class="token comment" spellcheck="true">//单独存钱取钱</span><span class="token keyword">try</span> <span class="token punctuation">{</span>    <span class="token function">save</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">SQLException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>    e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">try</span> <span class="token punctuation">{</span>    <span class="token function">get</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">SQLException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>    e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><h4 id="JDBC连接工具类1"><a href="#JDBC连接工具类1" class="headerlink" title="JDBC连接工具类1"></a>JDBC连接工具类1</h4><pre class=" language-java"><code class="language-java"><span class="token keyword">package</span> com<span class="token punctuation">.</span>qf<span class="token punctuation">.</span>jdbc02<span class="token punctuation">;</span><span class="token keyword">import</span> java<span class="token punctuation">.</span>io<span class="token punctuation">.</span>IOException<span class="token punctuation">;</span><span class="token keyword">import</span> java<span class="token punctuation">.</span>io<span class="token punctuation">.</span>InputStream<span class="token punctuation">;</span><span class="token keyword">import</span> java<span class="token punctuation">.</span>sql<span class="token punctuation">.</span>*<span class="token punctuation">;</span><span class="token keyword">import</span> java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>Properties<span class="token punctuation">;</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DBUtils</span> <span class="token punctuation">{</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> String driverName<span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> String url<span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> String username<span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> String password<span class="token punctuation">;</span>    <span class="token keyword">static</span> <span class="token punctuation">{</span>        InputStream inputStream <span class="token operator">=</span> DBUtils<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">.</span><span class="token function">getClassLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getResourceAsStream</span><span class="token punctuation">(</span><span class="token string">"dbconfig.properties"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        Properties p <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Properties</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">try</span> <span class="token punctuation">{</span>            p<span class="token punctuation">.</span><span class="token function">load</span><span class="token punctuation">(</span>inputStream<span class="token punctuation">)</span><span class="token punctuation">;</span>            driverName <span class="token operator">=</span> p<span class="token punctuation">.</span><span class="token function">getProperty</span><span class="token punctuation">(</span><span class="token string">"driverName"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            url <span class="token operator">=</span> p<span class="token punctuation">.</span><span class="token function">getProperty</span><span class="token punctuation">(</span><span class="token string">"url"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            username <span class="token operator">=</span> p<span class="token punctuation">.</span><span class="token function">getProperty</span><span class="token punctuation">(</span><span class="token string">"username"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            password <span class="token operator">=</span> p<span class="token punctuation">.</span><span class="token function">getProperty</span><span class="token punctuation">(</span><span class="token string">"password"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            Class<span class="token punctuation">.</span><span class="token function">forName</span><span class="token punctuation">(</span>driverName<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> <span class="token operator">|</span> ClassNotFoundException e<span class="token punctuation">)</span> <span class="token punctuation">{</span>            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>        <span class="token comment" spellcheck="true">/**     * 获取连接对象     * @return 连接对象     */</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> Connection <span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> SQLException <span class="token punctuation">{</span>               Connection connection <span class="token operator">=</span> DriverManager<span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span>username<span class="token punctuation">,</span>password<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> connection<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true">/**     * 关闭资源     * @param rs 需要关闭的结果集     * @param stmt 需要关闭的statement对象     * @param connection 需要关闭的连接对象     */</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">closeAll</span><span class="token punctuation">(</span>ResultSet rs<span class="token punctuation">,</span>Statement stmt<span class="token punctuation">,</span>Connection connection<span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>rs <span class="token operator">!=</span> null<span class="token punctuation">)</span><span class="token punctuation">{</span>            <span class="token keyword">try</span> <span class="token punctuation">{</span>                rs<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">SQLException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>                e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>stmt <span class="token operator">!=</span> null<span class="token punctuation">)</span><span class="token punctuation">{</span>            <span class="token keyword">try</span> <span class="token punctuation">{</span>                stmt<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">SQLException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>                e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>connection <span class="token operator">!=</span> null<span class="token punctuation">)</span><span class="token punctuation">{</span>            <span class="token keyword">try</span> <span class="token punctuation">{</span>                connection<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">SQLException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>                e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span></code></pre><h4 id="使用上述可以可以实现普通存入取出"><a href="#使用上述可以可以实现普通存入取出" class="headerlink" title="使用上述可以可以实现普通存入取出"></a>使用上述可以可以实现普通存入取出</h4><h4 id="使用转账的功就不能实现，因为他是两个connection-不能提交到一个事务中，所以需要把connection设置成同一个。在开启事务，提交事务后转账成功"><a href="#使用转账的功就不能实现，因为他是两个connection-不能提交到一个事务中，所以需要把connection设置成同一个。在开启事务，提交事务后转账成功" class="headerlink" title="使用转账的功就不能实现，因为他是两个connection,不能提交到一个事务中，所以需要把connection设置成同一个。在开启事务，提交事务后转账成功"></a>使用转账的功就不能实现，因为他是两个connection,不能提交到一个事务中，所以需要把connection设置成同一个。在开启事务，提交事务后转账成功</h4><h4 id="save-和-get-与上述相同"><a href="#save-和-get-与上述相同" class="headerlink" title="save() 和 get()与上述相同"></a>save() 和 get()与上述相同</h4><h4 id="重新封装DBUtils工具类，把connection对象作为一个全局静态变量，在开启事务的时候获取connection对象，判断是否为空，为空就创建一个连接对象connection并把它赋给全局静态变量connection并返回，如果不为空就直接返回该connection对象即可；然后开启手动提交事务。执行save-存钱，存钱完后判断是否需要关闭流，判断到connection时再判断connection对象是否开启自动提交，如果之前开启了就不关闭connection流；然后执行get-方法，get-方法又会去调用getConnection-得到一个connection对象，由于之前connection并未关闭，所以它是不为空的，直接返回；同样在关闭流的时候判断是不是需要关闭，需要的话就关闭然后把全局静态变量connection重新赋值为null；get-执行完后调用commit-提交事务的方法，提交的时候再判断一下是不是为空，不为空就提交并把全局静态变量connection重新赋值为null。如果提交过程中出错例如了就回滚即可。"><a href="#重新封装DBUtils工具类，把connection对象作为一个全局静态变量，在开启事务的时候获取connection对象，判断是否为空，为空就创建一个连接对象connection并把它赋给全局静态变量connection并返回，如果不为空就直接返回该connection对象即可；然后开启手动提交事务。执行save-存钱，存钱完后判断是否需要关闭流，判断到connection时再判断connection对象是否开启自动提交，如果之前开启了就不关闭connection流；然后执行get-方法，get-方法又会去调用getConnection-得到一个connection对象，由于之前connection并未关闭，所以它是不为空的，直接返回；同样在关闭流的时候判断是不是需要关闭，需要的话就关闭然后把全局静态变量connection重新赋值为null；get-执行完后调用commit-提交事务的方法，提交的时候再判断一下是不是为空，不为空就提交并把全局静态变量connection重新赋值为null。如果提交过程中出错例如了就回滚即可。" class="headerlink" title="重新封装DBUtils工具类，把connection对象作为一个全局静态变量，在开启事务的时候获取connection对象，判断是否为空，为空就创建一个连接对象connection并把它赋给全局静态变量connection并返回，如果不为空就直接返回该connection对象即可；然后开启手动提交事务。执行save()存钱，存钱完后判断是否需要关闭流，判断到connection时再判断connection对象是否开启自动提交，如果之前开启了就不关闭connection流；然后执行get()方法，get()方法又会去调用getConnection()得到一个connection对象，由于之前connection并未关闭，所以它是不为空的，直接返回；同样在关闭流的时候判断是不是需要关闭，需要的话就关闭然后把全局静态变量connection重新赋值为null；get()执行完后调用commit()提交事务的方法，提交的时候再判断一下是不是为空，不为空就提交并把全局静态变量connection重新赋值为null。如果提交过程中出错例如了就回滚即可。"></a>重新封装DBUtils工具类，把connection对象作为一个全局静态变量，在开启事务的时候获取connection对象，判断是否为空，为空就创建一个连接对象connection并把它赋给全局静态变量connection并返回，如果不为空就直接返回该connection对象即可；然后开启手动提交事务。执行save()存钱，存钱完后判断是否需要关闭流，判断到connection时再判断connection对象是否开启自动提交，如果之前开启了就不关闭connection流；然后执行get()方法，get()方法又会去调用getConnection()得到一个connection对象，由于之前connection并未关闭，所以它是不为空的，直接返回；同样在关闭流的时候判断是不是需要关闭，需要的话就关闭然后把全局静态变量connection重新赋值为null；get()执行完后调用commit()提交事务的方法，提交的时候再判断一下是不是为空，不为空就提交并把全局静态变量connection重新赋值为null。如果提交过程中出错例如了就回滚即可。</h4><pre class=" language-java"><code class="language-java"><span class="token keyword">package</span> com<span class="token punctuation">.</span>qf<span class="token punctuation">.</span>utils<span class="token punctuation">;</span><span class="token keyword">import</span> java<span class="token punctuation">.</span>io<span class="token punctuation">.</span>IOException<span class="token punctuation">;</span><span class="token keyword">import</span> java<span class="token punctuation">.</span>io<span class="token punctuation">.</span>InputStream<span class="token punctuation">;</span><span class="token keyword">import</span> java<span class="token punctuation">.</span>sql<span class="token punctuation">.</span>*<span class="token punctuation">;</span><span class="token keyword">import</span> java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>Properties<span class="token punctuation">;</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DBUtils</span> <span class="token punctuation">{</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> String driverName<span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> String url<span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> String username<span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> String password<span class="token punctuation">;</span>    <span class="token keyword">static</span> <span class="token punctuation">{</span>        InputStream inputStream <span class="token operator">=</span> DBUtils<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">.</span><span class="token function">getClassLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getResourceAsStream</span><span class="token punctuation">(</span><span class="token string">"dbconfig.properties"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        Properties p <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Properties</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">try</span> <span class="token punctuation">{</span>            p<span class="token punctuation">.</span><span class="token function">load</span><span class="token punctuation">(</span>inputStream<span class="token punctuation">)</span><span class="token punctuation">;</span>            driverName <span class="token operator">=</span> p<span class="token punctuation">.</span><span class="token function">getProperty</span><span class="token punctuation">(</span><span class="token string">"driverName"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            url <span class="token operator">=</span> p<span class="token punctuation">.</span><span class="token function">getProperty</span><span class="token punctuation">(</span><span class="token string">"url"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            username <span class="token operator">=</span> p<span class="token punctuation">.</span><span class="token function">getProperty</span><span class="token punctuation">(</span><span class="token string">"username"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            password <span class="token operator">=</span> p<span class="token punctuation">.</span><span class="token function">getProperty</span><span class="token punctuation">(</span><span class="token string">"password"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            Class<span class="token punctuation">.</span><span class="token function">forName</span><span class="token punctuation">(</span>driverName<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> <span class="token operator">|</span> ClassNotFoundException e<span class="token punctuation">)</span> <span class="token punctuation">{</span>            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> Connection connection <span class="token operator">=</span> null<span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">/**     * 开启事务     * @throws SQLException     */</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">startTransaction</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> SQLException <span class="token punctuation">{</span>        connection <span class="token operator">=</span> <span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        connection<span class="token punctuation">.</span><span class="token function">setAutoCommit</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true">/**     *  提交事务     * @throws SQLException     */</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">commit</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> SQLException <span class="token punctuation">{</span>        connection <span class="token operator">=</span> <span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>connection <span class="token operator">!=</span> null<span class="token punctuation">)</span><span class="token punctuation">{</span>            connection<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            connection <span class="token operator">=</span> null<span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">rollBack</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> SQLException <span class="token punctuation">{</span>        connection <span class="token operator">=</span> <span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>connection <span class="token operator">!=</span> null<span class="token punctuation">)</span> <span class="token punctuation">{</span>            connection<span class="token punctuation">.</span><span class="token function">rollback</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            connection <span class="token operator">=</span> null<span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true">/**     * 获取连接对象     * @return 连接对象     */</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> Connection <span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> SQLException <span class="token punctuation">{</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>connection <span class="token operator">==</span> null<span class="token punctuation">)</span><span class="token punctuation">{</span>            connection <span class="token operator">=</span> DriverManager<span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span>username<span class="token punctuation">,</span>password<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token keyword">return</span> connection<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true">/**     * 关闭资源     * @param rs 需要关闭的结果集     * @param stmt 需要关闭的statement对象     * @param connection 需要关闭的连接对象     */</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">closeAll</span><span class="token punctuation">(</span>ResultSet rs<span class="token punctuation">,</span>Statement stmt<span class="token punctuation">,</span>Connection connection<span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>rs <span class="token operator">!=</span> null<span class="token punctuation">)</span><span class="token punctuation">{</span>            <span class="token keyword">try</span> <span class="token punctuation">{</span>                rs<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">SQLException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>                e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>stmt <span class="token operator">!=</span> null<span class="token punctuation">)</span><span class="token punctuation">{</span>            <span class="token keyword">try</span> <span class="token punctuation">{</span>                stmt<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">SQLException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>                e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>connection <span class="token operator">!=</span> null<span class="token punctuation">)</span><span class="token punctuation">{</span>            <span class="token keyword">try</span> <span class="token punctuation">{</span>                <span class="token comment" spellcheck="true">//判断连接对象是否开启自动提交</span>                <span class="token keyword">if</span> <span class="token punctuation">(</span>connection<span class="token punctuation">.</span><span class="token function">getAutoCommit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>                    connection<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                    DBUtils<span class="token punctuation">.</span>connection <span class="token operator">=</span> null<span class="token punctuation">;</span>                <span class="token punctuation">}</span>            <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">SQLException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>                e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span></code></pre><h4 id="转账"><a href="#转账" class="headerlink" title="转账"></a>转账</h4><pre class=" language-java"><code class="language-java"><span class="token comment" spellcheck="true">//转账1 (不出错)</span><span class="token keyword">try</span> <span class="token punctuation">{</span>    DBUtils<span class="token punctuation">.</span><span class="token function">startTransaction</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">save</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">get</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    DBUtils<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">SQLException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>    e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><pre class=" language-java"><code class="language-java"><span class="token comment" spellcheck="true">//转账2 (出错)</span><span class="token keyword">try</span> <span class="token punctuation">{</span>    DBUtils<span class="token punctuation">.</span><span class="token function">startTransaction</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">save</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">/</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">get</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    DBUtils<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">SQLException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">try</span> <span class="token punctuation">{</span>        DBUtils<span class="token punctuation">.</span><span class="token function">rollBack</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">SQLException</span> ex<span class="token punctuation">)</span> <span class="token punctuation">{</span>        ex<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><h4 id="上述方法虽然解决了使用同一个connection但是并不能解决多线程下多个用户转账实现。如何解决请看深入JDBC事务2"><a href="#上述方法虽然解决了使用同一个connection但是并不能解决多线程下多个用户转账实现。如何解决请看深入JDBC事务2" class="headerlink" title="上述方法虽然解决了使用同一个connection但是并不能解决多线程下多个用户转账实现。如何解决请看深入JDBC事务2"></a>上述方法虽然解决了使用同一个connection但是并不能解决多线程下多个用户转账实现。如何解决请看深入JDBC事务2</h4>]]></content>
      
      
      <categories>
          
          <category> JDBC </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/2023/01/04/forkjoin-bing-xing-ji-suan-kuang-jia-1/"/>
      <url>/2023/01/04/forkjoin-bing-xing-ji-suan-kuang-jia-1/</url>
      
        <content type="html"><![CDATA[<h1 id="Fork-x2F-Join并行计算框架"><a href="#Fork-x2F-Join并行计算框架" class="headerlink" title="Fork/Join并行计算框架"></a>Fork/Join并行计算框架</h1><h3 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h3><blockquote><p>Fork/Join框架：在必要时将一个大任务进行拆分（fork）成若干个小任务（拆到不可再拆时），再将一个个</p><p>小任务的运行结果进行join合并，一般都是在大数据搜索中使用</p><p>Fork/Join采用“工作窃取” 模式(work-stealing) ：</p><p>当执行新的任务时它可以将其拆分分成更小的任务执行，并将小任务加到线程队列中。在程序执行过程中如果有闲置线程，闲置线程会把其他线程的线程队列末尾的任务偷偷拿到自己的线程中执行，注意线程队列是双关，即队列里最前面的任务会被直接，最后的任务会被闲置线程拿走去执行。这种方式减少了线程的等待时间，提高了性能</p></blockquote><p><img src="data:image/jpg;base64,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" alt="avatar"></p><h3 id="具体使用"><a href="#具体使用" class="headerlink" title="具体使用"></a>具体使用</h3><pre class=" language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Test1</span> <span class="token punctuation">{</span>    <span class="token annotation punctuation">@Test</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test01</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token comment" spellcheck="true">//需求：计算1-10000000L之和</span>                <span class="token comment" spellcheck="true">//创建并发线程池对象</span>        ForkJoinPool pool <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ForkJoinPool</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">//提交任务并得到结果</span>        Long sum <span class="token operator">=</span> pool<span class="token punctuation">.</span><span class="token function">invoke</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ForkJoinCalculateTask</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>10000000L<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>sum<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token comment" spellcheck="true">//计算任务类</span><span class="token comment" spellcheck="true">//class ForkJoinCalculateTask extends RecursiveAction{//无返回值的任务类</span><span class="token keyword">class</span> <span class="token class-name">ForkJoinCalculateTask</span> <span class="token keyword">extends</span> <span class="token class-name">RecursiveTask</span><span class="token operator">&lt;</span>Long<span class="token operator">></span><span class="token punctuation">{</span><span class="token comment" spellcheck="true">//有返回值的任务类</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">long</span> serialVersionUID <span class="token operator">=</span> 1975909145028788652L<span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token keyword">long</span> startNum<span class="token punctuation">;</span><span class="token comment" spellcheck="true">//开始数字</span>    <span class="token keyword">private</span> <span class="token keyword">long</span> endNum<span class="token punctuation">;</span><span class="token comment" spellcheck="true">//结束数字</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">long</span> THRESHOLD <span class="token operator">=</span> <span class="token number">10000</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//临界值，每到10000就分成小任务</span>    <span class="token keyword">public</span> <span class="token function">ForkJoinCalculateTask</span><span class="token punctuation">(</span><span class="token keyword">long</span> startNum<span class="token punctuation">,</span> <span class="token keyword">long</span> endNum<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>startNum <span class="token operator">=</span> startNum<span class="token punctuation">;</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>endNum <span class="token operator">=</span> endNum<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">protected</span> Long <span class="token function">compute</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                <span class="token keyword">long</span> len <span class="token operator">=</span> endNum<span class="token operator">-</span>startNum<span class="token punctuation">;</span>                <span class="token keyword">if</span><span class="token punctuation">(</span>len <span class="token operator">&lt;=</span> THRESHOLD<span class="token punctuation">)</span><span class="token punctuation">{</span>            <span class="token keyword">long</span> sum <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">long</span> i <span class="token operator">=</span> startNum<span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> endNum<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                sum <span class="token operator">+=</span> i<span class="token punctuation">;</span>            <span class="token punctuation">}</span>            <span class="token keyword">return</span> sum<span class="token punctuation">;</span>        <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>                        <span class="token keyword">long</span> mid <span class="token operator">=</span> <span class="token punctuation">(</span>startNum<span class="token operator">+</span>endNum<span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">;</span>                        ForkJoinCalculateTask left <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ForkJoinCalculateTask</span><span class="token punctuation">(</span>startNum<span class="token punctuation">,</span> mid<span class="token punctuation">)</span><span class="token punctuation">;</span>            left<span class="token punctuation">.</span><span class="token function">fork</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//拆分成子任务并压入新队列</span>                        ForkJoinCalculateTask right <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ForkJoinCalculateTask</span><span class="token punctuation">(</span>mid<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span> endNum<span class="token punctuation">)</span><span class="token punctuation">;</span>            right<span class="token punctuation">.</span><span class="token function">fork</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//拆分成子任务并压入新队列</span>                        <span class="token comment" spellcheck="true">//把结果合并返回</span>            <span class="token keyword">return</span> left<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> right<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span></code></pre>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>JDBC事务</title>
      <link href="/2023/01/04/jdbc-shi-wu/"/>
      <url>/2023/01/04/jdbc-shi-wu/</url>
      
        <content type="html"><![CDATA[<p>MySQL：每一条语句都属于独立事务,默认自动管理提交的。</p><p>如果需要把多条语句当成一个整体，那么就需要把多条语句放在一个事务里面</p><ul><li>开启事务：start transaction</li><li>提交事务：commit;</li><li>回滚事务：rollback</li></ul><p>xxxxxxxxxx&nbsp;public class Test02 { &nbsp; &nbsp;/** &nbsp; &nbsp; * 知识点：封装DBUtil – commonUpdate(String sql,Object… params) – 主键回填 &nbsp; &nbsp; */ &nbsp; &nbsp;@Test &nbsp; &nbsp;public void testAdd() { &nbsp; &nbsp; &nbsp; &nbsp;//添加数据 &nbsp; &nbsp; &nbsp; &nbsp;String sql = “insert into student(username,password,name,sex,age,salary,course) values(?,?,?,?,?,?,?)”; &nbsp; &nbsp; &nbsp; &nbsp;int primaryKey = DBUtils.commonInsert(sql, “zhangsan”, “123321”, “张三”, “男”, 19, 1000, “Java”); &nbsp; &nbsp; &nbsp; &nbsp;System.out.println(primaryKey); &nbsp;  }​}java</p><p> JDBC控制事务语句  –mysql控制事务语句</p><ul><li>Connection.setAutoCommit(false);  start transaction</li><li>Connection.rollback(); rollback</li><li>Connection.commit(); commit</li></ul><p>事务的特性：</p><ol><li><p>Atomicity：原子性</p><p>事务是数据库的逻辑工作单位，事务中包含的各操作要么都完成，要么都不完成</p></li><li><p>Consistency：一致性</p><p>事务执行的结果必须是使数据库从一个一致性状态变到另一个一致性状态。因此当数据库只包含成功事务提交的结果时，就说数据库处于一致性状态。如果数据库系统 运行中发生故障，有些事务尚未完成就被迫中断，这些未完成事务对数据库所做的修改有一部分已写入物理数据库，这时数据库就处于一种不正确的状态，或者说是 不一致的状态。</p></li><li><p>Isolation：隔离性</p><p>一个事务的执行不能其它事务干扰。即一个事务内部的操作及使用的数据对其它并发事务是隔离的，并发执行的各个事务之间不能互相干扰。</p></li><li><p>Durability：持久性</p><p>指一个事务一旦提交，它对数据库中的数据的改变就应该是永久性的。接下来的其它操作或故障不应该对其执行结果有任何影响。</p></li></ol><p>事务的隔离级别：</p><ol><li><p>READ UNCOMMITTED 脏读、不可重复读、虚读有可能发生。</p></li><li><p>READ COMMITTED 避免脏读的发生，不可重复读、虚读有可能发生。</p></li><li><p>REPEATABLE READ 避免脏读、不可重复读的发生，虚读有可能发生。</p></li><li><p>SERIALIZABLE 避免脏读、不可重复读、虚读的发生。</p></li></ol><h4 id="需求：模拟银行转账"><a href="#需求：模拟银行转账" class="headerlink" title="需求：模拟银行转账"></a>需求：模拟银行转账</h4><h4 id="1-建表"><a href="#1-建表" class="headerlink" title="1.建表"></a>1.建表</h4><p><img src="http://rnn4o4eu8.hd-bkt.clouddn.com/blog_image/image-20230104101409001.png" alt="image-20230104101409001"></p><h4 id="2-封装连接JDBC的工具类DButils"><a href="#2-封装连接JDBC的工具类DButils" class="headerlink" title="2.封装连接JDBC的工具类DButils"></a>2.封装连接JDBC的工具类DButils</h4><pre class=" language-java"><code class="language-java"><span class="token keyword">package</span> com<span class="token punctuation">.</span>qf<span class="token punctuation">.</span>utils<span class="token punctuation">;</span><span class="token keyword">import</span> java<span class="token punctuation">.</span>io<span class="token punctuation">.</span>IOException<span class="token punctuation">;</span><span class="token keyword">import</span> java<span class="token punctuation">.</span>io<span class="token punctuation">.</span>InputStream<span class="token punctuation">;</span><span class="token keyword">import</span> java<span class="token punctuation">.</span>sql<span class="token punctuation">.</span>*<span class="token punctuation">;</span><span class="token keyword">import</span> java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>Properties<span class="token punctuation">;</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DBUtils</span> <span class="token punctuation">{</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> String driverName<span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> String url<span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> String username<span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> String password<span class="token punctuation">;</span>    <span class="token keyword">static</span> <span class="token punctuation">{</span>        InputStream inputStream <span class="token operator">=</span> DBUtils<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">.</span><span class="token function">getClassLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getResourceAsStream</span><span class="token punctuation">(</span><span class="token string">"dbconfig.properties"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        Properties p <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Properties</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">try</span> <span class="token punctuation">{</span>            p<span class="token punctuation">.</span><span class="token function">load</span><span class="token punctuation">(</span>inputStream<span class="token punctuation">)</span><span class="token punctuation">;</span>            driverName <span class="token operator">=</span> p<span class="token punctuation">.</span><span class="token function">getProperty</span><span class="token punctuation">(</span><span class="token string">"driverName"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            url <span class="token operator">=</span> p<span class="token punctuation">.</span><span class="token function">getProperty</span><span class="token punctuation">(</span><span class="token string">"url"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            username <span class="token operator">=</span> p<span class="token punctuation">.</span><span class="token function">getProperty</span><span class="token punctuation">(</span><span class="token string">"username"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            password <span class="token operator">=</span> p<span class="token punctuation">.</span><span class="token function">getProperty</span><span class="token punctuation">(</span><span class="token string">"password"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            Class<span class="token punctuation">.</span><span class="token function">forName</span><span class="token punctuation">(</span>driverName<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> <span class="token operator">|</span> ClassNotFoundException e<span class="token punctuation">)</span> <span class="token punctuation">{</span>            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true">/**     * 获取连接对象     * @return 连接对象     */</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> Connection <span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> SQLException <span class="token punctuation">{</span>        Connection conn <span class="token operator">=</span> null<span class="token punctuation">;</span>        conn <span class="token operator">=</span> DriverManager<span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span>username<span class="token punctuation">,</span>password<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> conn<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true">/**     * 关闭资源     * @param rs 需要关闭的结果集     * @param stmt 需要关闭的statement对象     * @param conn 需要关闭的连接对象     */</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">closeAll</span><span class="token punctuation">(</span>ResultSet rs<span class="token punctuation">,</span>Statement stmt<span class="token punctuation">,</span>Connection conn<span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>rs <span class="token operator">!=</span> null<span class="token punctuation">)</span><span class="token punctuation">{</span>            <span class="token keyword">try</span> <span class="token punctuation">{</span>                rs<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">SQLException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>                e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>stmt <span class="token operator">!=</span> null<span class="token punctuation">)</span><span class="token punctuation">{</span>            <span class="token keyword">try</span> <span class="token punctuation">{</span>                stmt<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">SQLException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>                e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>conn <span class="token operator">!=</span> null<span class="token punctuation">)</span><span class="token punctuation">{</span>            <span class="token keyword">try</span> <span class="token punctuation">{</span>                conn<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">SQLException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>                e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span></code></pre><p>properties文件</p><pre class=" language-java"><code class="language-java">driverName <span class="token operator">=</span> com<span class="token punctuation">.</span>mysql<span class="token punctuation">.</span>jdbc<span class="token punctuation">.</span>Driverurl <span class="token operator">=</span> jdbc<span class="token operator">:</span>mysql<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>localhost<span class="token operator">:</span><span class="token number">3306</span><span class="token operator">/</span>2213javaee<span class="token operator">?</span>useUnicode<span class="token operator">=</span><span class="token boolean">true</span><span class="token operator">&amp;</span>characterEncoding<span class="token operator">=</span>UTF<span class="token operator">-</span><span class="token number">8</span>username <span class="token operator">=</span> rootpassword <span class="token operator">=</span> <span class="token number">123456</span></code></pre><h4 id="3-模拟实现"><a href="#3-模拟实现" class="headerlink" title="3.模拟实现"></a>3.模拟实现</h4><p>获取连接对象后把setAutoCommit属性设置为false,开启事务，最后执行commit提交事务，如果程序出错会回滚事务。</p><pre class=" language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>        Connection connection <span class="token operator">=</span> null<span class="token punctuation">;</span>        PreparedStatement statement1<span class="token operator">=</span>null<span class="token punctuation">;</span>        PreparedStatement statement2<span class="token operator">=</span>null<span class="token punctuation">;</span>        <span class="token keyword">try</span> <span class="token punctuation">{</span>            connection <span class="token operator">=</span> DBUtils<span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment" spellcheck="true">//开启事务(关闭自动提交)</span>            connection<span class="token punctuation">.</span><span class="token function">setAutoCommit</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            String sql1 <span class="token operator">=</span> <span class="token string">"update bank set monye = monye-200 where id=1"</span><span class="token punctuation">;</span>            statement1 <span class="token operator">=</span> connection<span class="token punctuation">.</span><span class="token function">prepareStatement</span><span class="token punctuation">(</span>sql1<span class="token punctuation">)</span><span class="token punctuation">;</span>            statement1<span class="token punctuation">.</span><span class="token function">executeUpdate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//            System.out.println(1/0);</span>            String sql2 <span class="token operator">=</span> <span class="token string">"update bank set monye = monye+200 where id=2"</span><span class="token punctuation">;</span>            statement2 <span class="token operator">=</span> connection<span class="token punctuation">.</span><span class="token function">prepareStatement</span><span class="token punctuation">(</span>sql2<span class="token punctuation">)</span><span class="token punctuation">;</span>            statement2<span class="token punctuation">.</span><span class="token function">executeUpdate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment" spellcheck="true">//提交事务</span>            connection<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">SQLException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"程序出错了，回滚事务~~~~"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>connection <span class="token operator">!=</span> null<span class="token punctuation">)</span><span class="token punctuation">{</span>                <span class="token keyword">try</span> <span class="token punctuation">{</span>                    connection<span class="token punctuation">.</span><span class="token function">rollback</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">SQLException</span> ex<span class="token punctuation">)</span> <span class="token punctuation">{</span>                    ex<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token punctuation">}</span>            <span class="token punctuation">}</span>            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{</span>            DBUtils<span class="token punctuation">.</span><span class="token function">closeAll</span><span class="token punctuation">(</span>null<span class="token punctuation">,</span>statement2<span class="token punctuation">,</span>connection<span class="token punctuation">)</span><span class="token punctuation">;</span>            DBUtils<span class="token punctuation">.</span><span class="token function">closeAll</span><span class="token punctuation">(</span>null<span class="token punctuation">,</span>statement1<span class="token punctuation">,</span>connection<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span></code></pre><h4 id="4-结果"><a href="#4-结果" class="headerlink" title="4.结果"></a>4.结果</h4><p><img src="http://rnn4o4eu8.hd-bkt.clouddn.com/blog_image/image-20230104101738217.png" alt="image-20230104101738217"></p>]]></content>
      
      
      <categories>
          
          <category> JDBC </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>CBLog的使用</title>
      <link href="/2023/01/03/cblob-shi-yong/"/>
      <url>/2023/01/03/cblob-shi-yong/</url>
      
        <content type="html"><![CDATA[<h2 id="使用JDBC进行cblob类型文件在MySQL的存入和取出"><a href="#使用JDBC进行cblob类型文件在MySQL的存入和取出" class="headerlink" title="使用JDBC进行cblob类型文件在MySQL的存入和取出"></a>使用JDBC进行cblob类型文件在MySQL的存入和取出</h2><h4 id="Clob：数据库的字段类型是Text、longText，该字段上可以存储长文本数据"><a href="#Clob：数据库的字段类型是Text、longText，该字段上可以存储长文本数据" class="headerlink" title="Clob：数据库的字段类型是Text、longText，该字段上可以存储长文本数据"></a>Clob：数据库的字段类型是Text、longText，该字段上可以存储长文本数据</h4><h4 id="Blob：数据库字段类型是blob，LongBlob，该字段可以存储二进制的数据"><a href="#Blob：数据库字段类型是blob，LongBlob，该字段可以存储二进制的数据" class="headerlink" title="Blob：数据库字段类型是blob，LongBlob，该字段可以存储二进制的数据"></a>Blob：数据库字段类型是blob，LongBlob，该字段可以存储二进制的数据</h4><h4 id="1-创建cb-lob的表，把c-lob类型设置为longtext，b-lob类型设置为longblob"><a href="#1-创建cb-lob的表，把c-lob类型设置为longtext，b-lob类型设置为longblob" class="headerlink" title="1.创建cb_lob的表，把c_lob类型设置为longtext，b_lob类型设置为longblob"></a>1.创建cb_lob的表，把c_lob类型设置为longtext，b_lob类型设置为longblob</h4><p><img src="http://rnn4o4eu8.hd-bkt.clouddn.com/blog_image/image-20230103200722274.png" alt="image-20230103200722274"></p><h4 id="2-准备好一个txt文件和一张图片"><a href="#2-准备好一个txt文件和一张图片" class="headerlink" title="2.准备好一个txt文件和一张图片"></a>2.准备好一个txt文件和一张图片</h4><h4 id="3-先把JDBC连接的工具类封装好"><a href="#3-先把JDBC连接的工具类封装好" class="headerlink" title="3.先把JDBC连接的工具类封装好"></a>3.先把JDBC连接的工具类封装好</h4><pre class=" language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DBUtils</span> <span class="token punctuation">{</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> String driverName<span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> String url<span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> String username<span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> String password<span class="token punctuation">;</span>    <span class="token keyword">static</span> <span class="token punctuation">{</span>        InputStream inputStream <span class="token operator">=</span> DBUtils<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">.</span><span class="token function">getClassLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getResourceAsStream</span><span class="token punctuation">(</span><span class="token string">"dbconfig.properties"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        Properties p <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Properties</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">try</span> <span class="token punctuation">{</span>            p<span class="token punctuation">.</span><span class="token function">load</span><span class="token punctuation">(</span>inputStream<span class="token punctuation">)</span><span class="token punctuation">;</span>            driverName <span class="token operator">=</span> p<span class="token punctuation">.</span><span class="token function">getProperty</span><span class="token punctuation">(</span><span class="token string">"driverName"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            url <span class="token operator">=</span> p<span class="token punctuation">.</span><span class="token function">getProperty</span><span class="token punctuation">(</span><span class="token string">"url"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            username <span class="token operator">=</span> p<span class="token punctuation">.</span><span class="token function">getProperty</span><span class="token punctuation">(</span><span class="token string">"username"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            password <span class="token operator">=</span> p<span class="token punctuation">.</span><span class="token function">getProperty</span><span class="token punctuation">(</span><span class="token string">"password"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            Class<span class="token punctuation">.</span><span class="token function">forName</span><span class="token punctuation">(</span>driverName<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> <span class="token operator">|</span> ClassNotFoundException e<span class="token punctuation">)</span> <span class="token punctuation">{</span>            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> Connection <span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token punctuation">{</span>        Connection conn <span class="token operator">=</span> null<span class="token punctuation">;</span>        <span class="token keyword">try</span> <span class="token punctuation">{</span>            conn <span class="token operator">=</span> DriverManager<span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span>username<span class="token punctuation">,</span>password<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">SQLException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token keyword">return</span> conn<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true">/**     * 关闭资源     * @param rs 需要关闭的结果集     * @param stmt 需要关闭的statement对象     * @param conn 需要关闭的连接对象     */</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">closeAll</span><span class="token punctuation">(</span>ResultSet rs<span class="token punctuation">,</span>Statement stmt<span class="token punctuation">,</span>Connection conn<span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>rs <span class="token operator">!=</span> null<span class="token punctuation">)</span><span class="token punctuation">{</span>            <span class="token keyword">try</span> <span class="token punctuation">{</span>                rs<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">SQLException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>                e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>stmt <span class="token operator">!=</span> null<span class="token punctuation">)</span><span class="token punctuation">{</span>            <span class="token keyword">try</span> <span class="token punctuation">{</span>                stmt<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">SQLException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>                e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>conn <span class="token operator">!=</span> null<span class="token punctuation">)</span><span class="token punctuation">{</span>            <span class="token keyword">try</span> <span class="token punctuation">{</span>                conn<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">SQLException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>                e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span></code></pre><h5 id="properties文件"><a href="#properties文件" class="headerlink" title="properties文件"></a>properties文件</h5><pre class=" language-java"><code class="language-java">driverName <span class="token operator">=</span> com<span class="token punctuation">.</span>mysql<span class="token punctuation">.</span>jdbc<span class="token punctuation">.</span>Driverurl <span class="token operator">=</span> jdbc<span class="token operator">:</span>mysql<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>localhost<span class="token operator">:</span><span class="token number">3306</span><span class="token operator">/</span>2213javaee<span class="token operator">?</span>useUnicode<span class="token operator">=</span><span class="token boolean">true</span><span class="token operator">&amp;</span>characterEncoding<span class="token operator">=</span>UTF<span class="token operator">-</span><span class="token number">8</span>username <span class="token operator">=</span> rootpassword <span class="token operator">=</span> <span class="token number">123456</span></code></pre><h4 id="4-存入长文本数据"><a href="#4-存入长文本数据" class="headerlink" title="4.存入长文本数据"></a>4.存入长文本数据</h4><pre class=" language-java"><code class="language-java"><span class="token annotation punctuation">@Test</span>    <span class="token comment" spellcheck="true">//存储长文本数据</span><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test01</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> Exception <span class="token punctuation">{</span>    <span class="token comment" spellcheck="true">//创建连接对象</span>    Connection connection <span class="token operator">=</span> DBUtils<span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    String sql <span class="token operator">=</span> <span class="token string">"insert into cb_lob(c_lob) values(?)"</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">//获取sql命令执行对象</span>    PreparedStatement statement <span class="token operator">=</span> connection<span class="token punctuation">.</span><span class="token function">prepareStatement</span><span class="token punctuation">(</span>sql<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">//创建文件对象</span>    File file <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span><span class="token string">"hhy.txt"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">//使用字符流存入长文本文件</span>    FileReader reader <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileReader</span><span class="token punctuation">(</span>file<span class="token punctuation">)</span><span class="token punctuation">;</span>    statement<span class="token punctuation">.</span><span class="token function">setCharacterStream</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>reader<span class="token punctuation">,</span>file<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">//执行sql语句</span>    statement<span class="token punctuation">.</span><span class="token function">executeUpdate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">//关闭流</span>    DBUtils<span class="token punctuation">.</span><span class="token function">closeAll</span><span class="token punctuation">(</span>null<span class="token punctuation">,</span>statement<span class="token punctuation">,</span>connection<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><h4 id="5-取出长文本数据"><a href="#5-取出长文本数据" class="headerlink" title="5.取出长文本数据"></a>5.取出长文本数据</h4><pre class=" language-java"><code class="language-java"><span class="token annotation punctuation">@Test</span><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test02</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> Exception<span class="token punctuation">{</span>    <span class="token comment" spellcheck="true">//取出长文本文件</span>    Connection connection <span class="token operator">=</span> DBUtils<span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    String sql <span class="token operator">=</span> <span class="token string">"select * from cb_lob where id =10"</span><span class="token punctuation">;</span>    PreparedStatement statement <span class="token operator">=</span> connection<span class="token punctuation">.</span><span class="token function">prepareStatement</span><span class="token punctuation">(</span>sql<span class="token punctuation">)</span><span class="token punctuation">;</span>    ResultSet resultSet <span class="token operator">=</span> statement<span class="token punctuation">.</span><span class="token function">executeQuery</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>resultSet<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        Reader reader <span class="token operator">=</span> resultSet<span class="token punctuation">.</span><span class="token function">getCharacterStream</span><span class="token punctuation">(</span><span class="token string">"c_lob"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        FileWriter writer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileWriter</span><span class="token punctuation">(</span><span class="token string">"text.txt"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">char</span><span class="token punctuation">[</span><span class="token punctuation">]</span> cs <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">char</span><span class="token punctuation">[</span><span class="token number">1024</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> len<span class="token punctuation">;</span>        <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>len <span class="token operator">=</span> reader<span class="token punctuation">.</span><span class="token function">read</span><span class="token punctuation">(</span>cs<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">{</span>            writer<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>cs<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>len<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        reader<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        writer<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span></code></pre><h5 id="取出后有个text-txt的文件，内容和存入前的hhy-txt文件相同"><a href="#取出后有个text-txt的文件，内容和存入前的hhy-txt文件相同" class="headerlink" title="取出后有个text.txt的文件，内容和存入前的hhy.txt文件相同"></a>取出后有个text.txt的文件，内容和存入前的hhy.txt文件相同</h5><h4 id="6-存入二进制文件数据"><a href="#6-存入二进制文件数据" class="headerlink" title="6.存入二进制文件数据"></a>6.存入二进制文件数据</h4><pre class=" language-java"><code class="language-java"><span class="token annotation punctuation">@Test</span><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test01</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> Exception <span class="token punctuation">{</span>    <span class="token comment" spellcheck="true">//存储二进制数据</span>    Connection connection <span class="token operator">=</span> DBUtils<span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    String sql <span class="token operator">=</span> <span class="token string">"insert into cb_lob(b_lob) values(?)"</span><span class="token punctuation">;</span>    PreparedStatement statement <span class="token operator">=</span> connection<span class="token punctuation">.</span><span class="token function">prepareStatement</span><span class="token punctuation">(</span>sql<span class="token punctuation">)</span><span class="token punctuation">;</span>    File file <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span><span class="token string">"tx2.jpg"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">//使用字节流写入二进制数据</span>    FileInputStream inputStream <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileInputStream</span><span class="token punctuation">(</span>file<span class="token punctuation">)</span><span class="token punctuation">;</span>    statement<span class="token punctuation">.</span><span class="token function">setBinaryStream</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>inputStream<span class="token punctuation">,</span>file<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    statement<span class="token punctuation">.</span><span class="token function">executeUpdate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    DBUtils<span class="token punctuation">.</span><span class="token function">closeAll</span><span class="token punctuation">(</span>null<span class="token punctuation">,</span>statement<span class="token punctuation">,</span>connection<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><h4 id="7-取出二进制文件数据"><a href="#7-取出二进制文件数据" class="headerlink" title="7.取出二进制文件数据"></a>7.取出二进制文件数据</h4><pre class=" language-java"><code class="language-java"><span class="token annotation punctuation">@Test</span><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test02</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> Exception<span class="token punctuation">{</span>    <span class="token comment" spellcheck="true">//取出二进制文件</span>    Connection connection <span class="token operator">=</span> DBUtils<span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    String sql <span class="token operator">=</span> <span class="token string">"select * from cb_lob where id = 11"</span><span class="token punctuation">;</span>    PreparedStatement statement <span class="token operator">=</span> connection<span class="token punctuation">.</span><span class="token function">prepareStatement</span><span class="token punctuation">(</span>sql<span class="token punctuation">)</span><span class="token punctuation">;</span>    ResultSet resultSet <span class="token operator">=</span> statement<span class="token punctuation">.</span><span class="token function">executeQuery</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>resultSet<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        InputStream inputStream <span class="token operator">=</span> resultSet<span class="token punctuation">.</span><span class="token function">getBinaryStream</span><span class="token punctuation">(</span><span class="token string">"b_lob"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        FileOutputStream outputStream <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileOutputStream</span><span class="token punctuation">(</span><span class="token string">"pic.jpg"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> len<span class="token punctuation">;</span>        <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> bs <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">byte</span><span class="token punctuation">[</span><span class="token number">1024</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>len <span class="token operator">=</span> inputStream<span class="token punctuation">.</span><span class="token function">read</span><span class="token punctuation">(</span>bs<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">{</span>            outputStream<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>bs<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>len<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        inputStream<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        outputStream<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    DBUtils<span class="token punctuation">.</span><span class="token function">closeAll</span><span class="token punctuation">(</span>resultSet<span class="token punctuation">,</span>statement<span class="token punctuation">,</span>connection<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><h5 id="取出后的图片pic-jpg和存入前的图片tx2-jpg相同"><a href="#取出后的图片pic-jpg和存入前的图片tx2-jpg相同" class="headerlink" title="取出后的图片pic.jpg和存入前的图片tx2.jpg相同"></a>取出后的图片pic.jpg和存入前的图片tx2.jpg相同</h5><h4 id="8-结果"><a href="#8-结果" class="headerlink" title="8.结果"></a>8.结果</h4><p><img src="http://rnn4o4eu8.hd-bkt.clouddn.com/blog_image/image-20230103202641067.png" alt="image-20230103202641067"></p>]]></content>
      
      
      <categories>
          
          <category> JDBC </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>JDK1.8新特性</title>
      <link href="/2022/11/28/jdk1-8-xin-te-xing/"/>
      <url>/2022/11/28/jdk1-8-xin-te-xing/</url>
      
        <content type="html"><![CDATA[<h2 id=""><a href="#" class="headerlink" title=""></a></h2><h3 id="1-lamda表达式"><a href="#1-lamda表达式" class="headerlink" title="1 lamda表达式"></a>1 lamda表达式</h3><pre class=" language-java"><code class="language-java"><span class="token comment" spellcheck="true">//1、回忆线程的创建：</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TestLamda</span> <span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token comment" spellcheck="true">//创建一个线程</span>        Task task <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Task</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        Thread th <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span>task<span class="token punctuation">)</span><span class="token punctuation">;</span>        th<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">class</span>  <span class="token class-name">Task</span> <span class="token keyword">implements</span> <span class="token class-name">Runnable</span><span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>Thread<span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">"线程启动"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token comment" spellcheck="true">//2、改造成内部类</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TestLamda</span> <span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">class</span>  <span class="token class-name">Task</span> <span class="token keyword">implements</span> <span class="token class-name">Runnable</span><span class="token punctuation">{</span>            <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>Thread<span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">"线程启动"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span>        <span class="token comment" spellcheck="true">//创建一个线程</span>        Task task <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Task</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        Thread th <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span>task<span class="token punctuation">)</span><span class="token punctuation">;</span>        th<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token comment" spellcheck="true">//3、匿名内部类</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TestLamda</span> <span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token comment" spellcheck="true">//创建一个线程</span>        Runnable task <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Runnable</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>Thread<span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">"线程启动"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span><span class="token punctuation">;</span>        Thread th <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span>task<span class="token punctuation">)</span><span class="token punctuation">;</span>        th<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token comment" spellcheck="true">//4、lamda表达式</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TestLamda</span> <span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token comment" spellcheck="true">//创建一个线程</span>        Runnable task <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">></span>System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>Thread<span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">"线程启动"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        Thread th <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span>task<span class="token punctuation">)</span><span class="token punctuation">;</span>        th<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span></code></pre><h3 id="2-lamda表达式的各种写法"><a href="#2-lamda表达式的各种写法" class="headerlink" title="2 lamda表达式的各种写法"></a>2 lamda表达式的各种写法</h3><pre class=" language-java"><code class="language-java">无参无返回的lamda表达式的写法<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Test</span> <span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>        ITest it <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">></span>System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"test"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        it<span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">interface</span> <span class="token class-name">ITest</span><span class="token punctuation">{</span>    <span class="token keyword">void</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span> 带参无返回的写法：    一个参数：<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Test</span> <span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>        ITest it <span class="token operator">=</span> x<span class="token operator">-</span><span class="token operator">></span>System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"test"</span><span class="token operator">+</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span>        it<span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">interface</span> <span class="token class-name">ITest</span><span class="token punctuation">{</span>    <span class="token keyword">void</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token keyword">int</span> x<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span>          多个参数：<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Test</span> <span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>        ITest it <span class="token operator">=</span> <span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">,</span>z<span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">></span>System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"test"</span><span class="token operator">+</span><span class="token punctuation">(</span>x<span class="token operator">+</span>y<span class="token operator">+</span>z<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        it<span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">interface</span> <span class="token class-name">ITest</span><span class="token punctuation">{</span>    <span class="token keyword">void</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token keyword">int</span> x<span class="token punctuation">,</span><span class="token keyword">int</span> y<span class="token punctuation">,</span><span class="token keyword">int</span> z<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span>  返回值：<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Test</span> <span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>        ITest it <span class="token operator">=</span> <span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">,</span>z<span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">></span><span class="token punctuation">{</span>            <span class="token keyword">double</span> res <span class="token operator">=</span> x<span class="token operator">+</span>y<span class="token operator">+</span>z<span class="token punctuation">;</span>            <span class="token keyword">return</span> res<span class="token punctuation">;</span>        <span class="token punctuation">}</span><span class="token punctuation">;</span>        <span class="token keyword">double</span> res <span class="token operator">=</span> it<span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">interface</span> <span class="token class-name">ITest</span><span class="token punctuation">{</span>    <span class="token keyword">double</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token keyword">int</span> x<span class="token punctuation">,</span><span class="token keyword">double</span> y<span class="token punctuation">,</span><span class="token keyword">int</span> z<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span> 如果有返回并且也只有一行代码也可以省略大括号：<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Test</span> <span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>        ITest it <span class="token operator">=</span> <span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">,</span>z<span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">></span>x<span class="token operator">+</span>y<span class="token operator">+</span>z<span class="token punctuation">;</span>        <span class="token keyword">double</span> res <span class="token operator">=</span> it<span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">interface</span> <span class="token class-name">ITest</span><span class="token punctuation">{</span>    <span class="token keyword">double</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token keyword">int</span> x<span class="token punctuation">,</span><span class="token keyword">double</span> y<span class="token punctuation">,</span><span class="token keyword">int</span> z<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span>    </code></pre><h3 id="3-函数式接口"><a href="#3-函数式接口" class="headerlink" title="3 函数式接口"></a>3 函数式接口</h3><pre class=" language-java"><code class="language-java">函数式接口：    一个接口中只有一个必须被重写的方法，这样的接口叫函数式接口。<span class="token comment" spellcheck="true">//不是只有一个抽象方法</span>    函数式接口才能使用lamda表达式。    <span class="token annotation punctuation">@FunctionalInterface</span>    <span class="token annotation punctuation">@FunctionalInterface</span><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">Comparator</span><span class="token operator">&lt;</span>T<span class="token operator">></span> <span class="token punctuation">{</span>    <span class="token keyword">int</span> <span class="token function">compare</span><span class="token punctuation">(</span>T o1<span class="token punctuation">,</span> T o2<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">boolean</span> <span class="token function">equals</span><span class="token punctuation">(</span>Object obj<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//Object类里有一个默认实现</span><span class="token punctuation">}</span><span class="token comment" spellcheck="true">//java默认提供了几种函数型接口--消费型，供给型，函数型，断言型</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TestFunction</span> <span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token comment" spellcheck="true">//消费型接口</span>        <span class="token comment" spellcheck="true">//Consumer&lt;String> c = x->System.out.println(x);</span>        Consumer<span class="token operator">&lt;</span>String<span class="token operator">></span> c <span class="token operator">=</span> System<span class="token punctuation">.</span>out<span class="token operator">:</span><span class="token operator">:</span>println<span class="token punctuation">;</span>        c<span class="token punctuation">.</span><span class="token function">accept</span><span class="token punctuation">(</span><span class="token string">"字符串"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">//供给型</span>        <span class="token comment" spellcheck="true">//生成一个随机数</span>        Supplier<span class="token operator">&lt;</span>Integer<span class="token operator">></span> s <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">></span><span class="token keyword">new</span> <span class="token class-name">Random</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">//供给一个学生</span>        <span class="token comment" spellcheck="true">//Supplier&lt;Student> sps = ()->new Student();</span>        Supplier<span class="token operator">&lt;</span>Student<span class="token operator">></span> sps <span class="token operator">=</span> Student<span class="token operator">:</span><span class="token operator">:</span><span class="token keyword">new</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//注意调无参</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>sps<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">//函数型--入参，出参</span>        <span class="token comment" spellcheck="true">//把一个学生转为他的名字</span>        <span class="token comment" spellcheck="true">//Function&lt;Student, String> f = stu->stu.getName();</span>        Function<span class="token operator">&lt;</span>Student<span class="token punctuation">,</span> Integer<span class="token operator">></span> f <span class="token operator">=</span> Student<span class="token operator">:</span><span class="token operator">:</span>getSalary<span class="token punctuation">;</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>f<span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Student</span><span class="token punctuation">(</span><span class="token string">"哈哈"</span><span class="token punctuation">,</span><span class="token number">20</span><span class="token punctuation">,</span><span class="token number">9000</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">//断言型接口</span>        <span class="token comment" spellcheck="true">//断言密码在6-10位</span>        Predicate<span class="token operator">&lt;</span>String<span class="token operator">></span> p <span class="token operator">=</span> pwd<span class="token operator">-</span><span class="token operator">></span>pwd<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">>=</span><span class="token number">6</span><span class="token operator">&amp;&amp;</span>pwd<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;=</span><span class="token number">10</span><span class="token punctuation">;</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>p<span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span><span class="token string">"88888"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span></code></pre><h3 id="4-流-Stream"><a href="#4-流-Stream" class="headerlink" title="4 流-Stream"></a>4 流-Stream</h3><h4 id="4-1-流的产生"><a href="#4-1-流的产生" class="headerlink" title="4.1 流的产生"></a>4.1 流的产生</h4><pre class=" language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TestGenerat</span> <span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token comment" spellcheck="true">//使用工具类生成流</span>        <span class="token comment" spellcheck="true">//这个是生成你给我的数据的流</span>        IntStream<span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>n<span class="token operator">-</span><span class="token operator">></span>System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span>n<span class="token operator">+</span><span class="token string">" "</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">//这个是生成一个范围</span>        IntStream<span class="token punctuation">.</span><span class="token function">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>n<span class="token operator">-</span><span class="token operator">></span>System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span>n<span class="token operator">+</span><span class="token string">" "</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">//这个是生成一个范围并且包含最后一个数字</span>        IntStream<span class="token punctuation">.</span><span class="token function">rangeClosed</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>n<span class="token operator">-</span><span class="token operator">></span>System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span>n<span class="token operator">+</span><span class="token string">" "</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span>通过集合去生成流<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>        List<span class="token operator">&lt;</span>Student<span class="token operator">></span> stus <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token operator">&lt;</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">init</span><span class="token punctuation">(</span>stus<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">//使用集合来生成流--stream单线程   parallelStream是多线程</span>        stus<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>System<span class="token punctuation">.</span>out<span class="token operator">:</span><span class="token operator">:</span>println<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><h4 id="4-2-流的中间操作"><a href="#4-2-流的中间操作" class="headerlink" title="4.2 流的中间操作"></a>4.2 流的中间操作</h4><pre class=" language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TestMid</span> <span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>        List<span class="token operator">&lt;</span>Student<span class="token operator">></span> stus <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token operator">&lt;</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">init</span><span class="token punctuation">(</span>stus<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">// 使用集合来生成流--stream单线程 parallelStream是多线程</span>        <span class="token comment" spellcheck="true">/*         * stus .stream()//生成流          .filter(stu->stu.getAge()>25)//根据条件过滤 .skip(1)//跳过几个元素         * .limit(7)//限制几个元素          .distinct()//去重         * .forEach(System.out::println);//终止操作---输出每个元素看一下         */</span><span class="token comment" spellcheck="true">//stus.stream().sorted(new Comparator&lt;Student>() {</span><span class="token comment" spellcheck="true">//@Override</span><span class="token comment" spellcheck="true">//public int compare(Student o1, Student o2) {</span><span class="token comment" spellcheck="true">//if(o1.getAge()-o2.getAge()!=0) {</span><span class="token comment" spellcheck="true">//return o1.getAge()-o2.getAge();</span><span class="token comment" spellcheck="true">//}else if(o1.getSalary()-o2.getSalary()!=0) {</span><span class="token comment" spellcheck="true">//return o1.getSalary()-o2.getSalary();</span><span class="token comment" spellcheck="true">//}</span><span class="token comment" spellcheck="true">//return o1.hashCode()-o2.hashCode();</span><span class="token comment" spellcheck="true">//}</span><span class="token comment" spellcheck="true">//}).forEach(System.out::println);</span>        stus<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">sorted</span><span class="token punctuation">(</span><span class="token punctuation">(</span>o1<span class="token punctuation">,</span> o2<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token punctuation">{</span>            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"执行排序"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//延迟执行</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>o1<span class="token punctuation">.</span><span class="token function">getAge</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> o2<span class="token punctuation">.</span><span class="token function">getAge</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                <span class="token keyword">return</span> o1<span class="token punctuation">.</span><span class="token function">getAge</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> o2<span class="token punctuation">.</span><span class="token function">getAge</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>o1<span class="token punctuation">.</span><span class="token function">getSalary</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> o2<span class="token punctuation">.</span><span class="token function">getSalary</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                <span class="token keyword">return</span> o1<span class="token punctuation">.</span><span class="token function">getSalary</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> o2<span class="token punctuation">.</span><span class="token function">getSalary</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>            <span class="token keyword">return</span> o1<span class="token punctuation">.</span><span class="token function">hashCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> o2<span class="token punctuation">.</span><span class="token function">hashCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">//排序</span>        <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>Student<span class="token operator">:</span><span class="token operator">:</span>getName<span class="token punctuation">)</span><span class="token comment" spellcheck="true">//映射</span>        <span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>System<span class="token punctuation">.</span>out<span class="token operator">:</span><span class="token operator">:</span>println<span class="token punctuation">)</span><span class="token punctuation">;</span>       System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"over"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">init</span><span class="token punctuation">(</span>List<span class="token operator">&lt;</span>Student<span class="token operator">></span> stus<span class="token punctuation">)</span> <span class="token punctuation">{</span>        stus<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Student</span><span class="token punctuation">(</span><span class="token string">"张三丰"</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">6000</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        stus<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Student</span><span class="token punctuation">(</span><span class="token string">"宋远桥"</span><span class="token punctuation">,</span> <span class="token number">26</span><span class="token punctuation">,</span> <span class="token number">7000</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        stus<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Student</span><span class="token punctuation">(</span><span class="token string">"俞莲舟"</span><span class="token punctuation">,</span> <span class="token number">26</span><span class="token punctuation">,</span> <span class="token number">5000</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        stus<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Student</span><span class="token punctuation">(</span><span class="token string">"张松溪"</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">,</span> <span class="token number">3000</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        stus<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Student</span><span class="token punctuation">(</span><span class="token string">"张翠山"</span><span class="token punctuation">,</span> <span class="token number">27</span><span class="token punctuation">,</span> <span class="token number">4000</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        stus<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Student</span><span class="token punctuation">(</span><span class="token string">"俞岱岩"</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">,</span> <span class="token number">6000</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        stus<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Student</span><span class="token punctuation">(</span><span class="token string">"莫声谷"</span><span class="token punctuation">,</span> <span class="token number">26</span><span class="token punctuation">,</span> <span class="token number">5500</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        stus<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Student</span><span class="token punctuation">(</span><span class="token string">"逍遥王"</span><span class="token punctuation">,</span> <span class="token number">26</span><span class="token punctuation">,</span> <span class="token number">6200</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        Student s <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Student</span><span class="token punctuation">(</span><span class="token string">"张天宝"</span><span class="token punctuation">,</span> <span class="token number">26</span><span class="token punctuation">,</span> <span class="token number">6300</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        stus<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span>        stus<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span></code></pre><h4 id="4-3-流的终止操作"><a href="#4-3-流的终止操作" class="headerlink" title="4.3 流的终止操作"></a>4.3 流的终止操作</h4><pre class=" language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TestEnd</span> <span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>        List<span class="token operator">&lt;</span>Student<span class="token operator">></span> stus <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token operator">&lt;</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">init</span><span class="token punctuation">(</span>stus<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">//stus.stream().forEach(System.out::println);</span>        <span class="token comment" spellcheck="true">//薪资最少的人</span>        <span class="token comment" spellcheck="true">//Optional&lt;Student> min = stus.stream().min((s1,s2)->s1.getSalary()-s2.getSalary());</span>        <span class="token comment" spellcheck="true">//System.out.println(min.get());//最小薪资的人</span>        <span class="token comment" spellcheck="true">//求流的个数</span>        <span class="token comment" spellcheck="true">//long count = stus.stream().count();</span>        <span class="token comment" spellcheck="true">//System.out.println(count);</span>        <span class="token comment" spellcheck="true">//求所有人的薪资的总和</span>        <span class="token comment" spellcheck="true">//Optional&lt;Integer> sum = stus.stream().map(Student::getSalary).reduce((a,b)->a+b);//数据减少的规则</span>        <span class="token comment" spellcheck="true">//System.out.println(sum.get());</span>        <span class="token comment" spellcheck="true">//练习：用流来运算1-10000的和---多线程---测一下计算时间</span>        <span class="token comment" spellcheck="true">//一个流转变为另外的集合</span>        List<span class="token operator">&lt;</span>String<span class="token operator">></span> names <span class="token operator">=</span> stus<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>Student<span class="token operator">:</span><span class="token operator">:</span>getName<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span>Collectors<span class="token punctuation">.</span><span class="token function">toList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>names<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">init</span><span class="token punctuation">(</span>List<span class="token operator">&lt;</span>Student<span class="token operator">></span> stus<span class="token punctuation">)</span> <span class="token punctuation">{</span>        stus<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Student</span><span class="token punctuation">(</span><span class="token string">"张三丰"</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">6000</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        stus<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Student</span><span class="token punctuation">(</span><span class="token string">"宋远桥"</span><span class="token punctuation">,</span> <span class="token number">26</span><span class="token punctuation">,</span> <span class="token number">7000</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        stus<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Student</span><span class="token punctuation">(</span><span class="token string">"俞莲舟"</span><span class="token punctuation">,</span> <span class="token number">26</span><span class="token punctuation">,</span> <span class="token number">5000</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        stus<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Student</span><span class="token punctuation">(</span><span class="token string">"张松溪"</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">,</span> <span class="token number">3000</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        stus<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Student</span><span class="token punctuation">(</span><span class="token string">"张翠山"</span><span class="token punctuation">,</span> <span class="token number">27</span><span class="token punctuation">,</span> <span class="token number">4000</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        stus<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Student</span><span class="token punctuation">(</span><span class="token string">"俞岱岩"</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">,</span> <span class="token number">6000</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        stus<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Student</span><span class="token punctuation">(</span><span class="token string">"莫声谷"</span><span class="token punctuation">,</span> <span class="token number">26</span><span class="token punctuation">,</span> <span class="token number">5500</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        stus<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Student</span><span class="token punctuation">(</span><span class="token string">"逍遥王"</span><span class="token punctuation">,</span> <span class="token number">26</span><span class="token punctuation">,</span> <span class="token number">6200</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        Student s <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Student</span><span class="token punctuation">(</span><span class="token string">"张天宝"</span><span class="token punctuation">,</span> <span class="token number">26</span><span class="token punctuation">,</span> <span class="token number">6300</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        stus<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span>        stus<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span></code></pre>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>反射+注解</title>
      <link href="/2022/11/25/fan-she-zhu-jie/"/>
      <url>/2022/11/25/fan-she-zhu-jie/</url>
      
        <content type="html"><![CDATA[<h1 id="反射-注解"><a href="#反射-注解" class="headerlink" title="反射+注解"></a>反射+注解</h1><h3 id="1-1-类的生命周期"><a href="#1-1-类的生命周期" class="headerlink" title="1.1 类的生命周期"></a>1.1 类的生命周期</h3><p>一个类由生到死的过程</p><p>加载，链接，初始化，使用，卸载</p><p>类的加载机制：</p><p>双亲委派–沙箱安全机制</p><p>全盘委托</p><p>java中的类是由类加载器完成加载的—–Util.class.getClassLoader().getResourceAsStream()</p><h3 id="1-2-类对象"><a href="#1-2-类对象" class="headerlink" title="1.2 类对象"></a>1.2 类对象</h3><p>万物皆对象，类是不是对象？是—–类对象—class文件</p><p>注意：类对象和类的对象的区别</p><p>Student  s = new Student()；//类的对象</p><p>Student.class,</p><p>s.getClass(),</p><p>类对象，类对象只有一份。</p><p>三种获取类对象的方案：</p><pre class=" language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Test</span> <span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> Exception <span class="token punctuation">{</span>        <span class="token comment" spellcheck="true">//三种方案获取类对象</span>        <span class="token comment" spellcheck="true">//通过类名.class</span>        Class<span class="token operator">&lt;</span><span class="token operator">?</span><span class="token operator">></span> clazz <span class="token operator">=</span> Student<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">//System.out.println(clazz);</span>        <span class="token comment" spellcheck="true">//通过对象.getClass()</span>        Student s <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Student</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        Class<span class="token operator">&lt;</span><span class="token operator">?</span><span class="token operator">></span> clazz1 <span class="token operator">=</span> s<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>clazz1<span class="token operator">==</span>clazz<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">//反射的方案</span>        Class<span class="token operator">&lt;</span><span class="token operator">?</span><span class="token operator">></span> clazz2 <span class="token operator">=</span> Class<span class="token punctuation">.</span><span class="token function">forName</span><span class="token punctuation">(</span><span class="token string">"com.qf.day26.reflect.Student"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>clazz<span class="token operator">==</span>clazz2<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span></code></pre><h3 id="1-3-反射分析构造函数"><a href="#1-3-反射分析构造函数" class="headerlink" title="1.3 反射分析构造函数"></a>1.3 反射分析构造函数</h3><pre class=" language-java"><code class="language-java">clazz<span class="token punctuation">.</span><span class="token function">getConstructor</span><span class="token punctuation">(</span>参数<span class="token punctuation">)</span>：    这个方法只能获取公有的构造，不是公有的就获取不到。clazz<span class="token punctuation">.</span><span class="token function">getDeclaredConstructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    这个方法就能获取私有的构造    私有构造不能直接创建对象，需要调用：    dc<span class="token punctuation">.</span><span class="token function">setAccessible</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>打破封装<span class="token function">newInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span>方法去获取这个构造的实例clazz<span class="token punctuation">.</span><span class="token function">getDeclaredConstructors</span><span class="token punctuation">(</span><span class="token punctuation">)</span>：    获取到所有的构造函数    分析构造函数的访问修饰符    dc<span class="token punctuation">.</span><span class="token function">getModifiers</span><span class="token punctuation">(</span><span class="token punctuation">)</span>：返回的是一个<span class="token keyword">int</span>类型的值  <span class="token operator">--</span><span class="token number">22</span>  <span class="token number">1111</span>   <span class="token number">10110</span>       <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span>   <span class="token operator">--</span><span class="token operator">-</span>  值  <span class="token number">16</span><span class="token operator">+</span><span class="token number">8</span><span class="token operator">+</span><span class="token number">1</span> <span class="token operator">=</span> <span class="token number">25</span>     <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> PUBLIC <span class="token operator">=</span> <span class="token number">0x00000001</span><span class="token punctuation">;</span>  <span class="token number">00000000000000000000000001</span>     <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> PRIVATE <span class="token operator">=</span> <span class="token number">0x00000002</span><span class="token punctuation">;</span> <span class="token number">00000000000000000000000010</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> PROTECTED <span class="token operator">=</span> <span class="token number">0x00000004</span><span class="token punctuation">;</span><span class="token number">00000000000000000000000100</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> STATIC <span class="token operator">=</span> <span class="token number">0x00000008</span><span class="token punctuation">;</span>   <span class="token number">00000000000000000000001000</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> FINAL  <span class="token operator">=</span> <span class="token number">0x00000010</span><span class="token punctuation">;</span>   <span class="token number">00000000000000000000010000</span>  <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> SYNCHRONIZED<span class="token operator">=</span><span class="token number">0x00000020</span><span class="token punctuation">;</span> <span class="token number">00000000000000000000100000</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> VOLATILE         <span class="token operator">=</span> <span class="token number">0x00000040</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> TRANSIENT        <span class="token operator">=</span> <span class="token number">0x00000080</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> NATIVE           <span class="token operator">=</span> <span class="token number">0x00000100</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> INTERFACE        <span class="token operator">=</span> <span class="token number">0x00000200</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> ABSTRACT         <span class="token operator">=</span> <span class="token number">0x00000400</span><span class="token punctuation">;</span>       <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> STRICT           <span class="token operator">=</span> <span class="token number">0x00000800</span><span class="token punctuation">;</span>mod<span class="token operator">:</span><span class="token number">11</span>    <span class="token number">00000000000000000000001011</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>mod <span class="token operator">&amp;</span> PUBLIC<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>        sb<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">"public "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>mod <span class="token operator">&amp;</span> PROTECTED<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>     sb<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">"protected "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>mod <span class="token operator">&amp;</span> PRIVATE<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>       sb<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">"private "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">/* Canonical order */</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>mod <span class="token operator">&amp;</span> ABSTRACT<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>      sb<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">"abstract "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>mod <span class="token operator">&amp;</span> STATIC<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>        sb<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">"static "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>mod <span class="token operator">&amp;</span> FINAL<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>         sb<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">"final "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>mod <span class="token operator">&amp;</span> TRANSIENT<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>     sb<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">"transient "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>mod <span class="token operator">&amp;</span> VOLATILE<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>      sb<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">"volatile "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>mod <span class="token operator">&amp;</span> SYNCHRONIZED<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>  sb<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">"synchronized "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>mod <span class="token operator">&amp;</span> NATIVE<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>        sb<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">"native "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>mod <span class="token operator">&amp;</span> STRICT<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>        sb<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">"strictfp "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>mod <span class="token operator">&amp;</span> INTERFACE<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>     sb<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">"interface "</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 判断是否是私有的：    Modifier<span class="token punctuation">.</span><span class="token function">isPrivate</span><span class="token punctuation">(</span>c<span class="token punctuation">.</span><span class="token function">getModifiers</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>获取所有    Modifier<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span>mod<span class="token punctuation">)</span><span class="token punctuation">;</span>分析构造函数的参数<span class="token keyword">for</span><span class="token punctuation">(</span>Constructor<span class="token operator">&lt;</span><span class="token operator">?</span><span class="token operator">></span> c <span class="token operator">:</span> clazz<span class="token punctuation">.</span><span class="token function">getDeclaredConstructors</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//Parameter[] pts = c.getParameters();</span><span class="token comment" spellcheck="true">//for(Parameter p:pts) {</span><span class="token comment" spellcheck="true">//System.out.println("\t"+p.getType());//实际类型  ---List</span><span class="token comment" spellcheck="true">//}</span>            <span class="token comment" spellcheck="true">//获取构造的实际类型</span>            Type<span class="token punctuation">[</span><span class="token punctuation">]</span> gpts <span class="token operator">=</span> c<span class="token punctuation">.</span><span class="token function">getGenericParameterTypes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">for</span><span class="token punctuation">(</span>Type t<span class="token operator">:</span>gpts<span class="token punctuation">)</span> <span class="token punctuation">{</span>                <span class="token comment" spellcheck="true">//转为泛型参数的子类</span>                <span class="token keyword">if</span><span class="token punctuation">(</span>t <span class="token keyword">instanceof</span> <span class="token class-name">ParameterizedType</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                    ParameterizedType pt <span class="token operator">=</span> <span class="token punctuation">(</span>ParameterizedType<span class="token punctuation">)</span> t<span class="token punctuation">;</span>                    <span class="token comment" spellcheck="true">//泛型里面写的类型---返回的是数组System.out.println("\t"+Arrays.toString(pt.getActualTypeArguments()));</span>                <span class="token punctuation">}</span>                            <span class="token punctuation">}</span><span class="token punctuation">}</span>      练习：获取构造函数里面的参数及泛型化参数          </code></pre><h3 id="1-4-反射分析普通方法"><a href="#1-4-反射分析普通方法" class="headerlink" title="1.4 反射分析普通方法"></a>1.4 反射分析普通方法</h3><pre class=" language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TestMethod</span> <span class="token punctuation">{</span>        <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> Exception <span class="token punctuation">{</span>        Class<span class="token operator">&lt;</span><span class="token operator">?</span><span class="token operator">></span> clazz <span class="token operator">=</span> Class<span class="token punctuation">.</span><span class="token function">forName</span><span class="token punctuation">(</span><span class="token string">"com.qf.day26.reflect.User"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        User user <span class="token operator">=</span> <span class="token punctuation">(</span>User<span class="token punctuation">)</span> clazz<span class="token punctuation">.</span><span class="token function">newInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">//获取指定的方法</span>        Method m <span class="token operator">=</span> clazz<span class="token punctuation">.</span><span class="token function">getMethod</span><span class="token punctuation">(</span><span class="token string">"show"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">//System.out.println(m);</span>        <span class="token comment" spellcheck="true">//执行这个方法--调用这个方法 参数1是对象，参数2就是方法参数</span>        m<span class="token punctuation">.</span><span class="token function">invoke</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token comment" spellcheck="true">//调用私有的方法</span>        Method dm <span class="token operator">=</span> clazz<span class="token punctuation">.</span><span class="token function">getDeclaredMethod</span><span class="token punctuation">(</span><span class="token string">"test"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        dm<span class="token punctuation">.</span><span class="token function">setAccessible</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        dm<span class="token punctuation">.</span><span class="token function">invoke</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token comment" spellcheck="true">//调用带参带返回的方法</span>        Method m1 <span class="token operator">=</span> clazz<span class="token punctuation">.</span><span class="token function">getMethod</span><span class="token punctuation">(</span><span class="token string">"add"</span><span class="token punctuation">,</span><span class="token keyword">int</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span><span class="token keyword">int</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>m1<span class="token punctuation">.</span><span class="token function">getModifiers</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>Arrays<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span>m1<span class="token punctuation">.</span><span class="token function">getParameters</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> res <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span> m1<span class="token punctuation">.</span><span class="token function">invoke</span><span class="token punctuation">(</span>user<span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//调用方法并获得返回值</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token comment" spellcheck="true">//获取所有的方法</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"获取到User类中所有的方法有：------------------------------"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        Method<span class="token punctuation">[</span><span class="token punctuation">]</span> ms <span class="token operator">=</span> clazz<span class="token punctuation">.</span><span class="token function">getMethods</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//这个获取到是自己和父类所有的公有构造</span>        <span class="token keyword">for</span><span class="token punctuation">(</span>Method m0<span class="token operator">:</span>ms<span class="token punctuation">)</span> <span class="token punctuation">{</span>            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>m0<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token comment" spellcheck="true">//获取自己类的方法</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"获取到User自己类中所有的方法有：------------------------------"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        Method<span class="token punctuation">[</span><span class="token punctuation">]</span> dms <span class="token operator">=</span> clazz<span class="token punctuation">.</span><span class="token function">getDeclaredMethods</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//这个获取到是自己和父类所有的公有构造</span>        <span class="token keyword">for</span><span class="token punctuation">(</span>Method m0<span class="token operator">:</span>dms<span class="token punctuation">)</span> <span class="token punctuation">{</span>            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>m0<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span></code></pre><h3 id="1-5-分析属性"><a href="#1-5-分析属性" class="headerlink" title="1.5 分析属性"></a>1.5 分析属性</h3><pre class=" language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TestField</span> <span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> Exception <span class="token punctuation">{</span>        <span class="token comment" spellcheck="true">// 分析属性</span>        Class<span class="token operator">&lt;</span><span class="token operator">?</span><span class="token operator">></span> clazz <span class="token operator">=</span> Class<span class="token punctuation">.</span><span class="token function">forName</span><span class="token punctuation">(</span><span class="token string">"com.qf.day26.reflect.User"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        User user <span class="token operator">=</span> <span class="token punctuation">(</span>User<span class="token punctuation">)</span> clazz<span class="token punctuation">.</span><span class="token function">newInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">// 公有的属性</span>        Field field <span class="token operator">=</span> clazz<span class="token punctuation">.</span><span class="token function">getField</span><span class="token punctuation">(</span><span class="token string">"age"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>field<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">// 给这个属性赋值</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span><span class="token punctuation">;</span>        field<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>user<span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">// 私有的属性</span>        Field df <span class="token operator">=</span> clazz<span class="token punctuation">.</span><span class="token function">getDeclaredField</span><span class="token punctuation">(</span><span class="token string">"name"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>Modifier<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span><span class="token function">getModifiers</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//获取访问修饰符</span>        df<span class="token punctuation">.</span><span class="token function">setAccessible</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>field<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">// 给这个属性赋值</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span><span class="token punctuation">;</span>        df<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>user<span class="token punctuation">,</span> <span class="token string">"张三丰"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span>练习：    设计一个工具方法，把一个对象装换为json字符串    User user  <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">User</span><span class="token punctuation">(</span><span class="token string">"张三"</span><span class="token punctuation">,</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">--</span><span class="token operator">-</span><span class="token operator">></span><span class="token punctuation">{</span><span class="token string">"name"</span><span class="token operator">:</span><span class="token string">"张三"</span><span class="token punctuation">,</span><span class="token string">"age"</span><span class="token operator">:</span><span class="token string">"20"</span><span class="token punctuation">}</span>    Student s <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Student</span><span class="token punctuation">(</span><span class="token string">"李四"</span><span class="token punctuation">,</span><span class="token number">20</span><span class="token punctuation">,</span><span class="token number">99</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">--</span><span class="token operator">-</span><span class="token operator">></span><span class="token punctuation">{</span><span class="token string">"name"</span><span class="token operator">:</span><span class="token string">"张三"</span><span class="token punctuation">,</span><span class="token string">"age"</span><span class="token operator">:</span><span class="token string">"20"</span><span class="token punctuation">,</span><span class="token string">"score"</span><span class="token operator">:</span><span class="token string">"99"</span><span class="token punctuation">}</span>   反射的思想：   你只要传给我一个对象，我就能够获取到你这个对象的类型<span class="token operator">--</span><span class="token operator">-</span>模板，通过反射获取所有的属性和方法，属性值。<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">JsonUtil</span> <span class="token punctuation">{</span>    <span class="token comment" spellcheck="true">/*     *Student s = new Student("李四",20,99);      {"name":"张三","age":"20","score":"99"}     */</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> String <span class="token function">getJson</span><span class="token punctuation">(</span>Object obj<span class="token punctuation">)</span> <span class="token keyword">throws</span> Exception <span class="token punctuation">{</span>        String str <span class="token operator">=</span> <span class="token string">"{"</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">//通过反射获取到所有的属性名和属性值</span>        Class<span class="token operator">&lt;</span><span class="token operator">?</span><span class="token operator">></span> clazz <span class="token operator">=</span> obj<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">//获取所有的属性</span>        Field<span class="token punctuation">[</span><span class="token punctuation">]</span> dfs <span class="token operator">=</span> clazz<span class="token punctuation">.</span><span class="token function">getDeclaredFields</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>dfs<span class="token punctuation">.</span>length<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            Field f <span class="token operator">=</span> dfs<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>            f<span class="token punctuation">.</span><span class="token function">setAccessible</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//打开访问权限</span>            <span class="token comment" spellcheck="true">//获取属性名</span>            String fieldName <span class="token operator">=</span> f<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            str <span class="token operator">+=</span> <span class="token string">"\""</span><span class="token operator">+</span>fieldName<span class="token operator">+</span><span class="token string">"\":\""</span><span class="token operator">+</span>f<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">"\""</span><span class="token punctuation">;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>i<span class="token operator">!=</span>dfs<span class="token punctuation">.</span>length<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                str<span class="token operator">+=</span><span class="token string">","</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span>        str <span class="token operator">+=</span> <span class="token string">"}"</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> str<span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span>第二个练习：    设计与实现分离 <span class="token comment" spellcheck="true">/* * 抽象父类 */</span><span class="token keyword">public</span> <span class="token keyword">abstract</span> <span class="token keyword">class</span> <span class="token class-name">DataSource</span> <span class="token punctuation">{</span>        <span class="token keyword">public</span> <span class="token keyword">abstract</span> <span class="token keyword">void</span> <span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//数据源都有一个获取连接的方法</span><span class="token punctuation">}</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DruidDataSource</span> <span class="token keyword">extends</span> <span class="token class-name">DataSource</span> <span class="token punctuation">{</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"获取到德鲁伊数据源"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">C3P0DataSource</span> <span class="token keyword">extends</span> <span class="token class-name">DataSource</span> <span class="token punctuation">{</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"获取到c3p0数据源"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Test</span> <span class="token punctuation">{</span>        <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> Exception <span class="token punctuation">{</span>        <span class="token comment" spellcheck="true">//多态---手动切换数据源---坏处</span>        <span class="token comment" spellcheck="true">//缺点：1、要重启应用才能生效</span>        <span class="token comment" spellcheck="true">//      2、交付的程序已经没有java，.class 文件修改不方便</span>        <span class="token comment" spellcheck="true">//      3、即便我交付的是java文件，对方的运维人员不懂java,不知道到哪儿改</span>        <span class="token comment" spellcheck="true">//解决方案：使用反射+配置文件来改造----反射可以通过字符串来创建对象</span>        <span class="token comment" spellcheck="true">//DataSource ds = new C3P0DataSource();</span>        <span class="token comment" spellcheck="true">//读取配置文件</span>        Properties prop <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Properties</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//读配置文件的一个类</span>        <span class="token comment" spellcheck="true">//获取配置文件的流</span>        InputStream is <span class="token operator">=</span> Test<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">.</span><span class="token function">getClassLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getResourceAsStream</span><span class="token punctuation">(</span><span class="token string">"ds.properties"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">//加载文件</span>        prop<span class="token punctuation">.</span><span class="token function">load</span><span class="token punctuation">(</span>is<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">//获取到用户配置的数据源</span>        String dsProp <span class="token operator">=</span> prop<span class="token punctuation">.</span><span class="token function">getProperty</span><span class="token punctuation">(</span><span class="token string">"ds"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        String className <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>dsProp<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token string">"druid"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            className <span class="token operator">=</span> <span class="token string">"com.qf.day26.ds.DruidDataSource"</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>dsProp<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token string">"c3p0"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            className <span class="token operator">=</span> <span class="token string">"com.qf.day26.ds.C3P0DataSource"</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token punctuation">{</span>            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">RuntimeException</span><span class="token punctuation">(</span><span class="token string">"数据源配置有误"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token comment" spellcheck="true">//创建数据源</span>        Class<span class="token operator">&lt;</span><span class="token operator">?</span><span class="token operator">></span> clazz <span class="token operator">=</span> Class<span class="token punctuation">.</span><span class="token function">forName</span><span class="token punctuation">(</span>className<span class="token punctuation">)</span><span class="token punctuation">;</span>        DataSource ds <span class="token operator">=</span> <span class="token punctuation">(</span>DataSource<span class="token punctuation">)</span> clazz<span class="token punctuation">.</span><span class="token function">newInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        ds<span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span>ds<span class="token punctuation">.</span>properties<span class="token operator">:</span>   ds <span class="token operator">=</span> c3p0</code></pre><h3 id="1-6-反射操作数组"><a href="#1-6-反射操作数组" class="headerlink" title="1.6 反射操作数组"></a>1.6 反射操作数组</h3><pre class=" language-java"><code class="language-java"><span class="token comment" spellcheck="true">/* * 数组的万能扩展 */</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ArrayUtil</span> <span class="token punctuation">{</span>    <span class="token comment" spellcheck="true">/**     *      * @param array  --需要扩容的数组     * @param length  --新长度     * @return 扩容后的数组     */</span>    <span class="token keyword">public</span> <span class="token keyword">static</span><span class="token operator">&lt;</span>T<span class="token operator">></span> T <span class="token function">copyArray</span><span class="token punctuation">(</span>T array<span class="token punctuation">,</span><span class="token keyword">int</span> length<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token comment" spellcheck="true">//思路是先获取到数组的类型</span>        Class<span class="token operator">&lt;</span><span class="token operator">?</span><span class="token operator">></span> clazz <span class="token operator">=</span> array<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">//获取数组中元素的类型</span>        Class<span class="token operator">&lt;</span><span class="token operator">?</span><span class="token operator">></span> ct <span class="token operator">=</span> clazz<span class="token punctuation">.</span><span class="token function">getComponentType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">//创建新数组</span>        T t <span class="token operator">=</span> <span class="token punctuation">(</span>T<span class="token punctuation">)</span> Array<span class="token punctuation">.</span><span class="token function">newInstance</span><span class="token punctuation">(</span>ct<span class="token punctuation">,</span> length<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">//使用循环把array中的元素copy到t这个数组中</span>        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>Array<span class="token punctuation">.</span><span class="token function">getLength</span><span class="token punctuation">(</span>array<span class="token punctuation">)</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            Array<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>t<span class="token punctuation">,</span> i<span class="token punctuation">,</span> Array<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>array<span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token keyword">return</span> t<span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span>反射的难度在于类变为一个抽象的概念，我们写反射的时候可能存在操作不同类的情况，但是得到我们想要的结果</code></pre><h3 id="1-7、反射异常总结"><a href="#1-7、反射异常总结" class="headerlink" title="1.7、反射异常总结"></a>1.7、反射异常总结</h3><pre class=" language-java"><code class="language-java"><span class="token number">1</span>、ClassNotFoundException<span class="token operator">:</span>找不到类的异常<span class="token operator">--</span>类的完全限定名写错了<span class="token number">2</span>、NoSuchMethodException<span class="token operator">:</span>没有这个方法<span class="token number">3</span>、IllegalAccessException：非法访问异常<span class="token operator">--</span>打破封装<span class="token number">4</span>、IllegalArgumentException：非法参数<span class="token operator">--</span>我要的参数和你传递的参数不一致<span class="token number">5</span>、ClassCastException<span class="token operator">:</span>类型转换异常</code></pre><h2 id="2、注解-Anno"><a href="#2、注解-Anno" class="headerlink" title="2、注解-Anno"></a>2、注解-Anno</h2><pre class=" language-java"><code class="language-java"><span class="token keyword">class</span>  <span class="token class-name">interface</span>   <span class="token keyword">enum</span>   @<span class="token keyword">interface</span>先会用注解    <span class="token annotation punctuation">@SuppressWarnings</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token string">"rawtypes"</span><span class="token punctuation">,</span> <span class="token string">"unused"</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>    作用：镇压警告    <span class="token annotation punctuation">@Override</span>    检查重写注解的语法：    访问修饰符  @<span class="token keyword">interface</span> 注解名<span class="token punctuation">{</span><span class="token punctuation">}</span>理解为什么要用注解，注解能够干什么    注解是程序员和架构师沟通的桥梁<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>配置文件也是    配置<span class="token operator">--</span><span class="token operator">--</span>》注解<span class="token operator">+</span>配置<span class="token operator">--</span><span class="token operator">--</span>》注解（去配置文件） 思考：    注解应该由谁定义？       架构师<span class="token operator">--</span><span class="token operator">--</span>设计框架的人    注解谁来使用？       程序员解决两个事：    定义什么注解，别人怎么用这个注解表达程序员的想法       <span class="token number">1</span>、我们定义的注解能在哪里写？            元注解<span class="token operator">--</span><span class="token operator">--</span>在注解上面写的注解            <span class="token annotation punctuation">@Target</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token operator">:</span>指定注解能够使用的位置       <span class="token number">2</span>、写什么？          注解中通过属性定义该写什么<span class="token annotation punctuation">@Target</span><span class="token punctuation">(</span>ElementType<span class="token punctuation">.</span>TYPE<span class="token punctuation">)</span><span class="token keyword">public</span> @<span class="token keyword">interface</span> <span class="token class-name">Ds</span> <span class="token punctuation">{</span>    String <span class="token function">className</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//这个字符串属性规定了你必须配置数据源的路径</span><span class="token punctuation">}</span>       <span class="token number">3</span>、指定注解存活的时间<span class="token operator">--</span><span class="token operator">-</span>默认是类文件        <span class="token annotation punctuation">@Retention</span><span class="token punctuation">(</span>value<span class="token operator">=</span>RetentionPolicy<span class="token punctuation">.</span>RUNTIME<span class="token punctuation">)</span>                       SOURCE<span class="token operator">:</span>只保留到源文件            CLASS：保留到字节码文件            RUNTIME：保留到运行时注意：如果属性名是<span class="token function">value</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>则可以省略这个名字，如果不是，这个名字就不能省略    我怎么获取到程序员的注解          Ds annotation <span class="token operator">=</span> Config<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">.</span><span class="token function">getAnnotation</span><span class="token punctuation">(</span>Ds<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        Class<span class="token operator">&lt;</span><span class="token operator">?</span><span class="token operator">></span> clazz <span class="token operator">=</span> Class<span class="token punctuation">.</span><span class="token function">forName</span><span class="token punctuation">(</span>annotation<span class="token punctuation">.</span><span class="token function">className</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>           </code></pre><p>使用注解完成数据源的切换：</p><pre class=" language-java"><code class="language-java"><span class="token number">1</span>、设计注解<span class="token annotation punctuation">@Target</span><span class="token punctuation">(</span>value<span class="token operator">=</span>ElementType<span class="token punctuation">.</span>TYPE<span class="token punctuation">)</span><span class="token annotation punctuation">@Retention</span><span class="token punctuation">(</span>RetentionPolicy<span class="token punctuation">.</span>RUNTIME<span class="token punctuation">)</span><span class="token keyword">public</span> @<span class="token keyword">interface</span> <span class="token class-name">Ds</span> <span class="token punctuation">{</span> String <span class="token function">className</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//default "";//这个字符串属性规定了你必须配置数据源的路径</span><span class="token punctuation">}</span><span class="token number">2</span>、设计配置类<span class="token operator">--</span><span class="token operator">-</span>要求程序员在这个类上写注解，因为我的程序只在这个类上读取注解<span class="token annotation punctuation">@Ds</span><span class="token punctuation">(</span>className<span class="token operator">=</span><span class="token string">"com.qf.day27.ds.MyDataSource"</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">//替代了配置文件</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Config</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token number">3</span>、设计接口和主方法 <span class="token comment" spellcheck="true">/* * 抽象父类---框架的设计者不实现 */</span><span class="token keyword">public</span> <span class="token keyword">abstract</span> <span class="token keyword">class</span> <span class="token class-name">DataSource</span> <span class="token punctuation">{</span> <span class="token keyword">public</span> <span class="token keyword">abstract</span> <span class="token keyword">void</span> <span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//数据源都有一个获取连接的方法</span><span class="token punctuation">}</span>   <span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Test</span> <span class="token punctuation">{</span> <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> Exception <span class="token punctuation">{</span>     Ds annotation <span class="token operator">=</span> Config<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">.</span><span class="token function">getAnnotation</span><span class="token punctuation">(</span>Ds<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     Class<span class="token operator">&lt;</span><span class="token operator">?</span><span class="token operator">></span> clazz <span class="token operator">=</span> Class<span class="token punctuation">.</span><span class="token function">forName</span><span class="token punctuation">(</span>annotation<span class="token punctuation">.</span><span class="token function">className</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     DataSource ds <span class="token operator">=</span> <span class="token punctuation">(</span>DataSource<span class="token punctuation">)</span> clazz<span class="token punctuation">.</span><span class="token function">newInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     ds<span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token number">4</span>、程序编写子类并且在Config这个类上注解上信息<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyDataSource</span>  <span class="token keyword">extends</span> <span class="token class-name">DataSource</span> <span class="token punctuation">{</span> <span class="token annotation punctuation">@Override</span> <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>     System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"myconnection"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">}</span>     </code></pre>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>IO流</title>
      <link href="/2022/11/23/io-liu/"/>
      <url>/2022/11/23/io-liu/</url>
      
        <content type="html"><![CDATA[<h1 id="IO流"><a href="#IO流" class="headerlink" title="IO流"></a>IO流</h1><h2 id="1、File类"><a href="#1、File类" class="headerlink" title="1、File类"></a>1、File类</h2><pre class=" language-java"><code class="language-java">万物皆对象，文件也是对象，要操作文件，File来实现文件操作。    File是对整个文件的操作，如果要操作内容，需要IO流。File<span class="token operator">:</span>   操作文件：   File file <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span><span class="token string">"D:\\1000phone\\2212\\01-生产者消费者问题.mp4"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">//File file = new File("a.txt");</span>        <span class="token comment" spellcheck="true">/*boolean flag = file.createNewFile();//创建一个文件--有文件就不创建        //注意创建文件的时候不能够文件夹不存在        System.out.println(flag);//是不是创建了一个新文件        System.out.println(file.exists());//检查文件是否存在        System.out.println(file.canRead());//是否可读        System.out.println(file.canWrite());//是否可写        System.out.println(file.delete());//删除文件        System.out.println(file.getAbsolutePath());//绝对路径        System.out.println(file.getPath());//获取相对路径        System.out.println(file.getName());//获取文件名        System.out.println(file.length()/1024/1024+"M");//字节数*/</span>          操作文件夹：       <span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TestDir</span> <span class="token punctuation">{</span>        <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> Exception <span class="token punctuation">{</span>        File file <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span><span class="token string">"d:/a/b"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">//file.mkdirs();//创建文件夹,如果是多级目录必须用mkdirs</span>        <span class="token comment" spellcheck="true">//System.out.println(file.exists());//文件夹是否存在</span>        <span class="token comment" spellcheck="true">//System.out.println(file.isDirectory());//是否是文件夹</span>        <span class="token comment" spellcheck="true">//System.out.println(file.isFile());//是否是文件</span>        <span class="token comment" spellcheck="true">//file.createNewFile();</span>        <span class="token comment" spellcheck="true">//file.delete();//删除文件夹的时候只能删除空文件夹</span>        <span class="token comment" spellcheck="true">//查找子文件夹和子文件---可以通过过滤器去查找</span>        File<span class="token punctuation">[</span><span class="token punctuation">]</span> files <span class="token operator">=</span> file<span class="token punctuation">.</span><span class="token function">listFiles</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">FilenameFilter</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">accept</span><span class="token punctuation">(</span>File dir<span class="token punctuation">,</span> String name<span class="token punctuation">)</span> <span class="token punctuation">{</span>                <span class="token keyword">return</span> name<span class="token punctuation">.</span><span class="token function">endsWith</span><span class="token punctuation">(</span><span class="token string">".txt"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//获取所有的子文件和文件夹</span>        <span class="token keyword">for</span><span class="token punctuation">(</span>File f<span class="token operator">:</span>files<span class="token punctuation">)</span> <span class="token punctuation">{</span>            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>f<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token comment" spellcheck="true">//getAllFile(file.getAbsolutePath());</span>    <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true">//这个方法是获取当前文件夹下所有的文件</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">getAllFile</span><span class="token punctuation">(</span>String path<span class="token punctuation">)</span> <span class="token punctuation">{</span>        File dir <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//构建一个文件夹</span>        File<span class="token punctuation">[</span><span class="token punctuation">]</span> files <span class="token operator">=</span> dir<span class="token punctuation">.</span><span class="token function">listFiles</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//获取到当前文件夹下所有的文件文件夹</span>        <span class="token keyword">for</span><span class="token punctuation">(</span>File f<span class="token operator">:</span>files<span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>f<span class="token punctuation">.</span><span class="token function">isFile</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>f<span class="token punctuation">.</span><span class="token function">getAbsolutePath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token punctuation">{</span>                <span class="token function">getAllFile</span><span class="token punctuation">(</span>f<span class="token punctuation">.</span><span class="token function">getAbsolutePath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//递归查找子文件夹</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span></code></pre><h2 id="2、IO"><a href="#2、IO" class="headerlink" title="2、IO"></a>2、IO</h2><h3 id="2-1-流的概念"><a href="#2-1-流的概念" class="headerlink" title="2.1 流的概念"></a>2.1 流的概念</h3><pre class=" language-java"><code class="language-java">    水流，气流，车流，电流，人流，各种元素的流动    文件流：文字的流动，只认识二进制，都是<span class="token number">01</span>，<span class="token number">010101010101</span>数据的流动    大小：    字符流（<span class="token number">16</span>位二进制）和字节流（<span class="token number">8</span>位二进制） 方向：相对于内存来说    输入流（硬盘读入内存），输出流（内存到硬盘）   字节输入流，字节输出流，字符输入流，字符输出流io<span class="token operator">:</span>input<span class="token operator">-</span>output传统的输入输出流bio<span class="token operator">:</span>blocking<span class="token operator">-</span>io：阻塞的输入输出流nio<span class="token operator">:</span><span class="token keyword">new</span><span class="token operator">-</span>io<span class="token punctuation">,</span>non<span class="token operator">-</span>blocking<span class="token operator">-</span>io<span class="token operator">:</span>非阻塞输入输出流aio<span class="token operator">:</span>nio的升级版，现在很少用</code></pre><h3 id="2-2-字节流"><a href="#2-2-字节流" class="headerlink" title="2.2 字节流"></a>2.2 字节流</h3><pre class=" language-java"><code class="language-java">字节输入流：    is<span class="token punctuation">.</span><span class="token function">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span>返回的是一个字节的数据对应的整数值，如果读完了，返回的是<span class="token operator">-</span><span class="token number">1</span>一个字节一个字节读，这种读法数据量很大的时候就很慢。InputStream is <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileInputStream</span><span class="token punctuation">(</span><span class="token string">"a.txt"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//构建一个流指向指定文件</span><span class="token comment" spellcheck="true">//读内容--一字节一字节读，读完了返回-1  使用循环读完，文件中先不写中文</span><span class="token keyword">int</span> data<span class="token punctuation">;</span><span class="token comment" spellcheck="true">//暂存数据</span><span class="token keyword">while</span><span class="token punctuation">(</span><span class="token punctuation">(</span>data<span class="token operator">=</span>is<span class="token punctuation">.</span><span class="token function">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">!=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token punctuation">)</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span>使用缓存数组来读取：    is<span class="token punctuation">.</span><span class="token function">read</span><span class="token punctuation">(</span>buf<span class="token punctuation">)</span><span class="token operator">:</span>数据读进了buf里面，返回一个实际读到的长度InputStream is <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileInputStream</span><span class="token punctuation">(</span><span class="token string">"a.txt"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> buf <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">byte</span><span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">int</span> length <span class="token punctuation">;</span><span class="token keyword">while</span><span class="token punctuation">(</span><span class="token punctuation">(</span>length<span class="token operator">=</span>is<span class="token punctuation">.</span><span class="token function">read</span><span class="token punctuation">(</span>buf<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">!=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token comment" spellcheck="true">//如果读完了，返回-1，如果读到有数据，返回</span>            <span class="token comment" spellcheck="true">//本次读到的数据个数</span>    System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span>buf<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>length<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span>写出去   一个字节一个字节的写：<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> Exception <span class="token punctuation">{</span>        InputStream is <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileInputStream</span><span class="token punctuation">(</span><span class="token string">"a.txt"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//构建一个流指向指定文件</span>        <span class="token comment" spellcheck="true">//读内容--一字节一字节读，读完了返回-1  使用循环读完，文件中先不写中文</span>        OutputStream os <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileOutputStream</span><span class="token punctuation">(</span><span class="token string">"b.txt"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> data<span class="token punctuation">;</span><span class="token comment" spellcheck="true">//暂存数据</span>        <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token punctuation">(</span>data<span class="token operator">=</span>is<span class="token punctuation">.</span><span class="token function">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">!=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token punctuation">)</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>            os<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span><span class="token punctuation">}</span>使用缓存数组写：<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> Exception <span class="token punctuation">{</span>        InputStream is <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileInputStream</span><span class="token punctuation">(</span><span class="token string">"a.txt"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        OutputStream os <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileOutputStream</span><span class="token punctuation">(</span><span class="token string">"c.txt"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> buf <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">byte</span><span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> length <span class="token punctuation">;</span>        <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token punctuation">(</span>length<span class="token operator">=</span>is<span class="token punctuation">.</span><span class="token function">read</span><span class="token punctuation">(</span>buf<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">!=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token comment" spellcheck="true">//如果读完了，返回-1，如果读到有数据，返回</span>            <span class="token comment" spellcheck="true">//本次读到的数据个数</span>            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span>buf<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>length<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            os<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>buf<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> length<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//读到多少写出多少</span>        <span class="token punctuation">}</span><span class="token punctuation">}</span>演示案例：    使用字节流copy一个视频或者音乐<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TestCopy</span> <span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>        InputStream is <span class="token operator">=</span> null<span class="token punctuation">;</span>        OutputStream os <span class="token operator">=</span> null<span class="token punctuation">;</span>        <span class="token keyword">try</span> <span class="token punctuation">{</span>            is <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileInputStream</span><span class="token punctuation">(</span><span class="token string">"d:/星际穿越.mkv"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            os <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileOutputStream</span><span class="token punctuation">(</span><span class="token string">"d:/movie.mkv"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> buf <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">byte</span><span class="token punctuation">[</span><span class="token number">8</span><span class="token operator">*</span><span class="token number">1024</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//8k</span>            <span class="token keyword">int</span> length <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>            <span class="token keyword">long</span> time1 <span class="token operator">=</span> System<span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token punctuation">(</span>length<span class="token operator">=</span>is<span class="token punctuation">.</span><span class="token function">read</span><span class="token punctuation">(</span>buf<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">!=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                os<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>buf<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> length<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>            <span class="token keyword">long</span> time2 <span class="token operator">=</span> System<span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"共用："</span><span class="token operator">+</span><span class="token punctuation">(</span>time2<span class="token operator">-</span>time1<span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">1000</span><span class="token operator">+</span><span class="token string">"s"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">FileNotFoundException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span><span class="token keyword">finally</span> <span class="token punctuation">{</span>            <span class="token keyword">try</span> <span class="token punctuation">{</span>                is<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                os<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>                e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span>字节流的复制，OutputStream os <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileOutputStream</span><span class="token punctuation">(</span><span class="token string">"c.txt"</span><span class="token punctuation">,</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>这个是追加模式          字节流：    InputStream  OutputStream    FileInputStream <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>    DataInputStream <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>    ObjectInputStream <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>    字节流可以完成任意文件的读写。</code></pre><h3 id="2-3-字符流"><a href="#2-3-字符流" class="headerlink" title="2.3 字符流"></a>2.3 字符流</h3><h4 id="2-3-1-编码的发展"><a href="#2-3-1-编码的发展" class="headerlink" title="2.3.1 编码的发展"></a>2.3.1 编码的发展</h4><p>​        计算机刚出来—AscII码—满足美国人自己使用   0-127  </p><p>​        计算机传到西欧—- Iso-8859-1  西欧文  128-255</p><p>​        中国  GB2312    —只收录了常见的几千个字     很多字没有   —奇特现象   身份证有两个字是打印的，   有个字手写上去的</p><p>​         GBK—–GB18030 </p><p>​         BIG5  — 大五码    香港台湾</p><p>​         ANSI：不是编码——这个是微软搞的一个标准，本地编码—-</p><p>国际标准化组织：</p><p>​        UTF编码：万国码，utf-8</p><p>​        UTF-32:任意字符都是使用32位二进制来表示。</p><p>​        UTF-16:任意字符都是使用16位二进制来表示。</p><p>​        UTF-8:可变长编码</p><p>例如：</p><pre class=" language-java"><code class="language-java">中<span class="token operator">:</span>utf<span class="token operator">-</span><span class="token number">8</span>   码值： <span class="token number">20013</span>   码值的十六进制<span class="token operator">:</span><span class="token number">4e2d</span>   码值的二进制： <span class="token number">01001110</span>，<span class="token number">00101101</span>   <span class="token number">15</span>位三字节UTF<span class="token operator">-</span><span class="token number">8</span>编码表示：   <span class="token number">11100100</span>   <span class="token number">10111000</span>   <span class="token number">10101101</span>   <span class="token comment" spellcheck="true">//228 11100100 18410111000173  10101101</span></code></pre><p>面试题：</p><p>用utf-8编码解析位图</p><h4 id="2-3-2-字符流的使用"><a href="#2-3-2-字符流的使用" class="headerlink" title="2.3.2 字符流的使用"></a>2.3.2 字符流的使用</h4><pre class=" language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> Exception <span class="token punctuation">{</span>        <span class="token comment" spellcheck="true">//一行一行的读取文件</span>        BufferedReader br <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BufferedReader</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">InputStreamReader</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">FileInputStream</span><span class="token punctuation">(</span><span class="token string">"d:/b.txt"</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">"utf-8"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        String line <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>        BufferedWriter bw <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BufferedWriter</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">OutputStreamWriter</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">FileOutputStream</span><span class="token punctuation">(</span><span class="token string">"d:/c.txt"</span><span class="token punctuation">,</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">"utf-8"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token punctuation">(</span>line<span class="token operator">=</span>br<span class="token punctuation">.</span><span class="token function">readLine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">!=</span>null<span class="token punctuation">)</span> <span class="token punctuation">{</span>            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>line<span class="token punctuation">)</span><span class="token punctuation">;</span>            bw<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>line<span class="token punctuation">)</span><span class="token punctuation">;</span>            bw<span class="token punctuation">.</span><span class="token function">newLine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//换行</span>        <span class="token punctuation">}</span>        bw<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        br<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><p>作业：</p><pre class=" language-java"><code class="language-java">   <span class="token number">1</span>、copy文件夹<span class="token operator">--</span><span class="token operator">-</span>io<span class="token comment" spellcheck="true">//copy文件夹的方法</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">copy</span><span class="token punctuation">(</span>String src<span class="token punctuation">,</span> String dest<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token comment" spellcheck="true">//先创建一个目标文件夹</span>        File destDir <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span>dest<span class="token punctuation">)</span><span class="token punctuation">;</span>        destDir<span class="token punctuation">.</span><span class="token function">mkdir</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//d:/a_copy</span>        <span class="token comment" spellcheck="true">//遍历a下面的所有文件夹和文件</span>        File  srcFile <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span>src<span class="token punctuation">)</span><span class="token punctuation">;</span>        File<span class="token punctuation">[</span><span class="token punctuation">]</span> files <span class="token operator">=</span> srcFile<span class="token punctuation">.</span><span class="token function">listFiles</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">for</span><span class="token punctuation">(</span>File f<span class="token operator">:</span>files<span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token comment" spellcheck="true">//文件或文件夹</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>f<span class="token punctuation">.</span><span class="token function">isDirectory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                <span class="token comment" spellcheck="true">//递归调自己</span>                <span class="token function">copy</span><span class="token punctuation">(</span>f<span class="token punctuation">.</span><span class="token function">getAbsolutePath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>dest<span class="token operator">+</span><span class="token string">"/"</span><span class="token operator">+</span>f<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token punctuation">{</span>                <span class="token function">copyFile</span><span class="token punctuation">(</span>f<span class="token punctuation">.</span><span class="token function">getAbsolutePath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>dest<span class="token operator">+</span><span class="token string">"/"</span><span class="token operator">+</span>f<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span>                <span class="token punctuation">}</span>        <span class="token comment" spellcheck="true">//copy文件的方法</span>    <span class="token keyword">private</span>  <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">copyFile</span><span class="token punctuation">(</span>String src<span class="token punctuation">,</span>String dest<span class="token punctuation">)</span> <span class="token punctuation">{</span>        InputStream fis <span class="token operator">=</span> null<span class="token punctuation">;</span>        OutputStream fos <span class="token operator">=</span> null<span class="token punctuation">;</span>        <span class="token keyword">try</span> <span class="token punctuation">{</span>            fis <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileInputStream</span><span class="token punctuation">(</span>src<span class="token punctuation">)</span><span class="token punctuation">;</span>            fos <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileOutputStream</span><span class="token punctuation">(</span>dest<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">int</span> length <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>            <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> buf <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">byte</span><span class="token punctuation">[</span><span class="token number">1024</span><span class="token operator">*</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">;</span>            <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token punctuation">(</span>length<span class="token operator">=</span>fis<span class="token punctuation">.</span><span class="token function">read</span><span class="token punctuation">(</span>buf<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">!=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                fos<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>buf<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>length<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">FileNotFoundException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span><span class="token keyword">finally</span> <span class="token punctuation">{</span>            <span class="token keyword">try</span> <span class="token punctuation">{</span>                fos<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>              fis<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>                <span class="token comment" spellcheck="true">// TODO Auto-generated catch block</span>                e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span></code></pre><p>​    </p><pre class=" language-java"><code class="language-java">   <span class="token number">2</span>、删除文件夹<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Test</span> <span class="token punctuation">{</span>        <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token function">delete</span><span class="token punctuation">(</span><span class="token string">"d:/a_copy"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true">//删除文件夹</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">delete</span><span class="token punctuation">(</span>String path<span class="token punctuation">)</span> <span class="token punctuation">{</span>        File dir <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//创建文件夹</span>        <span class="token comment" spellcheck="true">//遍历所有的子文件以及子文件夹</span>        File<span class="token punctuation">[</span><span class="token punctuation">]</span> files <span class="token operator">=</span> dir<span class="token punctuation">.</span><span class="token function">listFiles</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>files<span class="token punctuation">.</span>length<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>files<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">isDirectory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                <span class="token comment" spellcheck="true">//是文件夹</span>                <span class="token function">delete</span><span class="token punctuation">(</span>files<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getAbsolutePath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>            files<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//递归回来之后删除文件夹</span>        <span class="token punctuation">}</span>        dir<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span></code></pre><p>​       </p><p>​       </p><h2 id="3、bio"><a href="#3、bio" class="headerlink" title="3、bio"></a>3、bio</h2><h3 id="3-1-socket"><a href="#3-1-socket" class="headerlink" title="3.1 socket"></a>3.1 socket</h3><p>InetAddress的案例：</p><pre class=" language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TestInet</span> <span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> Exception <span class="token punctuation">{</span>        InetAddress ia <span class="token operator">=</span> InetAddress<span class="token punctuation">.</span><span class="token function">getLocalHost</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//获取本机地址</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>ia<span class="token punctuation">.</span><span class="token function">getHostName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//主机名</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>ia<span class="token punctuation">.</span><span class="token function">getHostAddress</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//主机地址</span>        <span class="token comment" spellcheck="true">//InetAddress ia1 = InetAddress.getByName("192.168.226.1");</span>        <span class="token comment" spellcheck="true">//System.out.println(ia1.getHostName());</span>        InetAddress ia2 <span class="token operator">=</span> InetAddress<span class="token punctuation">.</span><span class="token function">getByName</span><span class="token punctuation">(</span><span class="token string">"127.0.0.1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//构建本机</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>ia2<span class="token punctuation">.</span><span class="token function">getHostName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>ia2<span class="token punctuation">.</span><span class="token function">getHostAddress</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">//远程地址</span>        InetAddress ia3 <span class="token operator">=</span> InetAddress<span class="token punctuation">.</span><span class="token function">getByName</span><span class="token punctuation">(</span><span class="token string">"www.baidu.com"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>ia3<span class="token punctuation">.</span><span class="token function">getHostName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>ia3<span class="token punctuation">.</span><span class="token function">getHostAddress</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">//获取所有京东的地址</span>        InetAddress<span class="token punctuation">[</span><span class="token punctuation">]</span> ias <span class="token operator">=</span> InetAddress<span class="token punctuation">.</span><span class="token function">getAllByName</span><span class="token punctuation">(</span><span class="token string">"www.jd.com"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> ias<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>ias<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getHostAddress</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span></code></pre><h3 id="3-2-socket编程："><a href="#3-2-socket编程：" class="headerlink" title="3.2 socket编程："></a>3.2 socket编程：</h3><h4 id="3-2-1-服务器和客户端的第一次连接"><a href="#3-2-1-服务器和客户端的第一次连接" class="headerlink" title="3.2.1 服务器和客户端的第一次连接"></a>3.2.1 服务器和客户端的第一次连接</h4><pre class=" language-java"><code class="language-java">服务器：<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Server</span> <span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> Exception <span class="token punctuation">{</span>        <span class="token comment" spellcheck="true">//定义一个服务器</span>        ServerSocket server  <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ServerSocket</span><span class="token punctuation">(</span><span class="token number">6666</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"服务器初始化。。。。启动监听"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">//服务器监听客户端的连接</span>        <span class="token comment" spellcheck="true">//这行代码会阻塞，会等到有客户端来连接才继续执行，这个方法会返回一个Socket对象，这个对象代表了</span>        <span class="token comment" spellcheck="true">//客户端</span>        Socket socket <span class="token operator">=</span> server<span class="token punctuation">.</span><span class="token function">accept</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>socket<span class="token punctuation">.</span><span class="token function">getInetAddress</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">"连上了服务器"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span>客户端：<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Client</span> <span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> Exception<span class="token punctuation">{</span>        <span class="token comment" spellcheck="true">//创建一个客户端的程序去连接服务器</span>        Socket socket <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Socket</span><span class="token punctuation">(</span><span class="token string">"192.168.1.6"</span><span class="token punctuation">,</span> <span class="token number">6666</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//127.0.0.1</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"客户端启动"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span>思考一个问题：服务器中的socket对象和客户端的socket对象是不是同一个对象？        </code></pre><h4 id="3-2-2-服务器和客户端的第一次通信"><a href="#3-2-2-服务器和客户端的第一次通信" class="headerlink" title="3.2.2 服务器和客户端的第一次通信"></a>3.2.2 服务器和客户端的第一次通信</h4><pre class=" language-java"><code class="language-java">服务端<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Server</span> <span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> Exception <span class="token punctuation">{</span>        <span class="token comment" spellcheck="true">//定义一个服务器</span>        ServerSocket server  <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ServerSocket</span><span class="token punctuation">(</span><span class="token number">6666</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"服务器初始化。。。。启动监听"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">//服务器监听客户端的连接</span>        <span class="token comment" spellcheck="true">//这行代码会阻塞，会等到有客户端来连接才继续执行，这个方法会返回一个Socket对象，这个对象代表了</span>        <span class="token comment" spellcheck="true">//客户端</span>        Socket socket <span class="token operator">=</span> server<span class="token punctuation">.</span><span class="token function">accept</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>socket<span class="token punctuation">.</span><span class="token function">getInetAddress</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">"连上了服务器"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">//System.out.println(socket);</span>        <span class="token comment" spellcheck="true">//读取名字</span>        InputStream is <span class="token operator">=</span> socket<span class="token punctuation">.</span><span class="token function">getInputStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> buf <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">byte</span><span class="token punctuation">[</span><span class="token number">1024</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> length <span class="token operator">=</span> is<span class="token punctuation">.</span><span class="token function">read</span><span class="token punctuation">(</span>buf<span class="token punctuation">)</span><span class="token punctuation">;</span>        String name <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span>buf<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>length<span class="token punctuation">)</span><span class="token punctuation">;</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"客户端注册的名字是："</span><span class="token operator">+</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">//给客户端发送一个欢迎信息</span>        OutputStream os <span class="token operator">=</span> socket<span class="token punctuation">.</span><span class="token function">getOutputStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        os<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">"欢迎"</span><span class="token operator">+</span>name<span class="token operator">+</span><span class="token string">"加入聊天室"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        socket<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        server<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span>客户端：<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Client</span> <span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> Exception<span class="token punctuation">{</span>        <span class="token comment" spellcheck="true">//创建一个客户端的程序去连接服务器</span>        Socket socket <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Socket</span><span class="token punctuation">(</span><span class="token string">"192.168.1.6"</span><span class="token punctuation">,</span> <span class="token number">6666</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"客户端启动"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">//System.out.println(socket);</span>        <span class="token comment" spellcheck="true">//第一次交流---客户端先给服务器发送一个名字</span>        Scanner input <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Scanner</span><span class="token punctuation">(</span>System<span class="token punctuation">.</span>in<span class="token punctuation">)</span><span class="token punctuation">;</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"请输入您的昵称："</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        String name <span class="token operator">=</span> input<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">//把名字写进socket里面就行</span>        OutputStream os <span class="token operator">=</span> socket<span class="token punctuation">.</span><span class="token function">getOutputStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        os<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>name<span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//把名字写到socket里面</span>        <span class="token comment" spellcheck="true">//接受socket里面发过来的消息</span>        InputStream is <span class="token operator">=</span> socket<span class="token punctuation">.</span><span class="token function">getInputStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> buf <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">byte</span><span class="token punctuation">[</span><span class="token number">1024</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> length <span class="token operator">=</span> is<span class="token punctuation">.</span><span class="token function">read</span><span class="token punctuation">(</span>buf<span class="token punctuation">)</span><span class="token punctuation">;</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span>buf<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>length<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        socket<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span></code></pre><h4 id="3-2-3-客户端给服务器上传一张图片"><a href="#3-2-3-客户端给服务器上传一张图片" class="headerlink" title="3.2.3 客户端给服务器上传一张图片"></a>3.2.3 客户端给服务器上传一张图片</h4><pre class=" language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Server</span> <span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> Exception <span class="token punctuation">{</span>        ServerSocket server <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ServerSocket</span><span class="token punctuation">(</span><span class="token number">8888</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        Socket socket <span class="token operator">=</span> server<span class="token punctuation">.</span><span class="token function">accept</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//是一个通道</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"服务器开始接受图片"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        InputStream is <span class="token operator">=</span> socket<span class="token punctuation">.</span><span class="token function">getInputStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        OutputStream os <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileOutputStream</span><span class="token punctuation">(</span><span class="token string">"d:/upload.jpg"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> length <span class="token operator">=</span> <span class="token number">0</span> <span class="token punctuation">;</span>        <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> buf <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">byte</span><span class="token punctuation">[</span><span class="token number">8</span><span class="token operator">*</span><span class="token number">1024</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token punctuation">(</span>length<span class="token operator">=</span>is<span class="token punctuation">.</span><span class="token function">read</span><span class="token punctuation">(</span>buf<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">!=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            os<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>buf<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>length<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        os<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        is<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        socket<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        server<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"接受完毕"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Client</span> <span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> Exception<span class="token punctuation">{</span>        Socket socket <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Socket</span><span class="token punctuation">(</span><span class="token string">"127.0.0.1"</span><span class="token punctuation">,</span><span class="token number">8888</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        InputStream is <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileInputStream</span><span class="token punctuation">(</span><span class="token string">"d:/景甜.jpg"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">//写入到socket</span>        OutputStream os <span class="token operator">=</span> socket<span class="token punctuation">.</span><span class="token function">getOutputStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> length <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> buf <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">byte</span><span class="token punctuation">[</span><span class="token number">8</span><span class="token operator">*</span><span class="token number">1024</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token punctuation">(</span>length<span class="token operator">=</span>is<span class="token punctuation">.</span><span class="token function">read</span><span class="token punctuation">(</span>buf<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">!=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            os<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>buf<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> length<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        os<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        is<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        socket<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span></code></pre><p>socket编程容易出现的两个小错误：</p><p>​      1、启动顺序：先启动服务器再启动客户端。</p><p>​      2、服务器不能启动多次，客户端可以启动多次，如果是eclipse直接启动多次，如果是idea，需要设置并发启动。</p><h3 id="3-3-聊天室"><a href="#3-3-聊天室" class="headerlink" title="3.3 聊天室"></a>3.3 聊天室</h3><p>代码：</p><pre class=" language-java"><code class="language-java">服务器代码<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Server</span> <span class="token punctuation">{</span>    List<span class="token operator">&lt;</span>SocketTask<span class="token operator">></span> clients <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token operator">&lt;</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">try</span> <span class="token punctuation">{</span>            <span class="token comment" spellcheck="true">// 开启一个服务器</span>            ServerSocket server <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ServerSocket</span><span class="token punctuation">(</span><span class="token number">8888</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"服务器启动啦。。。。。。"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment" spellcheck="true">// 不断接收客户端的连接</span>            <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                <span class="token comment" spellcheck="true">// 监听客户端的连接</span>                Socket socket <span class="token operator">=</span> server<span class="token punctuation">.</span><span class="token function">accept</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>socket<span class="token punctuation">.</span><span class="token function">getInetAddress</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getHostAddress</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"连接了服务器"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token comment" spellcheck="true">// 服务器就开辟一个新的线程来维护你这个客户端的聊天任务</span>                SocketTask st <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SocketTask</span><span class="token punctuation">(</span>socket<span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token comment" spellcheck="true">// 现先放任务到集合还是先启动</span>                clients<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>st<span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span>st<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token keyword">class</span> <span class="token class-name">SocketTask</span> <span class="token keyword">implements</span> <span class="token class-name">Runnable</span> <span class="token punctuation">{</span>        Socket socket<span class="token punctuation">;</span><span class="token comment" spellcheck="true">// 客户端是谁</span>        String name<span class="token punctuation">;</span><span class="token comment" spellcheck="true">// 客户端的名字是什么</span>        <span class="token comment" spellcheck="true">// to-do</span>        <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">try</span> <span class="token punctuation">{</span>                <span class="token comment" spellcheck="true">// 编写任务--先接收一次名字，然后发送一个欢迎信息给所有目前聊天室的人</span>                InputStream is <span class="token operator">=</span> socket<span class="token punctuation">.</span><span class="token function">getInputStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token comment" spellcheck="true">// 读写使用BufferedReader---BufferedWriter</span>                BufferedReader br <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BufferedReader</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">InputStreamReader</span><span class="token punctuation">(</span>is<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                String name <span class="token operator">=</span> br<span class="token punctuation">.</span><span class="token function">readLine</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"["</span> <span class="token operator">+</span> socket<span class="token punctuation">.</span><span class="token function">getInetAddress</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getHostAddress</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"]"</span><span class="token punctuation">;</span>                <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>                <span class="token comment" spellcheck="true">// 发送一个欢迎信息给所有的客户端</span>                <span class="token function">sendMsg</span><span class="token punctuation">(</span>name <span class="token operator">+</span> <span class="token string">"加入了聊天室"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token comment" spellcheck="true">// 不断接收这个socket发过来的消息，并转发给所有人</span>                <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                    <span class="token comment" spellcheck="true">//读取这个客户端发的消息</span>                    String msg <span class="token operator">=</span> br<span class="token punctuation">.</span><span class="token function">readLine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                    <span class="token function">sendMsg</span><span class="token punctuation">(</span>name<span class="token operator">+</span><span class="token string">":"</span><span class="token operator">+</span>msg<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//广播给所有的客户端</span>                    <span class="token keyword">if</span><span class="token punctuation">(</span>msg<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token string">"exit"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token comment" spellcheck="true">//意味着客户端要退出聊天室</span>                        socket<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                        <span class="token comment" spellcheck="true">//从集合中把它移除</span>                        clients<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                        <span class="token keyword">break</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//线程任务完成</span>                    <span class="token punctuation">}</span>                <span class="token punctuation">}</span>            <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>                System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>name<span class="token operator">+</span><span class="token string">"退出了聊天室"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                clients<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token function">sendMsg</span><span class="token punctuation">(</span>name<span class="token operator">+</span><span class="token string">"退出了聊天室"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span>        <span class="token comment" spellcheck="true">// 这个方法是把服务器的消息发送到所有客户端</span>        <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">sendMsg</span><span class="token punctuation">(</span>String msg<span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">try</span> <span class="token punctuation">{</span>                <span class="token keyword">for</span> <span class="token punctuation">(</span>SocketTask st <span class="token operator">:</span> clients<span class="token punctuation">)</span> <span class="token punctuation">{</span>                    BufferedWriter bw <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BufferedWriter</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">OutputStreamWriter</span><span class="token punctuation">(</span>st<span class="token punctuation">.</span>socket<span class="token punctuation">.</span><span class="token function">getOutputStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                    bw<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span><span class="token punctuation">;</span>                    bw<span class="token punctuation">.</span><span class="token function">newLine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//要写一个换行</span>                    bw<span class="token punctuation">.</span><span class="token function">flush</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                    <span class="token comment" spellcheck="true">//bw不能close--如果close就会关闭socket</span>                <span class="token punctuation">}</span>            <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>                e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span>        <span class="token keyword">public</span> <span class="token function">SocketTask</span><span class="token punctuation">(</span>Socket socket<span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">this</span><span class="token punctuation">.</span>socket <span class="token operator">=</span> socket<span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true">// 入口转移</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">new</span> <span class="token class-name">Server</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token comment" spellcheck="true">/** * 客户端怎么取决于服务器怎么写 * @author ThinkPad * */</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Client</span> <span class="token punctuation">{</span>    <span class="token keyword">static</span> <span class="token keyword">boolean</span> flag <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>        Scanner input <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Scanner</span><span class="token punctuation">(</span>System<span class="token punctuation">.</span>in<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">try</span> <span class="token punctuation">{</span>            <span class="token comment" spellcheck="true">//创建一个客户端</span>            Socket socket  <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Socket</span><span class="token punctuation">(</span><span class="token string">"127.0.0.1"</span><span class="token punctuation">,</span><span class="token number">8888</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment" spellcheck="true">//拿一个线程专门收信息</span>            <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Runnable</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                    <span class="token keyword">try</span> <span class="token punctuation">{</span>                        <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                            InputStream is <span class="token operator">=</span> socket<span class="token punctuation">.</span><span class="token function">getInputStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                            BufferedReader br <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BufferedReader</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">InputStreamReader</span><span class="token punctuation">(</span>is<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                            String msg <span class="token operator">=</span> br<span class="token punctuation">.</span><span class="token function">readLine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span><span class="token punctuation">;</span>                            <span class="token keyword">if</span><span class="token punctuation">(</span>flag<span class="token operator">==</span><span class="token boolean">false</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                                <span class="token keyword">break</span><span class="token punctuation">;</span>                            <span class="token punctuation">}</span>                        <span class="token punctuation">}</span>                    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>                        <span class="token comment" spellcheck="true">//这里有个异常</span>                    <span class="token punctuation">}</span>                <span class="token punctuation">}</span>            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment" spellcheck="true">//另外一个线程专门发信息</span>            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"请输入您的昵称："</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            String name <span class="token operator">=</span> input<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            BufferedWriter bw <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BufferedWriter</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">OutputStreamWriter</span><span class="token punctuation">(</span>socket<span class="token punctuation">.</span><span class="token function">getOutputStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            bw<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>            bw<span class="token punctuation">.</span><span class="token function">newLine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            bw<span class="token punctuation">.</span><span class="token function">flush</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"请输入聊天消息："</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                String msg <span class="token operator">=</span> input<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                bw<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span><span class="token punctuation">;</span>                bw<span class="token punctuation">.</span><span class="token function">newLine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                bw<span class="token punctuation">.</span><span class="token function">flush</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">if</span><span class="token punctuation">(</span>msg<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token string">"exit"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                    socket<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                    <span class="token comment" spellcheck="true">//给接收线程发一个中断信号，让他终止</span>                    flag <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>                    <span class="token keyword">break</span><span class="token punctuation">;</span>                <span class="token punctuation">}</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">UnknownHostException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span></code></pre>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>异常+多线程</title>
      <link href="/2022/11/20/duo-xian-cheng/"/>
      <url>/2022/11/20/duo-xian-cheng/</url>
      
        <content type="html"><![CDATA[<h1 id="异常-多线程"><a href="#异常-多线程" class="headerlink" title="异常+多线程"></a>异常+多线程</h1><p>​       </p><h2 id="1、异常"><a href="#1、异常" class="headerlink" title="1、异常"></a>1、异常</h2><pre class=" language-java"><code class="language-java">程序的健壮性，有异常能对付。如果不用异常处理，用目前所学知识也可以做，<span class="token keyword">if</span>。    <span class="token number">1</span>、程序非常臃肿    <span class="token number">2</span>、让程序员更多的去关注这些不正常的状态，淡化了业务逻辑。 用<span class="token keyword">if</span>处理是一种悲观的状态<span class="token operator">--</span><span class="token operator">-</span>他认为这些使用者都是坏人，他不会按照正常的输入来输入。使用异常处理：    <span class="token keyword">try</span><span class="token operator">-</span><span class="token keyword">catch</span><span class="token operator">-</span><span class="token keyword">finally</span>    <span class="token keyword">try</span><span class="token operator">:</span>尝试执行一下    <span class="token keyword">catch</span><span class="token operator">:</span>如果你不听话，就抓住你    <span class="token keyword">finally</span><span class="token operator">:</span>无论如何都会执行的代码<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>        Scanner input <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Scanner</span><span class="token punctuation">(</span>System<span class="token punctuation">.</span>in<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">try</span> <span class="token punctuation">{</span>            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"请输入被除数：(整数)"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">int</span> num1 <span class="token operator">=</span> input<span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"请输入除数：(非零整数)"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">int</span> num2 <span class="token operator">=</span> input<span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>num1<span class="token operator">/</span>num2<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InputMismatchException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"请输入一个整数"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//很多时候我们都是把他写成日志</span>        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">ArithmeticException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"除数不能为0"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span> <span class="token keyword">finally</span><span class="token punctuation">{</span>            <span class="token comment" spellcheck="true">//这里是最终执行的代码</span>        <span class="token punctuation">}</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"还有一万行代码"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span>  乐观心态：    我认为别人会按照我们的要求去做。 多重<span class="token keyword">catch</span>块，需要子类在前，父类在后    <span class="token keyword">finally</span><span class="token operator">:</span>无论有无异常都会执行的代码。<span class="token operator">--</span><span class="token operator">-</span>做资源释放<span class="token operator">--</span><span class="token operator">-</span>连接     <span class="token keyword">final</span><span class="token punctuation">,</span><span class="token keyword">finally</span><span class="token punctuation">,</span>finalize 有什么区别？<span class="token operator">--</span><span class="token operator">--</span>请你百度一下  <span class="token keyword">return</span> 会让<span class="token keyword">finally</span>执行 原因是<span class="token keyword">return</span>仅仅是结束当前方法，其他方法可能继续执行，是不是应该把资源释放掉。  System<span class="token punctuation">.</span><span class="token function">exit</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token operator">:</span>他是退出虚拟机，所有方法都不会继续执行了，虚拟机都释放了，就没必要再去释放<span class="token keyword">finally</span>里面的资源了。   执行<span class="token keyword">finally</span>的时候其实是把变量复制了一份到<span class="token keyword">finally</span>进行运算。        <span class="token comment" spellcheck="true">//catch可以写多个，多个catch能不能换位置？</span>         只要不是父子关系就能换。<span class="token keyword">try</span><span class="token operator">-</span>with<span class="token operator">-</span>resource<span class="token keyword">try</span><span class="token punctuation">(</span>Scanner input <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Scanner</span><span class="token punctuation">(</span>System<span class="token punctuation">.</span>in<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"请输入被除数：(整数)"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">int</span> num1 <span class="token operator">=</span> input<span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"请输入除数：(非零整数)"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">int</span> num2 <span class="token operator">=</span> input<span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>num1 <span class="token operator">/</span> num2<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>     e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"还有一万行代码"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">throws</span>声明一个异常<span class="token comment" spellcheck="true">//自定义异常</span>    <span class="token comment" spellcheck="true">//先把异常捕获，然后抛出我们自己的异常-----业务异常</span><span class="token comment" spellcheck="true">//有业务意义的异常----按模块分，UserException   OrderException  </span><span class="token comment" spellcheck="true">// DivException</span>  自定义异常：继承Exception<span class="token operator">--</span><span class="token operator">-</span>必须被调用者捕获            继承RuntimeException<span class="token operator">--</span><span class="token operator">--</span>可以不被捕获<span class="token operator">--</span><span class="token operator">-</span>运行时异常       <span class="token comment" spellcheck="true">//练习1：</span><span class="token comment" spellcheck="true">//输入一个性别，赋给学生，如果性别为男或女，直接赋值，否则，抛出一个用户异常，提示性别不正确。</span>   <span class="token comment" spellcheck="true">//练习2： </span>   <span class="token comment" spellcheck="true">//异常信息：属性叫message的时候，输出异常的时候这个信息输出了，为什么属性改为msg，就不输出了？---面向对象的知识</span>         <span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DivException</span> <span class="token keyword">extends</span> <span class="token class-name">RuntimeException</span> <span class="token punctuation">{</span>        String msg<span class="token punctuation">;</span><span class="token comment" spellcheck="true">//异常信息</span>    <span class="token keyword">public</span> <span class="token function">DivException</span><span class="token punctuation">(</span>String msg<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>msg <span class="token operator">=</span> msg<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">public</span> String <span class="token function">getMsg</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">return</span> msg<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setMsg</span><span class="token punctuation">(</span>String msg<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>msg <span class="token operator">=</span> msg<span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TestDiv</span> <span class="token punctuation">{</span>        <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span><span class="token punctuation">{</span>                <span class="token function">div</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"还有一万行代码"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>        <span class="token comment" spellcheck="true">//我不想处理这两个异常，但是我要告诉别人你来处理--把jdk的异常转换为自定义异常</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">div</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> DivException<span class="token punctuation">{</span>        Scanner input <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Scanner</span><span class="token punctuation">(</span>System<span class="token punctuation">.</span>in<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">try</span> <span class="token punctuation">{</span>            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"请输入被除数：(整数)"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">int</span> num1 <span class="token operator">=</span> input<span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"请输入除数：(非零整数)"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">int</span> num2 <span class="token operator">=</span> input<span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>num1<span class="token operator">/</span>num2<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span><span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InputMismatchException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">DivException</span><span class="token punctuation">(</span><span class="token string">"输入的不是整数"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//抛出一个除法异常</span>        <span class="token punctuation">}</span><span class="token keyword">catch</span><span class="token punctuation">(</span>ArithmeticException e<span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">DivException</span><span class="token punctuation">(</span><span class="token string">"除数不能为0"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//抛出一个除法异常</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">try</span><span class="token punctuation">,</span><span class="token keyword">catch</span><span class="token punctuation">,</span><span class="token keyword">finally</span><span class="token punctuation">,</span><span class="token keyword">throw</span><span class="token punctuation">,</span><span class="token keyword">throws</span>执行正常代码   捕获异常   释放资源   抛出异常   声明异常    DivException<span class="token operator">:</span>    e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>     <span class="token function">printStackTrace</span><span class="token punctuation">(</span>System<span class="token punctuation">.</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">printStackTrace</span><span class="token punctuation">(</span>PrintStream s<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">WrappedPrintStream</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span>  <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">printStackTrace</span><span class="token punctuation">(</span>PrintStreamOrWriter s<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token comment" spellcheck="true">// Guard against malicious overrides of Throwable.equals by</span>        <span class="token comment" spellcheck="true">// using a Set with identity equality semantics.</span>        Set<span class="token operator">&lt;</span>Throwable<span class="token operator">></span> dejaVu <span class="token operator">=</span>            Collections<span class="token punctuation">.</span><span class="token function">newSetFromMap</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">IdentityHashMap</span><span class="token operator">&lt;</span>Throwable<span class="token punctuation">,</span> Boolean<span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        dejaVu<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">synchronized</span> <span class="token punctuation">(</span>s<span class="token punctuation">.</span><span class="token function">lock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token comment" spellcheck="true">// Print our stack trace</span>            s<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            StackTraceElement<span class="token punctuation">[</span><span class="token punctuation">]</span> trace <span class="token operator">=</span> <span class="token function">getOurStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">for</span> <span class="token punctuation">(</span>StackTraceElement traceElement <span class="token operator">:</span> trace<span class="token punctuation">)</span>                s<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"\tat "</span> <span class="token operator">+</span> traceElement<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment" spellcheck="true">// Print suppressed exceptions, if any</span>            <span class="token keyword">for</span> <span class="token punctuation">(</span>Throwable se <span class="token operator">:</span> <span class="token function">getSuppressed</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>                se<span class="token punctuation">.</span><span class="token function">printEnclosedStackTrace</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span> trace<span class="token punctuation">,</span> SUPPRESSED_CAPTION<span class="token punctuation">,</span> <span class="token string">"\t"</span><span class="token punctuation">,</span> dejaVu<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment" spellcheck="true">// Print cause, if any</span>            Throwable ourCause <span class="token operator">=</span> <span class="token function">getCause</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>ourCause <span class="token operator">!=</span> null<span class="token punctuation">)</span>                ourCause<span class="token punctuation">.</span><span class="token function">printEnclosedStackTrace</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span> trace<span class="token punctuation">,</span> CAUSE_CAPTION<span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> dejaVu<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span> <span class="token keyword">public</span> String <span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        String s <span class="token operator">=</span> <span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        String message <span class="token operator">=</span> <span class="token function">getLocalizedMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token punctuation">(</span>message <span class="token operator">!=</span> null<span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token punctuation">(</span>s <span class="token operator">+</span> <span class="token string">": "</span> <span class="token operator">+</span> message<span class="token punctuation">)</span> <span class="token operator">:</span> s<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">public</span> String <span class="token function">getLocalizedMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">return</span> <span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//message   getMessage()方法子类重写父类  getMsg()</span><span class="token punctuation">}</span></code></pre><h2 id="2、多线程"><a href="#2、多线程" class="headerlink" title="2、多线程"></a>2、多线程</h2><h3 id="2-1-进程和线程"><a href="#2-1-进程和线程" class="headerlink" title="2.1 进程和线程"></a>2.1 进程和线程</h3><pre class=" language-java"><code class="language-java">进程：一个独立的应用程序，有独立的内存空间。线程：一个进程有多个线程组合在一起的，这多个线程就共用一个进程的空间。<span class="token operator">--</span><span class="token operator">-</span>线程安全的问题    单核和多核：cpu的个数    单核cpu<span class="token operator">:</span> 只能并发    多核cpu<span class="token operator">:</span>并行<span class="token operator">+</span>并发<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TestMain</span> <span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"hello world"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">//获取一下线程----万物皆对象---线程也是对象</span>        Thread main <span class="token operator">=</span> Thread<span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//当前线程</span>        main<span class="token punctuation">.</span><span class="token function">setName</span><span class="token punctuation">(</span><span class="token string">"主线程"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>main<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//线程编号</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>main<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//线程名字</span>        main<span class="token punctuation">.</span><span class="token function">setPriority</span><span class="token punctuation">(</span>Thread<span class="token punctuation">.</span>MAX_PRIORITY<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//1-10  优先级范围是1-10，默认是5</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>main<span class="token punctuation">.</span><span class="token function">getPriority</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//线程优先级</span>        <span class="token comment" spellcheck="true">//main.setDaemon(false);//自己创建的其他线程可以设为守护线程，但是线程不可以</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>main<span class="token punctuation">.</span><span class="token function">getState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//线程状态--RUNNABLE</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>main<span class="token punctuation">.</span><span class="token function">isAlive</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//线程是否还活着</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>main<span class="token punctuation">.</span><span class="token function">isDaemon</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//是否是守护线程</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>main<span class="token punctuation">.</span><span class="token function">hashCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//hashcode</span>        <span class="token comment" spellcheck="true">//注意这个不是单线程程序，只能说只有一个主线程，还有很多守护线程</span>        <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                    <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span>             </code></pre><h3 id="2-2-为什么要编写多线程的程序"><a href="#2-2-为什么要编写多线程的程序" class="headerlink" title="2.2 为什么要编写多线程的程序"></a>2.2 为什么要编写多线程的程序</h3><pre class=" language-java"><code class="language-java">什么线程：一个线程就是一个任务<span class="token number">1</span>、让cpu更好的工作<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span>压榨cpu<span class="token operator">--</span><span class="token operator">--</span>多个cpu可以同时执行多个任务。单核是不是就没必要多线程，当然是错的，单核也需要多线程。   下象棋和放音乐都可以并发走，那么也需要多线程程序。<span class="token number">2</span>、多线程可以简化编程模型<span class="token operator">--</span><span class="token operator">--</span>聊天室</code></pre><h3 id="2-3-如何编写多线程程序"><a href="#2-3-如何编写多线程程序" class="headerlink" title="2.3 如何编写多线程程序"></a>2.3 如何编写多线程程序</h3><pre class=" language-java"><code class="language-java">创建线程有四种方案： 继承类<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyThread</span> <span class="token keyword">extends</span> <span class="token class-name">Thread</span><span class="token punctuation">{</span> <span class="token comment" spellcheck="true">//给线程一个任务</span> <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>     <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">&lt;=</span><span class="token number">100</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>         System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>Thread<span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">"--"</span><span class="token operator">+</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TestMyThread</span> <span class="token punctuation">{</span> <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>     MyThread th1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MyThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     MyThread th2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MyThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     th1<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//启动线程----启动线程完成任务 --开辟了一个线程</span>     th2<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//启动线程----启动线程完成任务 --开辟了一个线程</span> <span class="token punctuation">}</span><span class="token punctuation">}</span>    实现Runnable接口<span class="token comment" spellcheck="true">//线程就是一个类，我们自己的类要变成一个线程类---Thread</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyThread</span> <span class="token keyword">implements</span> <span class="token class-name">Runnable</span><span class="token punctuation">{</span> <span class="token comment" spellcheck="true">//给线程一个任务</span> <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>     <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">&lt;=</span><span class="token number">100</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>         System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>Thread<span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">"--"</span><span class="token operator">+</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TestMyThread</span> <span class="token punctuation">{</span> <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>     MyThread mth <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MyThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//创建Runnable对象</span>     <span class="token comment" spellcheck="true">//原来继承Thread类，他有start方法，我们可以直接调用</span>     Thread th <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span>mth<span class="token punctuation">)</span><span class="token punctuation">;</span>     th<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">}</span>继承Thread类的方式是把Thread当做父亲，实现Runnable接口的方式，有点像给Thread类做上门女婿。那么这两种方式哪种更好一些呢？ 我们用的更多的是实现Runnable接口的方式。 原因有二： <span class="token number">1</span>、java是单继承，如果这个类已经有父类，那你就不能通过继承的方式来实现多线程。 <span class="token number">2</span>、实现接口可以方便的实现线程数据共享。需求： 有<span class="token number">10</span>个数字，用两个线程去输出这十个数字。<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyThread</span>  <span class="token keyword">implements</span> <span class="token class-name">Runnable</span> <span class="token punctuation">{</span> <span class="token keyword">int</span> num <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//初始值</span> <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>     <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>         <span class="token keyword">if</span><span class="token punctuation">(</span>num<span class="token operator">></span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>             <span class="token keyword">break</span><span class="token punctuation">;</span>         <span class="token punctuation">}</span>         System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>Thread<span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">"输出："</span><span class="token operator">+</span>num<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Test</span> <span class="token punctuation">{</span> <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>     MyThread mth <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MyThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     Thread th1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span>mth<span class="token punctuation">)</span><span class="token punctuation">;</span>     Thread th2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span>mth<span class="token punctuation">)</span><span class="token punctuation">;</span>     th1<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     th2<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">}</span>    实现callable接口 线程池 线程使用的步骤： 写线程类   <span class="token operator">--</span><span class="token operator">--</span>》   创建线程对象  <span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>》 启动线程任务  继承后修改线程名字： <span class="token number">1</span>、<span class="token function">setName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token number">2</span>、MyThread th2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MyThread</span><span class="token punctuation">(</span><span class="token string">"线程2"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">public</span> <span class="token function">MyThread</span><span class="token punctuation">(</span>String name<span class="token punctuation">)</span> <span class="token punctuation">{</span>     <span class="token keyword">super</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>实现接口的方式修改名字：Thread th <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span>mth<span class="token punctuation">,</span><span class="token string">"新线程"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><h3 id="2-4-线程的生命周期"><a href="#2-4-线程的生命周期" class="headerlink" title="2.4 线程的生命周期"></a>2.4 线程的生命周期</h3><p><img src="C:\Users\Lenovo\Desktop\新建文件夹\images\image-20221121163527631.png" alt="image-20221121163527631"></p><p>注意：1、阻塞之后不是进到运行状态，而是就绪状态，等资源</p><p>​             2、一个线程只能start一次，启动之后就只有等死</p><h3 id="2-5-线程调度"><a href="#2-5-线程调度" class="headerlink" title="2.5 线程调度"></a>2.5 线程调度</h3><p>​        线程调度的意思是：我们的线程启动之后是不受控制，他们都希望自己快速跑完run方法，大家就会无序的去抢资源。线程调度就是让某些线程按照预定的规则去执行，而不是杂乱无章的去抢资源。</p><p>​      调用线程的方法来调度。</p><pre class=" language-java"><code class="language-java"><span class="token number">1</span>、<span class="token function">setPriority</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">-</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token operator">:</span>通过设值优先级来设置线程执行的概率<span class="token number">2</span>、Thread<span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span>毫秒数<span class="token punctuation">)</span><span class="token operator">:</span>线程休眠<span class="token number">3</span>、线程礼让：Thread<span class="token punctuation">.</span><span class="token function">yeild</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span>释放cpu，同时又去抢cpu<span class="token number">4</span>、线程加入：th<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span>让th这个线程先执行完再执行被阻塞的线程<span class="token number">5</span>、线程中断：<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyThread</span> <span class="token keyword">extends</span> <span class="token class-name">Thread</span><span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token comment" spellcheck="true">//任务是死循环，不断检测中断信号，别人发中断信号了，我们就结束循环</span>        <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">isInterrupted</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">==</span><span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token comment" spellcheck="true">//检测中断信号</span>                <span class="token keyword">break</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Test</span> <span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>        Scanner input <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Scanner</span><span class="token punctuation">(</span>System<span class="token punctuation">.</span>in<span class="token punctuation">)</span><span class="token punctuation">;</span>        MyThread th <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MyThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        th<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"是否中断？y/n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">char</span> choice <span class="token operator">=</span> input<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>choice<span class="token operator">==</span><span class="token string">'y'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token comment" spellcheck="true">//调用线程中断的代码</span>            th<span class="token punctuation">.</span><span class="token function">interrupt</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//中断线程---不能改变线程目前运行状态，只能改变线程的一个中断标记</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span>守护线程：    如果你不是守护线程，那么你的run方法要执行完才能虚拟机。    如果你是守护线程，那么其余的非守护线程执行完毕之后就会退出虚拟机。    <span class="token function">setDaemon</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token operator">:</span>设置线程为守护线程</code></pre><p>练习：</p><p>编写一个抽取学员回答问题的程序，要求倒数三秒后输出被抽中的学员姓名</p><p>i. 采用数组存储6个学员姓名 String[]</p><p>ii. 生成0-5之间的随机数，确定被抽中的学员</p><p>iii. 在屏幕每隔一秒，依次输出3，2，1，然后输出学员姓名</p><pre class=" language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> InterruptedException <span class="token punctuation">{</span>        String<span class="token punctuation">[</span><span class="token punctuation">]</span> names <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">"张三丰"</span><span class="token punctuation">,</span><span class="token string">"俞岱岩"</span><span class="token punctuation">,</span><span class="token string">"宋远桥"</span><span class="token punctuation">,</span><span class="token string">"张松溪"</span><span class="token punctuation">,</span><span class="token string">"张翠山"</span><span class="token punctuation">,</span><span class="token string">"殷梨亭"</span><span class="token punctuation">}</span><span class="token punctuation">;</span>        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">;</span>i<span class="token operator">></span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">--</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            Thread<span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//休眠</span>            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token keyword">int</span> num <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Random</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>names<span class="token punctuation">[</span>num<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><h3 id="2-6-Callable"><a href="#2-6-Callable" class="headerlink" title="2.6 Callable"></a>2.6 Callable</h3><p>a) 计算任务，一个包含了2万个整数的数组，分拆了多个线程来进行并行计算，最后汇总出计算的结果。</p><h4 id="方案1：Runnable接口"><a href="#方案1：Runnable接口" class="headerlink" title="方案1：Runnable接口"></a>方案1：Runnable接口</h4><pre class=" language-java"><code class="language-java">Runnable接口：线程只管计算   <span class="token comment" spellcheck="true">/*** 这个类的任务是计算数组的元素和---你给我一个数组，我给你这个数组的元素和*/</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SumTask</span> <span class="token keyword">implements</span> <span class="token class-name">Runnable</span> <span class="token punctuation">{</span>   <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> nums<span class="token punctuation">;</span>   <span class="token keyword">int</span> sum <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>   <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>       <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>nums<span class="token punctuation">.</span>length<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>           sum <span class="token operator">+=</span> nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>       <span class="token punctuation">}</span>   <span class="token punctuation">}</span>   <span class="token comment" spellcheck="true">//构造方法来接收任务数组</span>   <span class="token keyword">public</span> <span class="token function">SumTask</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> nums<span class="token punctuation">)</span> <span class="token punctuation">{</span>       <span class="token keyword">this</span><span class="token punctuation">.</span>nums <span class="token operator">=</span> nums<span class="token punctuation">;</span>   <span class="token punctuation">}</span><span class="token punctuation">}</span>    主线程分配个子线程任务 <span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Test</span> <span class="token punctuation">{</span>   <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> InterruptedException <span class="token punctuation">{</span>       <span class="token comment" spellcheck="true">// 10000个数</span>       <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> nums <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">int</span><span class="token punctuation">[</span><span class="token number">10000</span><span class="token punctuation">]</span><span class="token punctuation">;</span>       <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> nums<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>           nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// 1-10000-----50005000</span>       <span class="token punctuation">}</span>       <span class="token comment" spellcheck="true">// 分配任务--先不考虑分配不完全的情况-----4</span>       <span class="token comment" spellcheck="true">// 第一个任务0-2499</span>       <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> nums1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">int</span><span class="token punctuation">[</span><span class="token number">2500</span><span class="token punctuation">]</span><span class="token punctuation">;</span>       <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">2500</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>           nums1<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>       <span class="token punctuation">}</span>       SumTask st1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SumTask</span><span class="token punctuation">(</span>nums1<span class="token punctuation">)</span><span class="token punctuation">;</span>       Thread th1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span>st1<span class="token punctuation">)</span><span class="token punctuation">;</span>       th1<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// 这里启动就会自动计算第一个数组的结果</span>       <span class="token comment" spellcheck="true">//th1.join();//这里写就是单线程</span>       <span class="token comment" spellcheck="true">// 第二个任务2500-4999</span>       <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> nums2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">int</span><span class="token punctuation">[</span><span class="token number">2500</span><span class="token punctuation">]</span><span class="token punctuation">;</span>       <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">2500</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>           nums2<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> nums<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">2500</span><span class="token punctuation">]</span><span class="token punctuation">;</span>       <span class="token punctuation">}</span>       SumTask st2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SumTask</span><span class="token punctuation">(</span>nums2<span class="token punctuation">)</span><span class="token punctuation">;</span>       Thread th2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span>st2<span class="token punctuation">)</span><span class="token punctuation">;</span>       th2<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// 这里启动就会自动计算第二个数组的结果</span>       <span class="token comment" spellcheck="true">// 第三个任务5000-7499</span>       <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> nums3 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">int</span><span class="token punctuation">[</span><span class="token number">2500</span><span class="token punctuation">]</span><span class="token punctuation">;</span>       <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">2500</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>           nums3<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> nums<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">5000</span><span class="token punctuation">]</span><span class="token punctuation">;</span>       <span class="token punctuation">}</span>       SumTask st3 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SumTask</span><span class="token punctuation">(</span>nums3<span class="token punctuation">)</span><span class="token punctuation">;</span>       Thread th3 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span>st3<span class="token punctuation">)</span><span class="token punctuation">;</span>       th3<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// 这里启动就会自动计算第三个数组的结果</span>       <span class="token comment" spellcheck="true">// 第四个任务7500-9999</span>       <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> nums4 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">int</span><span class="token punctuation">[</span><span class="token number">2500</span><span class="token punctuation">]</span><span class="token punctuation">;</span>       <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">2500</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>           nums4<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> nums<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">7500</span><span class="token punctuation">]</span><span class="token punctuation">;</span>       <span class="token punctuation">}</span>       SumTask st4 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SumTask</span><span class="token punctuation">(</span>nums4<span class="token punctuation">)</span><span class="token punctuation">;</span>       Thread th4 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span>st4<span class="token punctuation">)</span><span class="token punctuation">;</span>       th4<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// 这里启动就会自动计算第四个数组的结果</span>       <span class="token comment" spellcheck="true">//Thread.sleep(100);//等任务完成--不合理，开多个线程的目的是为了提高效率</span>       <span class="token comment" spellcheck="true">//是多线程</span>       th1<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//th1加入来阻塞主线程，他阻不阻塞th2,th3,th4？--不阻塞</span>       th2<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       th3<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       th4<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token comment" spellcheck="true">//最终的结果</span>       <span class="token keyword">int</span> sum <span class="token operator">=</span> st1<span class="token punctuation">.</span>sum<span class="token operator">+</span>st2<span class="token punctuation">.</span>sum<span class="token operator">+</span>st3<span class="token punctuation">.</span>sum<span class="token operator">+</span>st4<span class="token punctuation">.</span>sum<span class="token punctuation">;</span>       System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>sum<span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token punctuation">}</span><span class="token punctuation">}</span>把分配任务改为循环实现，并且任务数变为<span class="token number">10</span>。<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TestCount</span> <span class="token punctuation">{</span>   <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> InterruptedException <span class="token punctuation">{</span>       <span class="token comment" spellcheck="true">// 10000个数</span>       <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> nums <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">int</span><span class="token punctuation">[</span><span class="token number">10000</span><span class="token punctuation">]</span><span class="token punctuation">;</span>       <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> nums<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>           nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// 1-10000-----50005000</span>       <span class="token punctuation">}</span>       <span class="token keyword">int</span> count <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//任务数</span>       <span class="token keyword">int</span> sum <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//总和</span>       Map<span class="token operator">&lt;</span>Thread<span class="token punctuation">,</span>SumTask<span class="token operator">></span> map <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token operator">&lt;</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token comment" spellcheck="true">// 分配任务--先不考虑分配不完全的情况-----10---启动</span>       <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span><span class="token number">10</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>           <span class="token comment" spellcheck="true">//分配任务</span>           <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> numsTask <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">int</span><span class="token punctuation">[</span>nums<span class="token punctuation">.</span>length<span class="token operator">/</span>count<span class="token punctuation">]</span><span class="token punctuation">;</span>           <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> numsTask<span class="token punctuation">.</span>length<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>               numsTask<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> nums<span class="token punctuation">[</span>j <span class="token operator">+</span> nums<span class="token punctuation">.</span>length<span class="token operator">/</span>count<span class="token operator">*</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>           <span class="token punctuation">}</span>           SumTask st <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SumTask</span><span class="token punctuation">(</span>numsTask<span class="token punctuation">)</span><span class="token punctuation">;</span>           Thread th <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span>st<span class="token punctuation">)</span><span class="token punctuation">;</span>           th<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// 这里启动就会自动计算第i个数组的结果</span>           map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>th<span class="token punctuation">,</span> st<span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token punctuation">}</span>       <span class="token keyword">for</span><span class="token punctuation">(</span>Thread th<span class="token operator">:</span>map<span class="token punctuation">.</span><span class="token function">keySet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>           th<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>           sum <span class="token operator">+=</span> map<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>th<span class="token punctuation">)</span><span class="token punctuation">.</span>sum<span class="token punctuation">;</span>       <span class="token punctuation">}</span>       System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>sum<span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token punctuation">}</span><span class="token punctuation">}</span>      </code></pre><h4 id="方案2：Callable来计算"><a href="#方案2：Callable来计算" class="headerlink" title="方案2：Callable来计算"></a>方案2：Callable来计算</h4><p>Runnable的缺陷：</p><p>​    1、不能抛异常</p><p>​     2、run方法没有返回值</p><pre class=" language-java"><code class="language-java">任务类：    <span class="token comment" spellcheck="true">/** * 这个类的任务是计算数组的元素和---你给我一个数组，我给你这个数组的元素和 */</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SumTask</span> <span class="token keyword">implements</span> <span class="token class-name">Callable</span><span class="token operator">&lt;</span>Integer<span class="token operator">></span> <span class="token punctuation">{</span>    <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> nums<span class="token punctuation">;</span>    <span class="token keyword">public</span> Integer <span class="token function">call</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">int</span> sum <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>nums<span class="token punctuation">.</span>length<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            sum <span class="token operator">+=</span> nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token keyword">return</span> sum<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true">//构造方法来接收任务数组</span>    <span class="token keyword">public</span> <span class="token function">SumTask</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> nums<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>nums <span class="token operator">=</span> nums<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">public</span> <span class="token function">SumTask</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span>计算：<span class="token comment" spellcheck="true">//map-reduce  : map映射-分解   reduce:合并</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TestCount</span> <span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> InterruptedException<span class="token punctuation">,</span> ExecutionException <span class="token punctuation">{</span>        <span class="token comment" spellcheck="true">// 10000个数</span>        <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> nums <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">int</span><span class="token punctuation">[</span><span class="token number">10000</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> nums<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// 1-10000-----50005000</span>        <span class="token punctuation">}</span>        <span class="token keyword">int</span> count <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//任务数</span>        <span class="token keyword">int</span> sum <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//总和</span>        <span class="token comment" spellcheck="true">//Map&lt;Thread,SumTask> map = new HashMap&lt;>();</span>        List<span class="token operator">&lt;</span>FutureTask<span class="token operator">></span> fts <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token operator">&lt;</span>FutureTask<span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">// 分配任务--先不考虑分配不完全的情况-----10---启动</span>        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>count<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token comment" spellcheck="true">//分配任务</span>            <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> numsTask <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">int</span><span class="token punctuation">[</span>nums<span class="token punctuation">.</span>length<span class="token operator">/</span>count<span class="token punctuation">]</span><span class="token punctuation">;</span>            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> numsTask<span class="token punctuation">.</span>length<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                numsTask<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> nums<span class="token punctuation">[</span>j <span class="token operator">+</span> nums<span class="token punctuation">.</span>length<span class="token operator">/</span>count<span class="token operator">*</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>            SumTask st <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SumTask</span><span class="token punctuation">(</span>numsTask<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment" spellcheck="true">//人在屋檐下，不得不低头--把Callable伪装成Runnable</span>            FutureTask<span class="token operator">&lt;</span>Integer<span class="token operator">></span> ft <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FutureTask</span><span class="token operator">&lt;</span>Integer<span class="token operator">></span><span class="token punctuation">(</span>st<span class="token punctuation">)</span><span class="token punctuation">;</span>            Thread th <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span>ft<span class="token punctuation">)</span><span class="token punctuation">;</span>            th<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            fts<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>ft<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//这里保存对象是为了待会获取结果</span>            <span class="token comment" spellcheck="true">//sum+=ft.get();//获取结果，由于get代码会阻塞，等到call方法执行完再执行</span>        <span class="token punctuation">}</span>        <span class="token keyword">for</span><span class="token punctuation">(</span>FutureTask<span class="token operator">&lt;</span>Integer<span class="token operator">></span> ft <span class="token operator">:</span> fts<span class="token punctuation">)</span> <span class="token punctuation">{</span>            sum <span class="token operator">+=</span> ft<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//算完一个取一个  天生阻塞，等到call方法执行完再获取结果</span>        <span class="token punctuation">}</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>sum<span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token punctuation">}</span><span class="token punctuation">}</span>Runnable：执行完任务不返回结果Callable<span class="token operator">:</span>执行完任务需要返回结果</code></pre><h3 id="2-7-线程安全"><a href="#2-7-线程安全" class="headerlink" title="2.7 线程安全"></a>2.7 线程安全</h3><p>b) 铁道部发布了一个售票任务，要求销售1000张票，要求有3个窗口来进行销售，请编写多线程程序来模拟这个卖票效果</p><p>i. 窗口001正在销售第1000张票</p><p>ii. 窗口001正在销售第999张票</p><p>iii. 窗口002正在销售第998张票</p><p>iv. 。。。</p><p>v. 窗口002正在销售第1张票</p><p>vi. 票已经销售完毕</p><pre class=" language-java"><code class="language-java">线程是任务：    每一个线程就买票<span class="token operator">--</span><span class="token operator">--</span>把总票数<span class="token operator">-</span><span class="token number">1</span>，把买到编号<span class="token operator">+</span><span class="token number">1</span>    任务：窗口不断的卖票    这里是使用同步代码块<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Site</span> <span class="token keyword">implements</span> <span class="token class-name">Runnable</span> <span class="token punctuation">{</span>        <span class="token keyword">int</span> num <span class="token operator">=</span> <span class="token number">1000</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//共享十张票</span>    <span class="token keyword">int</span> count <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//第几张票</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">synchronized</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token comment" spellcheck="true">//加锁---有一个线程进到这个代码里面，其余线程就进不来了</span>                <span class="token keyword">if</span> <span class="token punctuation">(</span>num <span class="token operator">&lt;=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token comment" spellcheck="true">//num==0---死循环</span>                    System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>Thread<span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span><span class="token string">"售罄"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                    <span class="token keyword">break</span><span class="token punctuation">;</span>                <span class="token punctuation">}</span>                <span class="token comment" spellcheck="true">//有票</span>                num<span class="token operator">--</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//票的总数-1</span>                count<span class="token operator">++</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//票号+1</span>                System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>Thread<span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"卖出了第"</span> <span class="token operator">+</span> count <span class="token operator">+</span> <span class="token string">"张票，还剩："</span> <span class="token operator">+</span> num <span class="token operator">+</span> <span class="token string">"张票"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Test</span> <span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>        Site site <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Site</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        Thread th1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span>site<span class="token punctuation">,</span><span class="token string">"去哪儿"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        Thread th2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span>site<span class="token punctuation">,</span><span class="token string">"携程"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        Thread th3 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span>site<span class="token punctuation">,</span><span class="token string">"火车站"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        th1<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        th2<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        th3<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span>同步方法：     <span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SiteMethod</span> <span class="token keyword">implements</span> <span class="token class-name">Runnable</span> <span class="token punctuation">{</span>    <span class="token keyword">int</span> num <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// 共享十张票</span>    <span class="token keyword">int</span> count <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// 第几张票</span>        <span class="token keyword">boolean</span> flag <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">while</span> <span class="token punctuation">(</span>flag<span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token function">sale</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>        <span class="token comment" spellcheck="true">//同步方法--某个线程进了这个方法别的线程就进不来了</span>    <span class="token keyword">public</span> <span class="token keyword">synchronized</span> <span class="token keyword">void</span> <span class="token function">sale</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>num <span class="token operator">&lt;=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token comment" spellcheck="true">// num==0---死循环</span>            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>Thread<span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"售罄"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            flag <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>            <span class="token keyword">return</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token comment" spellcheck="true">// 有票</span>        num<span class="token operator">--</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// 票的总数-1</span>        count<span class="token operator">++</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// 票号+1</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>Thread<span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"卖出了第"</span> <span class="token operator">+</span> count <span class="token operator">+</span> <span class="token string">"张票，还剩："</span> <span class="token operator">+</span> num <span class="token operator">+</span> <span class="token string">"张票"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Test</span> <span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>        SiteMethod site <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SiteMethod</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        Thread th1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span>site<span class="token punctuation">,</span><span class="token string">"去哪儿"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        Thread th2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span>site<span class="token punctuation">,</span><span class="token string">"携程"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        Thread th3 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span>site<span class="token punctuation">,</span><span class="token string">"火车站"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        th1<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        th2<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        th3<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span>   Lock    加锁会导致效率降低</code></pre><h3 id="2-8-线程不安全"><a href="#2-8-线程不安全" class="headerlink" title="2.8 线程不安全"></a>2.8 线程不安全</h3><h4 id="2-8-1-懒汉单例是不安全"><a href="#2-8-1-懒汉单例是不安全" class="headerlink" title="2.8.1  懒汉单例是不安全"></a>2.8.1  懒汉单例是不安全</h4><pre class=" language-java"><code class="language-java"><span class="token comment" spellcheck="true">//懒汉单例模式</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Student</span> <span class="token punctuation">{</span>    <span class="token keyword">private</span> <span class="token function">Student</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>    <span class="token comment" spellcheck="true">//private static Student s=new Student();</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> Student s <span class="token operator">=</span> null<span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> Student <span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>s<span class="token operator">==</span>null<span class="token punctuation">)</span> <span class="token punctuation">{</span>            s <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Student</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token keyword">return</span> s<span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">&lt;=</span><span class="token number">3</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Runnable</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                    System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>Student<span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token punctuation">}</span>            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span><span class="token punctuation">}</span></code></pre><h4 id="2-8-2-ArrayList是线程不安全的"><a href="#2-8-2-ArrayList是线程不安全的" class="headerlink" title="2.8.2 ArrayList是线程不安全的"></a>2.8.2 ArrayList是线程不安全的</h4><pre class=" language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TestArrayList</span> <span class="token punctuation">{</span>        <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> InterruptedException <span class="token punctuation">{</span>        ArrayList<span class="token operator">&lt;</span>String<span class="token operator">></span> list <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token operator">&lt;</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        Thread th1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Runnable</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">"a"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        Thread th2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Runnable</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">"b"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        Thread th3 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Runnable</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">"c"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        th1<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        th2<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        th3<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        th1<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        th2<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        th3<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>list<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">[</span>b<span class="token punctuation">,</span>a<span class="token punctuation">]</span>  <span class="token punctuation">[</span>a<span class="token punctuation">,</span>c<span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span>null<span class="token punctuation">,</span> c<span class="token punctuation">,</span> a<span class="token punctuation">]</span> <span class="token punctuation">[</span>null<span class="token punctuation">,</span>c<span class="token punctuation">]</span> <span class="token punctuation">[</span>null<span class="token punctuation">,</span>null<span class="token punctuation">,</span>c<span class="token punctuation">]</span>  <span class="token punctuation">[</span>b<span class="token punctuation">]</span>    elementData<span class="token punctuation">[</span>size<span class="token operator">++</span><span class="token punctuation">]</span> <span class="token operator">=</span> e<span class="token punctuation">;</span><span class="token comment" spellcheck="true">//这个代码执行三次，size=1?</span>    <span class="token punctuation">[</span>null<span class="token punctuation">,</span> c<span class="token punctuation">,</span> a<span class="token punctuation">]</span><span class="token operator">:</span>  size<span class="token operator">++</span>   内存    <span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span>        Vector保证线程安全是通过所有代码都<span class="token keyword">synchronized</span>     CopyOnWriteArrayList<span class="token operator">:</span>线程安全的类，如果你的集合在高并发下要保证线程安全，那么你可以用这个类。Hashtable<span class="token operator">--</span><span class="token operator">-</span><span class="token keyword">synchronized</span>HashMap<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>未同步<span class="token operator">--</span><span class="token operator">-</span>不安全ConcurrentHashMap<span class="token operator">--</span><span class="token operator">--</span>安全    <span class="token number">1</span>、table使用<span class="token keyword">volatile</span>修饰保证指令重排和可见性。    <span class="token number">2</span>、casAt    cas<span class="token operator">:</span> Compare and Swap  通过保存原值来做到数据安全   ABA问题  Versioncas 是一种乐观锁<span class="token operator">--</span><span class="token operator">--</span>他认为我修改的时候别人多半不会修改<span class="token operator">--</span><span class="token operator">--</span>高并发下会导致空转    <span class="token number">3</span>、<span class="token keyword">synchronized</span> <span class="token operator">:</span> 排他锁 cas <span class="token operator">+</span> 分段锁</code></pre><h3 id="2-9-死锁"><a href="#2-9-死锁" class="headerlink" title="2.9 死锁"></a>2.9 死锁</h3><pre class=" language-java"><code class="language-java">死锁：当线程需要多个资源的时候，一个线程获取到一部分资源，另外一个线程获取到另外一部分资源，这时候就会产生死锁。    案例：<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Dead</span> <span class="token keyword">implements</span> <span class="token class-name">Runnable</span><span class="token punctuation">{</span>    <span class="token comment" spellcheck="true">//设计两个资源</span>    Integer a<span class="token punctuation">;</span><span class="token comment" spellcheck="true">//第一把锁</span>    Integer b<span class="token punctuation">;</span><span class="token comment" spellcheck="true">//第二把锁</span>    <span class="token keyword">public</span> <span class="token function">Dead</span><span class="token punctuation">(</span>Integer a<span class="token punctuation">,</span>Integer b<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>a <span class="token operator">=</span> a<span class="token punctuation">;</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>b <span class="token operator">=</span> b<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">synchronized</span> <span class="token punctuation">(</span>a<span class="token punctuation">)</span> <span class="token punctuation">{</span>            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>Thread<span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">"获取到"</span><span class="token operator">+</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">synchronized</span> <span class="token punctuation">(</span>b<span class="token punctuation">)</span> <span class="token punctuation">{</span>                System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>Thread<span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">"获取到"</span><span class="token operator">+</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span>                System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>a<span class="token operator">+</span><span class="token string">"+"</span><span class="token operator">+</span>b<span class="token operator">+</span><span class="token string">"="</span><span class="token operator">+</span><span class="token punctuation">(</span>a<span class="token operator">+</span>b<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span> <span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TestDead</span> <span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>        Dead d1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Dead</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//a=1,b=2</span>        Dead d2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Dead</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//a=2,b=1</span>        <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span>d1<span class="token punctuation">,</span><span class="token string">"线程1"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span>d2<span class="token punctuation">,</span><span class="token string">"线程2"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span></code></pre><p>作业：</p><pre class=" language-java"><code class="language-java">给你<span class="token number">1000</span>个时间  <span class="token number">1</span><span class="token operator">-</span><span class="token number">1000</span>  <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>     用线程格式化输出这个时间  yyyy<span class="token operator">-</span>MM<span class="token operator">-</span>dd  SimpleDateFormat用线程输出一个时间的格式。</code></pre><h3 id="2-10-线程池"><a href="#2-10-线程池" class="headerlink" title="2.10 线程池"></a>2.10 线程池</h3><h4 id="2-10-1-池的概念"><a href="#2-10-1-池的概念" class="headerlink" title="2.10.1  池的概念"></a>2.10.1  池的概念</h4><pre class=" language-java"><code class="language-java">juc<span class="token operator">:</span>Doug  Lea  道格<span class="token punctuation">.</span>利水池，装水的线程池：线程的池子连接池：装连接的  池子就是一个容器为什么需要线程池：    线程最大的缺点就是：        开启之后运行完就没啦        导致一个线程生命周期 初始化时间<span class="token operator">+</span>运行时间run<span class="token operator">+</span>销毁时间    线程就是任务，run方法完成任务。线程池就是让线程不死，不断运行任务。    招聘老师<span class="token operator">+</span>带班<span class="token operator">+</span>辞退<span class="token operator">--</span><span class="token operator">--</span>          教师团队 </code></pre><h4 id="2-10-2-自定义线程池的原理"><a href="#2-10-2-自定义线程池的原理" class="headerlink" title="2.10.2 自定义线程池的原理"></a>2.10.2 自定义线程池的原理</h4><pre class=" language-java"><code class="language-java">自定义一个线程池    ExecutorThreadPoolExecutor<span class="token keyword">int</span> corePoolSize<span class="token punctuation">,</span><span class="token keyword">int</span> maximumPoolSize<span class="token punctuation">,</span><span class="token keyword">long</span> keepAliveTime<span class="token punctuation">,</span>TimeUnit unit<span class="token punctuation">,</span>BlockingQueue<span class="token operator">&lt;</span>Runnable<span class="token operator">></span> workQueue    <span class="token comment" spellcheck="true">/*           int corePoolSize,--------核心线程个数           int maximumPoolSize,-----最大线程个数           long keepAliveTime,------保持存活时间           TimeUnit unit,-----------时间单位           BlockingQueue&lt;Runnable> workQueue---工作队列--任务队列         */</span>ThreadPoolExecutor pool <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ThreadPoolExecutor</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> TimeUnit<span class="token punctuation">.</span>SECONDS<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">ArrayBlockingQueue</span><span class="token operator">&lt;</span>Runnable<span class="token operator">></span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>             pool<span class="token punctuation">.</span><span class="token function">execute</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Runnable</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>Thread<span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">"--执行任务"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   用这个线程池执行十个任务，一个任务输出一个数字，十个线程输出<span class="token number">1</span><span class="token operator">-</span><span class="token number">10</span>   现象：      <span class="token number">1</span>、任务数量在<span class="token number">9</span>以内的时候，只有<span class="token number">5</span>个线程      <span class="token number">2</span>、任务数量在<span class="token number">14</span>以内的时候，<span class="token number">5</span><span class="token operator">-</span><span class="token number">10</span>个线程      <span class="token number">3</span>、任务数量在<span class="token number">15</span>以上的时候就出异常了    </code></pre><p><img src="C:\Users\Lenovo\Desktop\新建文件夹\images\image-20221123111005783.png" alt="image-20221123111005783"></p><pre class=" language-java"><code class="language-java">ThreadFactory threadFactory<span class="token punctuation">,</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>线程工厂<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>创建线程ThreadPoolExecutor pool <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ThreadPoolExecutor</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> TimeUnit<span class="token punctuation">.</span>SECONDS<span class="token punctuation">,</span>                <span class="token keyword">new</span> <span class="token class-name">ArrayBlockingQueue</span><span class="token operator">&lt;</span>Runnable<span class="token operator">></span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token keyword">new</span> <span class="token class-name">ThreadFactory</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                    <span class="token keyword">int</span> num<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>                    <span class="token keyword">public</span> Thread <span class="token function">newThread</span><span class="token punctuation">(</span>Runnable r<span class="token punctuation">)</span> <span class="token punctuation">{</span>                        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span>r<span class="token punctuation">,</span><span class="token string">"线程"</span><span class="token operator">+</span>num<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      RejectedExecutionHandler handler  <span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span> 拒绝策略<span class="token keyword">new</span> <span class="token class-name">ThreadPoolExecutor<span class="token punctuation">.</span>AbortPolicy</span><span class="token punctuation">(</span><span class="token punctuation">)</span>：默认拒绝策略是不执行并抛出异常<span class="token keyword">new</span> <span class="token class-name">ThreadPoolExecutor<span class="token punctuation">.</span>DiscardPolicy</span><span class="token punctuation">(</span><span class="token punctuation">)</span>：丢弃当前无法完成的任务<span class="token keyword">new</span> <span class="token class-name">ThreadPoolExecutor<span class="token punctuation">.</span>DiscardOldestPolicy</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span>丢掉最老的任务并且不抛异常<span class="token operator">--</span>队列里面的<span class="token keyword">new</span> <span class="token class-name">ThreadPoolExecutor<span class="token punctuation">.</span>CallerRunsPolicy</span><span class="token punctuation">(</span><span class="token punctuation">)</span>：调用者执行      <span class="token function">shutDown</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span>关闭，从这一刻起不接受新任务，原来的任务完成之后就关闭。      你准备一下，调你到另外的项目组，目前手头工作做完就过去。   <span class="token function">shutDownNow</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span>立即关闭：不接受新任务，同时把没有完成的任务打包放到List集合中返出去      你准备一下，立马调你到另外的项目组，目前手头工作立即移交出去。         线程池最核心的是核心线程数：         这个核心线程数给多少合理？如果太多，内存消耗太大，如果太少，随时在开线程，销毁线程。         经验估算         公式 ：            IO密集型任务：读写  核数<span class="token operator">*</span><span class="token number">100</span>            Cpu密集型任务：计算   核数<span class="token operator">*</span><span class="token number">8</span>         压测   </code></pre><h4 id="2-10-3-自动创建线程池"><a href="#2-10-3-自动创建线程池" class="headerlink" title="2.10.3 自动创建线程池"></a>2.10.3 自动创建线程池</h4><pre class=" language-java"><code class="language-java"><span class="token number">1</span>、ExecutorService pool <span class="token operator">=</span> Executors<span class="token punctuation">.</span><span class="token function">newSingleThreadExecutor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//创建一个单线程的线程池</span><span class="token keyword">new</span> <span class="token class-name">ThreadPoolExecutor</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span>0L<span class="token punctuation">,</span> TimeUnit<span class="token punctuation">.</span>MILLISECONDS<span class="token punctuation">,</span><span class="token keyword">new</span> <span class="token class-name">LinkedBlockingQueue</span><span class="token operator">&lt;</span>Runnable<span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>特点：只有一个线程，队列无限大    演示内存溢出：  VM<span class="token operator">:</span><span class="token operator">-</span>Xms4m<span class="token operator">-</span>Xmx4m<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TestPool</span> <span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>         ExecutorService pool <span class="token operator">=</span> Executors<span class="token punctuation">.</span><span class="token function">newSingleThreadExecutor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//创建一个单线程的线程池</span>         <span class="token comment" spellcheck="true">//队列无线大，当任务如果很多，队列一直放，就会导致内存溢出</span>         <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">&lt;=</span>Integer<span class="token punctuation">.</span>MAX_VALUE<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>             <span class="token keyword">int</span> temp <span class="token operator">=</span> i<span class="token punctuation">;</span>             pool<span class="token punctuation">.</span><span class="token function">execute</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Runnable</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                    <span class="token keyword">try</span> <span class="token punctuation">{</span>                        Thread<span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">666666666</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>                        <span class="token comment" spellcheck="true">// TODO Auto-generated catch block</span>                        e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                    <span class="token punctuation">}</span>                    <span class="token comment" spellcheck="true">//System.out.println(Thread.currentThread().getName()+"---"+temp);</span>                <span class="token punctuation">}</span>            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>         <span class="token punctuation">}</span>             <span class="token punctuation">}</span><span class="token punctuation">}</span> <span class="token number">2</span>、ExecutorService pool <span class="token operator">=</span> Executors<span class="token punctuation">.</span><span class="token function">newFixedThreadPool</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//创建一个单线程的线程池</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TestFix</span> <span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>         ExecutorService pool <span class="token operator">=</span> Executors<span class="token punctuation">.</span><span class="token function">newFixedThreadPool</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//创建一个单线程的线程池</span>         <span class="token comment" spellcheck="true">//队列无线大，当任务如果很多，队列一直放，就会导致内存溢出</span>         <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">&lt;=</span><span class="token number">1000</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>             <span class="token keyword">int</span> temp <span class="token operator">=</span> i<span class="token punctuation">;</span>             pool<span class="token punctuation">.</span><span class="token function">execute</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Runnable</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                    System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>Thread<span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">"---"</span><span class="token operator">+</span>temp<span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token punctuation">}</span>            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>         <span class="token punctuation">}</span>             <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">public</span> <span class="token keyword">static</span> ExecutorService <span class="token function">newFixedThreadPool</span><span class="token punctuation">(</span><span class="token keyword">int</span> nThreads<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">ThreadPoolExecutor</span><span class="token punctuation">(</span>nThreads<span class="token punctuation">,</span> nThreads<span class="token punctuation">,</span>                                      0L<span class="token punctuation">,</span> TimeUnit<span class="token punctuation">.</span>MILLISECONDS<span class="token punctuation">,</span>                                      <span class="token keyword">new</span> <span class="token class-name">LinkedBlockingQueue</span><span class="token operator">&lt;</span>Runnable<span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span>特点：核心线程<span class="token operator">=</span>最大线程<span class="token operator">=</span>n<span class="token punctuation">,</span>队列无线     <span class="token number">3</span>、ExecutorService pool <span class="token operator">=</span> Executors<span class="token punctuation">.</span><span class="token function">newCachedThreadPool</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token keyword">public</span> <span class="token keyword">static</span> ExecutorService <span class="token function">newCachedThreadPool</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">ThreadPoolExecutor</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> Integer<span class="token punctuation">.</span>MAX_VALUE<span class="token punctuation">,</span>                                      60L<span class="token punctuation">,</span> TimeUnit<span class="token punctuation">.</span>SECONDS<span class="token punctuation">,</span>                                      <span class="token keyword">new</span> <span class="token class-name">SynchronousQueue</span><span class="token operator">&lt;</span>Runnable<span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span>  特点：核心线程为<span class="token number">0</span>，最大线程无线，60s回收无任务的线程，队列是同步队列（自身没有缓存功能）    <span class="token number">4</span>、定时执行的线程池<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TestSchedule</span> <span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>        ScheduledExecutorService pool <span class="token operator">=</span> Executors<span class="token punctuation">.</span><span class="token function">newScheduledThreadPool</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">//后台的定时器--以固定的频率</span>        pool<span class="token punctuation">.</span><span class="token function">scheduleAtFixedRate</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Runnable</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"重复执行的代码"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> TimeUnit<span class="token punctuation">.</span>SECONDS<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//第一次等两秒，后面每秒钟执行一下run里代码</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span> 核心线程和最大线程指定，队列是可以按照任务等待时间排序，可以实现任务的循环调用   </code></pre><h4 id="2-10-4-源码分析"><a href="#2-10-4-源码分析" class="headerlink" title="2.10.4  源码分析"></a>2.10.4  源码分析</h4><pre class=" language-java"><code class="language-java">印证一下上午分析的原理是否正确  <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">execute</span><span class="token punctuation">(</span>Runnable command<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>command <span class="token operator">==</span> null<span class="token punctuation">)</span>            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">NullPointerException</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">/*         * Proceed in 3 steps:         *         * 1. If fewer than corePoolSize threads are running, try to         * start a new thread with the given command as its first         * task.  The call to addWorker atomically checks runState and         * workerCount, and so prevents false alarms that would add         * threads when it shouldn't, by returning false.         *         * 2. If a task can be successfully queued, then we still need         * to double-check whether we should have added a thread         * (because existing ones died since last checking) or that         * the pool shut down since entry into this method. So we         * recheck state and if necessary roll back the enqueuing if         * stopped, or start a new thread if there are none.         *         * 3. If we cannot queue task, then we try to add a new         * thread.  If it fails, we know we are shut down or saturated         * and so reject the task.         */</span>        <span class="token keyword">int</span> c <span class="token operator">=</span> ctl<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">workerCountOf</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span> <span class="token operator">&lt;</span> corePoolSize<span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">addWorker</span><span class="token punctuation">(</span>command<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">//true代表核心线程以内</span>                <span class="token keyword">return</span><span class="token punctuation">;</span>            c <span class="token operator">=</span> ctl<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isRunning</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> workQueue<span class="token punctuation">.</span><span class="token function">offer</span><span class="token punctuation">(</span>command<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">int</span> recheck <span class="token operator">=</span> ctl<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span> <span class="token function">isRunning</span><span class="token punctuation">(</span>recheck<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">remove</span><span class="token punctuation">(</span>command<span class="token punctuation">)</span><span class="token punctuation">)</span>                <span class="token function">reject</span><span class="token punctuation">(</span>command<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">workerCountOf</span><span class="token punctuation">(</span>recheck<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>                <span class="token function">addWorker</span><span class="token punctuation">(</span>null<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//false代表超过核心线程</span>        <span class="token punctuation">}</span>        <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">addWorker</span><span class="token punctuation">(</span>command<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">//开最大线程失败</span>            <span class="token function">reject</span><span class="token punctuation">(</span>command<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span>  核心点：    会<span class="token keyword">new</span>线程池，同时知道这些参数之间的关系</code></pre><h3 id="2-11-ThreadLocal"><a href="#2-11-ThreadLocal" class="headerlink" title="2.11  ThreadLocal"></a>2.11  ThreadLocal</h3><pre class=" language-java"><code class="language-java"><span class="token number">1</span><span class="token operator">-</span><span class="token number">1000</span>个时间需要输出来：一个时间需要单独用一个线程来完成输出。第一稿：<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Test</span> <span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token comment" spellcheck="true">//1-1000个时间</span>        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">&lt;=</span><span class="token number">1000</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">int</span> temp <span class="token operator">=</span> i<span class="token punctuation">;</span>            <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Runnable</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                    Date date <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span>temp<span class="token operator">*</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//使用1-1000构建时间</span>                    SimpleDateFormat sdf <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SimpleDateFormat</span><span class="token punctuation">(</span><span class="token string">"yyyy-MM-dd HH:mm:ss"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                    System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>sdf<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span>date<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token punctuation">}</span>            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span>第二稿：使用线程池解决线程不断创建和销毁的问题<span class="token comment" spellcheck="true">/* * 使用线程池来解决线程的开闭的开销 */</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Test1</span> <span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>        ExecutorService pool <span class="token operator">=</span> Executors<span class="token punctuation">.</span><span class="token function">newFixedThreadPool</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">//1-1000个时间</span>        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">&lt;=</span><span class="token number">1000</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">int</span> temp <span class="token operator">=</span> i<span class="token punctuation">;</span>            pool<span class="token punctuation">.</span><span class="token function">execute</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Runnable</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                    Date date <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span>temp<span class="token operator">*</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//使用1-1000构建时间</span>                    SimpleDateFormat sdf <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SimpleDateFormat</span><span class="token punctuation">(</span><span class="token string">"HH:mm:ss"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                    System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>Thread<span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">"--"</span><span class="token operator">+</span>sdf<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span>date<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token punctuation">}</span>            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        pool<span class="token punctuation">.</span><span class="token function">shutdown</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span>第三稿：    把格式化的过程放到工具类中 <span class="token comment" spellcheck="true">/* * 使用工具类改造代码 */</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Test2</span> <span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>        ExecutorService pool <span class="token operator">=</span> Executors<span class="token punctuation">.</span><span class="token function">newFixedThreadPool</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">//1-1000个时间</span>        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">&lt;=</span><span class="token number">1000</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">int</span> temp <span class="token operator">=</span> i<span class="token punctuation">;</span>            pool<span class="token punctuation">.</span><span class="token function">execute</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Runnable</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                    System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>Thread<span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">"--"</span><span class="token operator">+</span>DateUtil<span class="token punctuation">.</span><span class="token function">getDate</span><span class="token punctuation">(</span>temp<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token punctuation">}</span>            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        pool<span class="token punctuation">.</span><span class="token function">shutdown</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span>   <span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DateUtil</span> <span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> String <span class="token function">getDate</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token punctuation">)</span> <span class="token punctuation">{</span>        Date date <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span>i<span class="token operator">*</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//使用1-1000构建时间</span>        SimpleDateFormat sdf <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SimpleDateFormat</span><span class="token punctuation">(</span><span class="token string">"HH:mm:ss"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> sdf<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span>date<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span> 问题：sdf太多了<span class="token operator">--</span><span class="token operator">-</span><span class="token number">1000</span>个<span class="token operator">--</span><span class="token operator">--</span>省   第四稿：省SimpleDateFormat<span class="token comment" spellcheck="true">//把sdf设计为一个对象</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DateUtil1</span> <span class="token punctuation">{</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> SimpleDateFormat sdf <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SimpleDateFormat</span><span class="token punctuation">(</span><span class="token string">"HH:mm:ss"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> String <span class="token function">getDate</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token punctuation">)</span> <span class="token punctuation">{</span>        Date date <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span>i<span class="token operator">*</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//使用1-1000构建时间</span>        <span class="token keyword">return</span> sdf<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span>date<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span> 问题：线程不安全    一个类如果没有成员变量，这个类一定是安全的    做成成员变量就被所有的线程所共享，因此就不安全</code></pre><pre class=" language-java"><code class="language-java">第五稿：加锁   <span class="token comment" spellcheck="true">//加锁来实现安全</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DateUtil2</span> <span class="token punctuation">{</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> SimpleDateFormat sdf <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SimpleDateFormat</span><span class="token punctuation">(</span><span class="token string">"HH:mm:ss"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> String <span class="token function">getDate</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token punctuation">)</span> <span class="token punctuation">{</span>        Date date <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span>i<span class="token operator">*</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//使用1-1000构建时间</span>        String str<span class="token operator">=</span>null<span class="token punctuation">;</span>        <span class="token keyword">synchronized</span> <span class="token punctuation">(</span>DateUtil2<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            str <span class="token operator">=</span> sdf<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span>date<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token keyword">return</span> str<span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span>问题：所有的线程所有的任务都会在格式化这行代码阻塞，效率会受到影响。 第六稿：使用ThreadLocal来做线程隔离，每个线程设置一个SimpleDateFormat<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DateUtil3</span> <span class="token punctuation">{</span>    <span class="token comment" spellcheck="true">//private static SimpleDateFormat sdf = new SimpleDateFormat("HH:mm:ss");</span>    <span class="token keyword">static</span> ThreadLocal<span class="token operator">&lt;</span>SimpleDateFormat<span class="token operator">></span> tl <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ThreadLocal</span><span class="token operator">&lt;</span>SimpleDateFormat<span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">protected</span> SimpleDateFormat <span class="token function">initialValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">SimpleDateFormat</span><span class="token punctuation">(</span><span class="token string">"HH:mm:ss"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//创建一个匿名内部类</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> String <span class="token function">getDate</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token punctuation">)</span> <span class="token punctuation">{</span>        Date date <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span>i<span class="token operator">*</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//使用1-1000构建时间</span>        String str<span class="token operator">=</span> tl<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span>date<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//这个就是获取当前线程的SimpleDateFormat</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>Thread<span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">"----"</span><span class="token operator">+</span>System<span class="token punctuation">.</span><span class="token function">identityHashCode</span><span class="token punctuation">(</span>tl<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> str<span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span> 完美解决很多时间格式化的问题     <span class="token number">1</span>、为什么tl是静态的，内存唯一，tl<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span>得到的却是多个对象？    <span class="token number">2</span>、匿名内部类写方法在哪儿调用的？    <span class="token number">3</span>、线程隔离是怎么实现的？</code></pre><h3 id="2-12-ThreadLocal源码分析"><a href="#2-12-ThreadLocal源码分析" class="headerlink" title="2.12 ThreadLocal源码分析"></a>2.12 ThreadLocal源码分析</h3><pre class=" language-java"><code class="language-java"><span class="token keyword">public</span> T <span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token comment" spellcheck="true">//每个线程执行get方法的时候获取线程对象</span>        Thread t <span class="token operator">=</span> Thread<span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//获取当前线程对象----</span>        <span class="token comment" spellcheck="true">//获取ThreadLocalMap对象---入参是当前对象--根据当前线程获取一个map</span>        ThreadLocalMap map <span class="token operator">=</span> <span class="token function">getMap</span><span class="token punctuation">(</span>t<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>map <span class="token operator">!=</span> null<span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token comment" spellcheck="true">//如果这个map里面有值，就从map中取给你</span>            ThreadLocalMap<span class="token punctuation">.</span>Entry e <span class="token operator">=</span> map<span class="token punctuation">.</span><span class="token function">getEntry</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>e <span class="token operator">!=</span> null<span class="token punctuation">)</span> <span class="token punctuation">{</span>                <span class="token annotation punctuation">@SuppressWarnings</span><span class="token punctuation">(</span><span class="token string">"unchecked"</span><span class="token punctuation">)</span>                T result <span class="token operator">=</span> <span class="token punctuation">(</span>T<span class="token punctuation">)</span>e<span class="token punctuation">.</span>value<span class="token punctuation">;</span>                <span class="token keyword">return</span> result<span class="token punctuation">;</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span>        <span class="token comment" spellcheck="true">//另外的渠道给你</span>        <span class="token keyword">return</span> <span class="token function">setInitialValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token function">getMap</span><span class="token punctuation">(</span>t<span class="token punctuation">)</span><span class="token operator">:</span>   ThreadLocalMap <span class="token function">getMap</span><span class="token punctuation">(</span>Thread t<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token comment" spellcheck="true">//Thread类：</span>        <span class="token comment" spellcheck="true">//ThreadLocal.ThreadLocalMap threadLocals = null;</span>        <span class="token keyword">return</span> t<span class="token punctuation">.</span>threadLocals<span class="token punctuation">;</span><span class="token comment" spellcheck="true">//t-当前线程   threadLocals:ThreadLocalMap类型的成员变量</span><span class="token punctuation">}</span><span class="token comment" spellcheck="true">//setInitialValue</span><span class="token keyword">private</span> T <span class="token function">setInitialValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token comment" spellcheck="true">//这个方法是我们在new ThreadLocal对象的时候用了一个匿名内部类重写他</span>        <span class="token comment" spellcheck="true">//第一次map里面没有这个值的这个时候会调用这个这个方法，如果后面这个线程再来获取</span>        <span class="token comment" spellcheck="true">//会直接从map里面给他</span>        T value <span class="token operator">=</span> <span class="token function">initialValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//调到我们重写的方法---sdf</span>        Thread t <span class="token operator">=</span> Thread<span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//获取当前线程</span>        ThreadLocalMap map <span class="token operator">=</span> <span class="token function">getMap</span><span class="token punctuation">(</span>t<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//获取线程里面的map集合</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>map <span class="token operator">!=</span> null<span class="token punctuation">)</span> <span class="token punctuation">{</span>            map<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//map已经有了，一定是已经放了其他的tl对象进去</span>        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>            <span class="token function">createMap</span><span class="token punctuation">(</span>t<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//创建一个ThreadLocalMap  threadLocals           </span>        <span class="token punctuation">}</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span> <span class="token keyword">instanceof</span> <span class="token class-name">TerminatingThreadLocal</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            TerminatingThreadLocal<span class="token punctuation">.</span><span class="token function">register</span><span class="token punctuation">(</span><span class="token punctuation">(</span>TerminatingThreadLocal<span class="token operator">&lt;</span><span class="token operator">?</span><span class="token operator">></span><span class="token punctuation">)</span> <span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token keyword">return</span> value<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">void</span> <span class="token function">createMap</span><span class="token punctuation">(</span>Thread t<span class="token punctuation">,</span> T firstValue<span class="token punctuation">)</span> <span class="token punctuation">{</span>       <span class="token comment" spellcheck="true">//当前线程的map集合在这里创建---键是ThreadLocal对象，值是sdf</span>        t<span class="token punctuation">.</span>threadLocals <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ThreadLocalMap</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> firstValue<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//this  tl</span><span class="token punctuation">}</span>set方法：修改ThreadLocal里面的值<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">set</span><span class="token punctuation">(</span>T value<span class="token punctuation">)</span> <span class="token punctuation">{</span>        Thread t <span class="token operator">=</span> Thread<span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        ThreadLocalMap map <span class="token operator">=</span> <span class="token function">getMap</span><span class="token punctuation">(</span>t<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>map <span class="token operator">!=</span> null<span class="token punctuation">)</span> <span class="token punctuation">{</span>            map<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>            <span class="token function">createMap</span><span class="token punctuation">(</span>t<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span><span class="token punctuation">}</span>remove方法：删除键值对  <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">remove</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>         ThreadLocalMap m <span class="token operator">=</span> <span class="token function">getMap</span><span class="token punctuation">(</span>Thread<span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>         <span class="token keyword">if</span> <span class="token punctuation">(</span>m <span class="token operator">!=</span> null<span class="token punctuation">)</span> <span class="token punctuation">{</span>             m<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>         <span class="token punctuation">}</span><span class="token punctuation">}</span>      </code></pre><p><img src="C:\Users\Lenovo\Desktop\新建文件夹\images\image-20221123171559376.png" alt="image-20221123171559376"></p><h3 id="2-13-生产者消费者问题"><a href="#2-13-生产者消费者问题" class="headerlink" title="2.13  生产者消费者问题"></a>2.13  生产者消费者问题</h3><pre class=" language-java"><code class="language-java">工厂生产产品：    门店需求，太多就会导致库存积压。太少会缺货。  需求：有一对男女朋友，男生给女生存<span class="token number">10000</span>块钱<span class="token operator">--</span>生产者，分<span class="token number">10</span>次，每次存<span class="token number">1000</span>     女生取<span class="token number">10000</span>块，分<span class="token number">10</span>次<span class="token operator">--</span><span class="token operator">--</span>消费者线程Card<span class="token punctuation">,</span>BF<span class="token punctuation">,</span>GF<span class="token punctuation">,</span>Test 简单的生成者消费者问题：<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Card</span> <span class="token punctuation">{</span>    <span class="token keyword">private</span> <span class="token keyword">int</span> money<span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">getMoney</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">return</span> money<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setMoney</span><span class="token punctuation">(</span><span class="token keyword">int</span> money<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>money <span class="token operator">=</span> money<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true">// 存钱的方法</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">save</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token comment" spellcheck="true">//这两个方法有没有锁---</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>money<span class="token operator">>=</span><span class="token number">1000</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>Thread<span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"发现卡上还有钱，等等再存"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment" spellcheck="true">//怎么让他等，等什么？</span>            <span class="token keyword">try</span> <span class="token punctuation">{</span>                <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">wait</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//代码会在这里停住</span>            <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>                e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span>        money <span class="token operator">+=</span> <span class="token number">1000</span><span class="token punctuation">;</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>Thread<span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"存入1000元，卡上已有"</span> <span class="token operator">+</span> money <span class="token operator">+</span> <span class="token string">"元"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">//通知女朋友可以取钱了</span>        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">notify</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>        <span class="token comment" spellcheck="true">// 取钱的方法</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">take</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token comment" spellcheck="true">//取钱先判断</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>money<span class="token operator">&lt;=</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>Thread<span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"发现卡上没钱，等等再取"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment" spellcheck="true">//怎么让他等，等什么？</span>            <span class="token keyword">try</span> <span class="token punctuation">{</span>                <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">wait</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//代码会在这里停住</span>            <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>                e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span>        money <span class="token operator">-=</span> <span class="token number">1000</span><span class="token punctuation">;</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>Thread<span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"取出1000元，卡上还剩"</span> <span class="token operator">+</span> money <span class="token operator">+</span> <span class="token string">"元"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">notify</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span>生产者线程：<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">BF</span> <span class="token keyword">implements</span> <span class="token class-name">Runnable</span><span class="token punctuation">{</span>        <span class="token keyword">private</span> Card card<span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token function">BF</span><span class="token punctuation">(</span>Card card<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>card <span class="token operator">=</span> card<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token comment" spellcheck="true">//他的任务就是存10次1000块</span>        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">&lt;=</span><span class="token number">10</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">synchronized</span> <span class="token punctuation">(</span>card<span class="token punctuation">)</span> <span class="token punctuation">{</span>                card<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//这个方法就是往卡上存入1000元</span>                System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>Thread<span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"第"</span> <span class="token operator">+</span> i <span class="token operator">+</span> <span class="token string">"次存入1000元"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                            <span class="token punctuation">}</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span>消费者线程：<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">GF</span> <span class="token keyword">implements</span> <span class="token class-name">Runnable</span><span class="token punctuation">{</span>        <span class="token keyword">private</span> Card card<span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token function">GF</span><span class="token punctuation">(</span>Card card<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>card <span class="token operator">=</span> card<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token comment" spellcheck="true">//他的任务就是取10次1000块</span>        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">&lt;=</span><span class="token number">10</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">synchronized</span> <span class="token punctuation">(</span>card<span class="token punctuation">)</span> <span class="token punctuation">{</span>                card<span class="token punctuation">.</span><span class="token function">take</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//这个方法就是往卡上存入1000元</span>                System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>Thread<span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"第"</span> <span class="token operator">+</span> i <span class="token operator">+</span> <span class="token string">"次取出1000元"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                            <span class="token punctuation">}</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span>测试类：<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Test</span> <span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>        Card card <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Card</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                BF bf <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BF</span><span class="token punctuation">(</span>card<span class="token punctuation">)</span><span class="token punctuation">;</span>        GF gf <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">GF</span><span class="token punctuation">(</span>card<span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span>bf<span class="token punctuation">,</span><span class="token string">"郭靖"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span>gf<span class="token punctuation">,</span><span class="token string">"黄蓉"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span>说明：    <span class="token function">wait</span><span class="token punctuation">(</span><span class="token punctuation">)</span>方法是由谁调用？<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>谁等，等什么？    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">wait</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> 这句代码的意思是当前线程立即释放锁，当前线程主动释放锁，让别人去获取锁，调用wait方法的对象一定是锁。    是当前线程等下次获取锁，下次是什么时候？下次是别人唤醒他的时候<span class="token punctuation">(</span>notify<span class="token punctuation">)</span>或者到时间。    wait方法是Object这个类的方法，任何对象都可能做锁，只有作为锁的时候才能够调用wait方法。    复杂的生成者消费者问题：    Card card <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Card</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    BF bf <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BF</span><span class="token punctuation">(</span>card<span class="token punctuation">)</span><span class="token punctuation">;</span>    BF bf1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BF</span><span class="token punctuation">(</span>card<span class="token punctuation">)</span><span class="token punctuation">;</span>    GF gf <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">GF</span><span class="token punctuation">(</span>card<span class="token punctuation">)</span><span class="token punctuation">;</span>    GF gf1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">GF</span><span class="token punctuation">(</span>card<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span>gf<span class="token punctuation">,</span><span class="token string">"黄蓉"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span>gf1<span class="token punctuation">,</span><span class="token string">"小龙女"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span>bf<span class="token punctuation">,</span><span class="token string">"郭靖"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span>bf1<span class="token punctuation">,</span><span class="token string">"杨康"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>当多个生产者消费者的时候，就出现了取出负数的情况？或者<span class="token number">2000</span>的情况。    注意： 一个线程被唤醒之后，会直接从wait的位置开始执行。         当一个锁从队列唤醒线程的时候，是随机的：             方案一就是wait方法里面加时间             方案二使用notifyAll方法唤醒所有的等待线程</code></pre>]]></content>
      
      
      
    </entry>
    
    
  
  
</search>
